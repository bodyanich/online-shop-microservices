# –õ–ê–ë–û–†–ê–¢–û–†–ù–ê –†–û–ë–û–¢–ê ‚Ññ2
## –ü—Ä–æ—î–∫—Ç—É–≤–∞–Ω–Ω—è –º—ñ–∫—Ä–æ—Å–µ—Ä–≤—ñ—Å–Ω–æ—ó –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∏

**–¢–µ–º–∞ –ø—Ä–æ–µ–∫—Ç—É:** –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è–º–∏ —É –Ω–µ–≤–µ–ª–∏–∫–æ–º—É –æ–Ω–ª–∞–π–Ω-–º–∞–≥–∞–∑–∏–Ω—ñ

**–í–∏–∫–æ–Ω–∞–≤:** [–í–∞—à–µ —ñ–º'—è]  
**–ì—Ä—É–ø–∞:** [–í–∞—à–∞ –≥—Ä—É–ø–∞]  
**–î–∞—Ç–∞:** 15.11.2025

---

## 1. –ú–ï–¢–ê –†–û–ë–û–¢–ò

–ù–∞–≤—á–∏—Ç–∏—Å—è –¥–µ–∫–æ–º–ø–æ–∑—É–≤–∞—Ç–∏ —Å–∏—Å—Ç–µ–º—É –Ω–∞ –º—ñ–∫—Ä–æ—Å–µ—Ä–≤—ñ—Å–∏, –≤–∏–∑–Ω–∞—á–∞—Ç–∏ –º–µ–∂—ñ –∫–æ–∂–Ω–æ–≥–æ —Å–µ—Ä–≤—ñ—Å—É (bounded context), –ø—Ä–æ—î–∫—Ç—É–≤–∞—Ç–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –±–∞–∑ –¥–∞–Ω–∏—Ö, API endpoints —Ç–∞ —Å–ø–æ—Å–æ–±–∏ –≤–∑–∞—î–º–æ–¥—ñ—ó –º—ñ–∂ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏.

---

## 2. –ö–û–†–û–¢–ö–Ü –¢–ï–û–†–ï–¢–ò–ß–ù–Ü –í–Ü–î–û–ú–û–°–¢–Ü

**–ú—ñ–∫—Ä–æ—Å–µ—Ä–≤—ñ—Å–Ω–∞ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞** ‚Äî —Ü–µ –ø—ñ–¥—Ö—ñ–¥ –¥–æ –ø—Ä–æ—î–∫—Ç—É–≤–∞–Ω–Ω—è –ø—Ä–æ–≥—Ä–∞–º–Ω–∏—Ö —Å–∏—Å—Ç–µ–º, —É —è–∫–æ–º—É –∑–∞—Å—Ç–æ—Å—É–Ω–æ–∫ —Ä–æ–∑–¥—ñ–ª—è—î—Ç—å—Å—è –Ω–∞ –Ω–∏–∑–∫—É –Ω–µ–∑–∞–ª–µ–∂–Ω–∏—Ö —Å–µ—Ä–≤—ñ—Å—ñ–≤, –∫–æ–∂–µ–Ω –∑ —è–∫–∏—Ö –≤–∏–∫–æ–Ω—É—î –æ–¥–Ω—É —á—ñ—Ç–∫—É –±—ñ–∑–Ω–µ—Å-—Ñ—É–Ω–∫—Ü—ñ—é.

**–û—Å–Ω–æ–≤–Ω—ñ –ø—Ä–∏–Ω—Ü–∏–ø–∏ –º—ñ–∫—Ä–æ—Å–µ—Ä–≤—ñ—Å—ñ–≤:**

1. **Single Responsibility** ‚Äî –∫–æ–∂–µ–Ω —Å–µ—Ä–≤—ñ—Å –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –∑–∞ –æ–¥–Ω—É –±—ñ–∑–Ω–µ—Å-—Ñ—É–Ω–∫—Ü—ñ—é
2. **Bounded Context** ‚Äî —á—ñ—Ç–∫–µ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –º–µ–∂ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–æ—Å—Ç—ñ —Å–µ—Ä–≤—ñ—Å—É
3. **Decentralized Data Management** ‚Äî –∫–æ–∂–µ–Ω —Å–µ—Ä–≤—ñ—Å –º–∞—î –≤–ª–∞—Å–Ω—É –±–∞–∑—É –¥–∞–Ω–∏—Ö
4. **Independent Deployment** ‚Äî —Å–µ—Ä–≤—ñ—Å–∏ –º–æ–∂—É—Ç—å —Ä–æ–∑–≥–æ—Ä—Ç–∞—Ç–∏—Å—è –Ω–µ–∑–∞–ª–µ–∂–Ω–æ
5. **Loose Coupling** ‚Äî —Å–ª–∞–±–∫–∞ –∑–≤'—è–∑–∞–Ω—ñ—Å—Ç—å –º—ñ–∂ —Å–µ—Ä–≤—ñ—Å–∞–º–∏
6. **API-First** ‚Äî –≤–∑–∞—î–º–æ–¥—ñ—è —á–µ—Ä–µ–∑ –¥–æ–±—Ä–µ –≤–∏–∑–Ω–∞—á–µ–Ω—ñ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∏

**–ü–µ—Ä–µ–≤–∞–≥–∏ –º—ñ–∫—Ä–æ—Å–µ—Ä–≤—ñ—Å–Ω–æ—ó –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∏:**
- –ù–µ–∑–∞–ª–µ–∂–Ω–µ –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è –æ–∫—Ä–µ–º–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤
- –ú–æ–∂–ª–∏–≤—ñ—Å—Ç—å –ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ—ó —Ä–æ–∑—Ä–æ–±–∫–∏ —Ä—ñ–∑–Ω–∏–º–∏ –∫–æ–º–∞–Ω–¥–∞–º–∏
- –¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—á–Ω–∞ –≥–µ—Ç–µ—Ä–æ–≥–µ–Ω–Ω—ñ—Å—Ç—å (—Ä—ñ–∑–Ω—ñ –º–æ–≤–∏/—Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∏)
- –í–∏—Å–æ–∫–∞ –≤—ñ–¥–º–æ–≤–æ—Å—Ç—ñ–π–∫—ñ—Å—Ç—å (fault isolation)
- –°–ø—Ä–æ—â–µ–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–∞ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è

**–ù–µ–¥–æ–ª—ñ–∫–∏:**
- –°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω–æ—é —Å–∏—Å—Ç–µ–º–æ—é
- –ù–µ–æ–±—Ö—ñ–¥–Ω—ñ—Å—Ç—å —Ü–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–æ–≥–æ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É
- –°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å —É–∑–≥–æ–¥–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –º—ñ–∂ —Å–µ—Ä–≤—ñ—Å–∞–º–∏
- –ü—ñ–¥–≤–∏—â–µ–Ω—ñ –≤–∏–º–æ–≥–∏ –¥–æ DevOps-—ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∏

---

## 3. –î–ï–ö–û–ú–ü–û–ó–ò–¶–Ü–Ø –°–ò–°–¢–ï–ú–ò –ù–ê –ú–Ü–ö–†–û–°–ï–†–í–Ü–°–ò

### 3.1. –ü—Ä–∏–Ω—Ü–∏–ø–∏ –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü—ñ—ó

–î–ª—è –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü—ñ—ó –Ω–∞—à–æ—ó —Å–∏—Å—Ç–µ–º–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ –ø—ñ–¥—Ö—ñ–¥ **Domain-Driven Design (DDD)**, —è–∫–∏–π –±–∞–∑—É—î—Ç—å—Å—è –Ω–∞ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—ñ bounded contexts ‚Äî —á—ñ—Ç–∫–∏—Ö –º–µ–∂ –±—ñ–∑–Ω–µ—Å-–¥–æ–º–µ–Ω—ñ–≤.

**–ö—Ä–∏—Ç–µ—Ä—ñ—ó –≤–∏–¥—ñ–ª–µ–Ω–Ω—è –º—ñ–∫—Ä–æ—Å–µ—Ä–≤—ñ—Å—É:**
1. –û–∫—Ä–µ–º–∞ –±—ñ–∑–Ω–µ—Å-–º–æ–∂–ª–∏–≤—ñ—Å—Ç—å (business capability)
2. –ù–µ–∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å –∂–∏—Ç—Ç—î–≤–æ–≥–æ —Ü–∏–∫–ª—É –¥–∞–Ω–∏—Ö
3. –ú–æ–∂–ª–∏–≤—ñ—Å—Ç—å –∞–≤—Ç–æ–Ω–æ–º–Ω–æ—ó —Ä–æ–∑—Ä–æ–±–∫–∏ —Ç–∞ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è
4. –û–∫—Ä–µ–º—ñ –≤–∏–º–æ–≥–∏ –¥–æ –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è

### 3.2. –í–∏–¥—ñ–ª–µ–Ω—ñ –º—ñ–∫—Ä–æ—Å–µ—Ä–≤—ñ—Å–∏

–°–∏—Å—Ç–µ–º—É —Ä–æ–∑–¥—ñ–ª–µ–Ω–æ –Ω–∞ **3 –º—ñ–∫—Ä–æ—Å–µ—Ä–≤—ñ—Å–∏**:

#### üîπ Product Service (–°–µ—Ä–≤—ñ—Å —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Ç–æ–≤–∞—Ä–∞–º–∏)
**Bounded Context:** –ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä—ñ–≤ —Ç–∞ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Å–∫–ª–∞–¥—Å—å–∫–∏–º–∏ –∑–∞–ª–∏—à–∫–∞–º–∏

**–í—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω—ñ—Å—Ç—å:**
- –ó–±–µ—Ä—ñ–≥–∞–Ω–Ω—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ —Ç–æ–≤–∞—Ä–∏
- CRUD –æ–ø–µ—Ä–∞—Ü—ñ—ó –Ω–∞–¥ —Ç–æ–≤–∞—Ä–∞–º–∏
- –ö–æ–Ω—Ç—Ä–æ–ª—å –∑–∞–ª–∏—à–∫—ñ–≤ –Ω–∞ —Å–∫–ª–∞–¥—ñ
- –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ —Ç–æ–≤–∞—Ä—ñ–≤
- –û–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–ª–∏—à–∫—ñ–≤ –ø—ñ—Å–ª—è –∑–∞–º–æ–≤–ª–µ–Ω—å

**–ß–æ–º—É –æ–∫—Ä–µ–º–∏–π —Å–µ—Ä–≤—ñ—Å:**
- –ú–æ–∂–µ –º–∞—Å—à—Ç–∞–±—É–≤–∞—Ç–∏—Å—è –Ω–µ–∑–∞–ª–µ–∂–Ω–æ (–±–∞–≥–∞—Ç–æ —á–∏—Ç–∞–Ω—å –∫–∞—Ç–∞–ª–æ–≥—É)
- –í–ª–∞—Å–Ω–∞ –ª–æ–≥—ñ–∫–∞ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Å–∫–ª–∞–¥–æ–º
- –ú–æ–∂–ª–∏–≤—ñ—Å—Ç—å —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó –∑ –∑–æ–≤–Ω—ñ—à–Ω—ñ–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏ –ø–æ—Å—Ç–∞—á–∞–Ω–Ω—è

---

#### üîπ Order Service (–°–µ—Ä–≤—ñ—Å –æ–±—Ä–æ–±–∫–∏ –∑–∞–º–æ–≤–ª–µ–Ω—å)
**Bounded Context:** –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è–º–∏ —Ç–∞ –±—ñ–∑–Ω–µ—Å-—Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—è–º–∏

**–í—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω—ñ—Å—Ç—å:**
- –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–∏—Ö –∑–∞–º–æ–≤–ª–µ–Ω—å
- –ó–±–µ—Ä—ñ–≥–∞–Ω–Ω—è —ñ—Å—Ç–æ—Ä—ñ—ó –∑–∞–º–æ–≤–ª–µ–Ω—å
- –í–∞–ª—ñ–¥–∞—Ü—ñ—è –∑–∞–º–æ–≤–ª–µ–Ω—å
- –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –∑–∞–≥–∞–ª—å–Ω–æ—ó –≤–∞—Ä—Ç–æ—Å—Ç—ñ
- –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Å—Ç–∞—Ç—É—Å–∞–º–∏ –∑–∞–º–æ–≤–ª–µ–Ω—å
- –ö–æ–æ—Ä–¥–∏–Ω–∞—Ü—ñ—è –º—ñ–∂ —ñ–Ω—à–∏–º–∏ —Å–µ—Ä–≤—ñ—Å–∞–º–∏

**–ß–æ–º—É –æ–∫—Ä–µ–º–∏–π —Å–µ—Ä–≤—ñ—Å:**
- –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞ –±—ñ–∑–Ω–µ—Å-–ª–æ–≥—ñ–∫–∞ —Å–∏—Å—Ç–µ–º–∏
- –ü–æ—Ç—Ä–µ–±—É—î –æ–∫—Ä–µ–º–æ–≥–æ –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è –ø—Ä–∏ –ø—ñ–∫–æ–≤–∏—Ö –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è—Ö
- –í–ª–∞—Å–Ω–∞ –º–æ–¥–µ–ª—å –¥–∞–Ω–∏—Ö –¥–ª—è –∑–∞–º–æ–≤–ª–µ–Ω—å
- –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü—ñ—è –º—ñ–∂—Å–µ—Ä–≤—ñ—Å–Ω–æ—ó –≤–∑–∞—î–º–æ–¥—ñ—ó

---

#### üîπ Notification Service (–°–µ—Ä–≤—ñ—Å —Å–ø–æ–≤—ñ—â–µ–Ω—å)
**Bounded Context:** –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —Ç–∞ –Ω–æ—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó

**–í—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω—ñ—Å—Ç—å:**
- –û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ–¥—ñ–π —ñ–∑ —á–µ—Ä–≥–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å
- –û–±—Ä–æ–±–∫–∞ –ø–æ–¥—ñ–π OrderCreated, OrderStatusChanged
- –ù–∞–¥—Å–∏–ª–∞–Ω–Ω—è email/SMS —Å–ø–æ–≤—ñ—â–µ–Ω—å (—Å–∏–º—É–ª—è—Ü—ñ—è)
- –õ–æ–≥—É–≤–∞–Ω–Ω—è –≤—Å—ñ—Ö —Å–ø–æ–≤—ñ—â–µ–Ω—å

**–ß–æ–º—É –æ–∫—Ä–µ–º–∏–π —Å–µ—Ä–≤—ñ—Å:**
- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞ –ø—Ä–∏—Ä–æ–¥–∞ —Ä–æ–±–æ—Ç–∏ (–Ω–µ –±–ª–æ–∫—É—î —ñ–Ω—à—ñ —Å–µ—Ä–≤—ñ—Å–∏)
- –ú–æ–∂–µ –±—É—Ç–∏ –≤—ñ–¥–∫–ª—é—á–µ–Ω–∏–π –±–µ–∑ –≤–ø–ª–∏–≤—É –Ω–∞ core-—Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª
- –õ–µ–≥–∫–æ —Ä–æ–∑—à–∏—Ä—é—î—Ç—å—Å—è –Ω–æ–≤–∏–º–∏ –∫–∞–Ω–∞–ª–∞–º–∏ —Å–ø–æ–≤—ñ—â–µ–Ω—å
- –ù–µ–∑–∞–ª–µ–∂–Ω–∏–π –∂–∏—Ç—Ç—î–≤–∏–π —Ü–∏–∫–ª

---

## 4. –î–ï–¢–ê–õ–¨–ù–ò–ô –û–ü–ò–° –ú–Ü–ö–†–û–°–ï–†–í–Ü–°–Ü–í

### 4.1. Product Service

#### 4.1.1. –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö: `products_db` (PostgreSQL)

**–¢–∞–±–ª–∏—Ü—è `products`:**

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å | –û–±–º–µ–∂–µ–Ω–Ω—è |
|------|-----|------|-----------|
| `id` | SERIAL | –£–Ω—ñ–∫–∞–ª—å–Ω–∏–π —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä | PRIMARY KEY |
| `name` | VARCHAR(255) | –ù–∞–∑–≤–∞ —Ç–æ–≤–∞—Ä—É | NOT NULL |
| `description` | TEXT | –î–µ—Ç–∞–ª—å–Ω–∏–π –æ–ø–∏—Å —Ç–æ–≤–∞—Ä—É | NULL |
| `price` | DECIMAL(10,2) | –¶—ñ–Ω–∞ —Ç–æ–≤–∞—Ä—É | NOT NULL, CHECK (price >= 0) |
| `stock` | INTEGER | –ö—ñ–ª—å–∫—ñ—Å—Ç—å –Ω–∞ —Å–∫–ª–∞–¥—ñ | NOT NULL, DEFAULT 0, CHECK (stock >= 0) |
| `category` | VARCHAR(100) | –ö–∞—Ç–µ–≥–æ—Ä—ñ—è —Ç–æ–≤–∞—Ä—É | NULL |
| `image_url` | VARCHAR(500) | –ü–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è | NULL |
| `created_at` | TIMESTAMP | –î–∞—Ç–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è | DEFAULT CURRENT_TIMESTAMP |
| `updated_at` | TIMESTAMP | –î–∞—Ç–∞ –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è | DEFAULT CURRENT_TIMESTAMP |

**SQL –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞–±–ª–∏—Ü—ñ:**
```sql
CREATE TABLE products (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    description TEXT,
    price DECIMAL(10,2) NOT NULL CHECK (price >= 0),
    stock INTEGER NOT NULL DEFAULT 0 CHECK (stock >= 0),
    category VARCHAR(100),
    image_url VARCHAR(500),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- –Ü–Ω–¥–µ–∫—Å –¥–ª—è –ø–æ—à—É–∫—É –ø–æ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó
CREATE INDEX idx_products_category ON products(category);

-- –Ü–Ω–¥–µ–∫—Å –¥–ª—è —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó —Ç–æ–≤–∞—Ä—ñ–≤ –≤ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ
CREATE INDEX idx_products_stock ON products(stock) WHERE stock > 0;
```

#### 4.1.2. API Endpoints

**Base URL:** `http://localhost:8001`

| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å | Request Body | Response |
|-------|----------|------|--------------|----------|
| GET | `/products` | –û—Ç—Ä–∏–º–∞—Ç–∏ —Å–ø–∏—Å–æ–∫ –≤—Å—ñ—Ö —Ç–æ–≤–∞—Ä—ñ–≤ | - | `200 OK` + array of products |
| GET | `/products/{id}` | –û—Ç—Ä–∏–º–∞—Ç–∏ —Ç–æ–≤–∞—Ä –∑–∞ ID | - | `200 OK` + product / `404 Not Found` |
| POST | `/products` | –°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–∏–π —Ç–æ–≤–∞—Ä | Product object | `201 Created` + product |
| PUT | `/products/{id}` | –û–Ω–æ–≤–∏—Ç–∏ —Ç–æ–≤–∞—Ä | Product object | `200 OK` + product / `404 Not Found` |
| DELETE | `/products/{id}` | –í–∏–¥–∞–ª–∏—Ç–∏ —Ç–æ–≤–∞—Ä | - | `204 No Content` / `404 Not Found` |
| PATCH | `/products/{id}/stock` | –û–Ω–æ–≤–∏—Ç–∏ –∑–∞–ª–∏—à–æ–∫ —Ç–æ–≤–∞—Ä—É | `{"quantity": -2}` | `200 OK` + product |
| GET | `/products/check/{id}` | –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å —Ç–æ–≤–∞—Ä—É | - | `200 OK` + `{"available": true/false, "stock": N}` |
| GET | `/health` | Health check | - | `200 OK` + `{"status": "healthy"}` |
| GET | `/metrics` | Prometheus –º–µ—Ç—Ä–∏–∫–∏ | - | `200 OK` + metrics |

**–ü—Ä–∏–∫–ª–∞–¥ Request/Response:**

**POST /products**
```json
{
  "name": "–ù–æ—É—Ç–±—É–∫ Lenovo ThinkPad",
  "description": "–ü—Ä–æ—Ñ–µ—Å—ñ–π–Ω–∏–π –Ω–æ—É—Ç–±—É–∫ –¥–ª—è —Ä–æ–±–æ—Ç–∏",
  "price": 25999.99,
  "stock": 15,
  "category": "–ï–ª–µ–∫—Ç—Ä–æ–Ω—ñ–∫–∞",
  "image_url": "https://example.com/laptop.jpg"
}
```

**Response 201 Created:**
```json
{
  "id": 1,
  "name": "–ù–æ—É—Ç–±—É–∫ Lenovo ThinkPad",
  "description": "–ü—Ä–æ—Ñ–µ—Å—ñ–π–Ω–∏–π –Ω–æ—É—Ç–±—É–∫ –¥–ª—è —Ä–æ–±–æ—Ç–∏",
  "price": 25999.99,
  "stock": 15,
  "category": "–ï–ª–µ–∫—Ç—Ä–æ–Ω—ñ–∫–∞",
  "image_url": "https://example.com/laptop.jpg",
  "created_at": "2025-11-15T10:30:00Z",
  "updated_at": "2025-11-15T10:30:00Z"
}
```

#### 4.1.3. –í–∑–∞—î–º–æ–¥—ñ—è –∑ —ñ–Ω—à–∏–º–∏ —Å–µ—Ä–≤—ñ—Å–∞–º–∏

**–°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞ –≤–∑–∞—î–º–æ–¥—ñ—è:**
- **Order Service ‚Üí Product Service**: HTTP GET –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ —Ç–æ–≤–∞—Ä—É

**–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞ –≤–∑–∞—î–º–æ–¥—ñ—è:**
- **–°–ø–æ–∂–∏–≤–∞—î –ø–æ–¥—ñ—ó –∑ RabbitMQ:**
  - `OrderCreated` ‚Üí –∑–º–µ–Ω—à—É—î `stock` –¥–ª—è –∑–∞–º–æ–≤–ª–µ–Ω–∏—Ö —Ç–æ–≤–∞—Ä—ñ–≤

#### 4.1.4. –ó–º—ñ–Ω–Ω—ñ –æ—Ç–æ—á–µ–Ω–Ω—è

```env
DATABASE_URL=postgresql://user:password@postgres-products:5432/products_db
RABBITMQ_URL=amqp://guest:guest@rabbitmq:5672/
RABBITMQ_QUEUE=order.created
SERVICE_PORT=8000
LOG_LEVEL=INFO
```

---

### 4.2. Order Service

#### 4.2.1. –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö: `orders_db` (PostgreSQL)

**–¢–∞–±–ª–∏—Ü—è `orders`:**

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å | –û–±–º–µ–∂–µ–Ω–Ω—è |
|------|-----|------|-----------|
| `id` | SERIAL | –£–Ω—ñ–∫–∞–ª—å–Ω–∏–π —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä | PRIMARY KEY |
| `product_id` | INTEGER | ID —Ç–æ–≤–∞—Ä—É | NOT NULL |
| `product_name` | VARCHAR(255) | –ù–∞–∑–≤–∞ —Ç–æ–≤–∞—Ä—É (–¥–µ–Ω–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—è) | NOT NULL |
| `quantity` | INTEGER | –ö—ñ–ª—å–∫—ñ—Å—Ç—å –æ–¥–∏–Ω–∏—Ü—å | NOT NULL, CHECK (quantity > 0) |
| `unit_price` | DECIMAL(10,2) | –¶—ñ–Ω–∞ –∑–∞ –æ–¥–∏–Ω–∏—Ü—é | NOT NULL |
| `total_price` | DECIMAL(10,2) | –ó–∞–≥–∞–ª—å–Ω–∞ –≤–∞—Ä—Ç—ñ—Å—Ç—å | NOT NULL |
| `status` | VARCHAR(50) | –°—Ç–∞—Ç—É—Å –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è | NOT NULL, DEFAULT 'pending' |
| `customer_email` | VARCHAR(255) | Email –ø–æ–∫—É–ø—Ü—è | NULL |
| `created_at` | TIMESTAMP | –î–∞—Ç–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è | DEFAULT CURRENT_TIMESTAMP |
| `updated_at` | TIMESTAMP | –î–∞—Ç–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è | DEFAULT CURRENT_TIMESTAMP |

**–ú–æ–∂–ª–∏–≤—ñ —Å—Ç–∞—Ç—É—Å–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è:**
- `pending` - –ù–æ–≤–µ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è
- `processing` - –í –æ–±—Ä–æ–±—Ü—ñ
- `completed` - –í–∏–∫–æ–Ω–∞–Ω–æ
- `cancelled` - –°–∫–∞—Å–æ–≤–∞–Ω–æ

**SQL –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞–±–ª–∏—Ü—ñ:**
```sql
CREATE TABLE orders (
    id SERIAL PRIMARY KEY,
    product_id INTEGER NOT NULL,
    product_name VARCHAR(255) NOT NULL,
    quantity INTEGER NOT NULL CHECK (quantity > 0),
    unit_price DECIMAL(10,2) NOT NULL,
    total_price DECIMAL(10,2) NOT NULL,
    status VARCHAR(50) NOT NULL DEFAULT 'pending',
    customer_email VARCHAR(255),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- –Ü–Ω–¥–µ–∫—Å –¥–ª—è –ø–æ—à—É–∫—É –∑–∞–º–æ–≤–ª–µ–Ω—å –ø–æ —Å—Ç–∞—Ç—É—Å—É
CREATE INDEX idx_orders_status ON orders(status);

-- –Ü–Ω–¥–µ–∫—Å –¥–ª—è –ø–æ—à—É–∫—É –∑–∞–º–æ–≤–ª–µ–Ω—å –ø–æ –¥–∞—Ç—ñ
CREATE INDEX idx_orders_created_at ON orders(created_at DESC);

-- –Ü–Ω–¥–µ–∫—Å –¥–ª—è –ø–æ—à—É–∫—É –∑–∞–º–æ–≤–ª–µ–Ω—å –∫–ª—ñ—î–Ω—Ç–∞
CREATE INDEX idx_orders_customer_email ON orders(customer_email);
```

#### 4.2.2. API Endpoints

**Base URL:** `http://localhost:8002`

| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å | Request Body | Response |
|-------|----------|------|--------------|----------|
| GET | `/orders` | –û—Ç—Ä–∏–º–∞—Ç–∏ —Å–ø–∏—Å–æ–∫ –∑–∞–º–æ–≤–ª–µ–Ω—å | - | `200 OK` + array of orders |
| GET | `/orders/{id}` | –û—Ç—Ä–∏–º–∞—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –∑–∞ ID | - | `200 OK` + order / `404 Not Found` |
| POST | `/orders` | –°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–µ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è | Order request | `201 Created` + order / `400 Bad Request` |
| PATCH | `/orders/{id}/status` | –û–Ω–æ–≤–∏—Ç–∏ —Å—Ç–∞—Ç—É—Å –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è | `{"status": "completed"}` | `200 OK` + order |
| GET | `/orders/customer/{email}` | –û—Ç—Ä–∏–º–∞—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –∫–ª—ñ—î–Ω—Ç–∞ | - | `200 OK` + array of orders |
| GET | `/health` | Health check | - | `200 OK` + `{"status": "healthy"}` |
| GET | `/metrics` | Prometheus –º–µ—Ç—Ä–∏–∫–∏ | - | `200 OK` + metrics |

**–ü—Ä–∏–∫–ª–∞–¥ Request/Response:**

**POST /orders**
```json
{
  "product_id": 1,
  "quantity": 2,
  "customer_email": "customer@example.com"
}
```

**Response 201 Created:**
```json
{
  "id": 101,
  "product_id": 1,
  "product_name": "–ù–æ—É—Ç–±—É–∫ Lenovo ThinkPad",
  "quantity": 2,
  "unit_price": 25999.99,
  "total_price": 51999.98,
  "status": "pending",
  "customer_email": "customer@example.com",
  "created_at": "2025-11-15T10:35:00Z",
  "updated_at": "2025-11-15T10:35:00Z"
}
```

**Response 400 Bad Request (–Ω–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ —Ç–æ–≤–∞—Ä—É):**
```json
{
  "error": "Insufficient stock",
  "message": "Requested 5 units, but only 3 available",
  "product_id": 1
}
```

#### 4.2.3. –ë—ñ–∑–Ω–µ—Å-–ª–æ–≥—ñ–∫–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è

**–ê–ª–≥–æ—Ä–∏—Ç–º –æ–±—Ä–æ–±–∫–∏ POST /orders:**

1. **–í–∞–ª—ñ–¥–∞—Ü—ñ—è –≤—Ö—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö:**
   - –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ –æ–±–æ–≤'—è–∑–∫–æ–≤–∏—Ö –ø–æ–ª—ñ–≤
   - –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ quantity > 0

2. **–°–∏–Ω—Ö—Ä–æ–Ω–Ω–∏–π –≤–∏–∫–ª–∏–∫ Product Service:**
   - `GET http://product-service:8000/products/{product_id}`
   - –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —ñ—Å–Ω—É–≤–∞–Ω–Ω—è —Ç–æ–≤–∞—Ä—É
   - –û—Ç—Ä–∏–º–∞–Ω–Ω—è –∞–∫—Ç—É–∞–ª—å–Ω–æ—ó —Ü—ñ–Ω–∏ —Ç–∞ –Ω–∞–∑–≤–∏

3. **–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ –Ω–∞ —Å–∫–ª–∞–¥—ñ:**
   - `GET http://product-service:8000/products/check/{product_id}`
   - –Ø–∫—â–æ `stock < quantity` ‚Üí –ø–æ–≤–µ—Ä–Ω—É—Ç–∏ `400 Bad Request`

4. **–†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –≤–∞—Ä—Ç–æ—Å—Ç—ñ:**
   - `total_price = unit_price * quantity`

5. **–ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –≤ –ë–î:**
   - INSERT –≤ —Ç–∞–±–ª–∏—Ü—é `orders`

6. **–ü—É–±–ª—ñ–∫–∞—Ü—ñ—è –ø–æ–¥—ñ—ó –≤ RabbitMQ:**
   - –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø–æ–¥—ñ—ó `OrderCreated`
   - –ü—É–±–ª—ñ–∫–∞—Ü—ñ—è –≤ exchange `orders_exchange`

7. **–ü–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É:**
   - `201 Created` + –¥–∞–Ω—ñ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è

#### 4.2.4. –í–∑–∞—î–º–æ–¥—ñ—è –∑ —ñ–Ω—à–∏–º–∏ —Å–µ—Ä–≤—ñ—Å–∞–º–∏

**–°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞ –≤–∑–∞—î–º–æ–¥—ñ—è:**
- **Order Service ‚Üí Product Service**: HTTP GET –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ —Ç–æ–≤–∞—Ä

**–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞ –≤–∑–∞—î–º–æ–¥—ñ—è:**
- **–ü—É–±–ª—ñ–∫—É—î –ø–æ–¥—ñ—ó –≤ RabbitMQ:**
  - `OrderCreated` ‚Üí –¥–ª—è Product Service —Ç–∞ Notification Service
  - `OrderStatusChanged` ‚Üí –¥–ª—è Notification Service

#### 4.2.5. –ó–º—ñ–Ω–Ω—ñ –æ—Ç–æ—á–µ–Ω–Ω—è

```env
DATABASE_URL=postgresql://user:password@postgres-orders:5432/orders_db
RABBITMQ_URL=amqp://guest:guest@rabbitmq:5672/
RABBITMQ_EXCHANGE=orders_exchange
PRODUCT_SERVICE_URL=http://product-service:8000
SERVICE_PORT=8000
LOG_LEVEL=INFO
```

---

### 4.3. Notification Service

#### 4.3.1. –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö

**Notification Service –ù–ï –º–∞—î –≤–ª–∞—Å–Ω–æ—ó –±–∞–∑–∏ –¥–∞–Ω–∏—Ö** ‚Äî —Ü–µ stateless —Å–µ—Ä–≤—ñ—Å, —è–∫–∏–π –æ–±—Ä–æ–±–ª—è—î –ø–æ–¥—ñ—ó –≤ —Ä–µ–∂–∏–º—ñ —Ä–µ–∞–ª—å–Ω–æ–≥–æ —á–∞—Å—É.

–£—Å—ñ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è –ª–æ–≥—É—é—Ç—å—Å—è —É stdout/stderr –¥–ª—è –ø–æ–¥–∞–ª—å—à–æ–≥–æ –∑–±–æ—Ä—É —Ü–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–æ—é —Å–∏—Å—Ç–µ–º–æ—é –ª–æ–≥—É–≤–∞–Ω–Ω—è.

#### 4.3.2. API Endpoints

**Base URL:** `http://localhost:8003`

| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å | Response |
|-------|----------|------|----------|
| GET | `/health` | Health check | `200 OK` + `{"status": "healthy"}` |
| GET | `/metrics` | Prometheus –º–µ—Ç—Ä–∏–∫–∏ | `200 OK` + metrics |

**–ü—Ä–∏–º—ñ—Ç–∫–∞:** Notification Service –Ω–µ –º–∞—î –ø—É–±–ª—ñ—á–Ω–∏—Ö endpoint'—ñ–≤ –¥–ª—è –±—ñ–∑–Ω–µ—Å-–ª–æ–≥—ñ–∫–∏ ‚Äî –≤—ñ–Ω –ø—Ä–∞—Ü—é—î —è–∫ consumer RabbitMQ.

#### 4.3.3. –õ–æ–≥—ñ–∫–∞ –æ–±—Ä–æ–±–∫–∏ –ø–æ–¥—ñ–π

**Consumer –¥–ª—è –ø–æ–¥—ñ—ó `OrderCreated`:**

1. **–û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∑ —á–µ—Ä–≥–∏** `order.created`
2. **–ü–∞—Ä—Å–∏–Ω–≥ JSON:**
   ```json
   {
     "event_type": "OrderCreated",
     "order_id": 101,
     "product_id": 1,
     "product_name": "–ù–æ—É—Ç–±—É–∫ Lenovo ThinkPad",
     "quantity": 2,
     "total_price": 51999.98,
     "customer_email": "customer@example.com",
     "timestamp": "2025-11-15T10:35:00Z"
   }
   ```

3. **–§–æ—Ä–º—É–≤–∞–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è:**
   ```
   Subject: –ó–∞–º–æ–≤–ª–µ–Ω–Ω—è #101 —Å—Ç–≤–æ—Ä–µ–Ω–æ
   Body: 
   –í—ñ—Ç–∞—î–º–æ!
   
   –í–∞—à–µ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è —É—Å–ø—ñ—à–Ω–æ —Å—Ç–≤–æ—Ä–µ–Ω–æ:
   - –¢–æ–≤–∞—Ä: –ù–æ—É—Ç–±—É–∫ Lenovo ThinkPad
   - –ö—ñ–ª—å–∫—ñ—Å—Ç—å: 2
   - –ó–∞–≥–∞–ª—å–Ω–∞ –≤–∞—Ä—Ç—ñ—Å—Ç—å: 51999.98 –≥—Ä–Ω
   
   –î—è–∫—É—î–º–æ –∑–∞ –ø–æ–∫—É–ø–∫—É!
   ```

4. **–ù–∞–¥—Å–∏–ª–∞–Ω–Ω—è —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è:**
   - **–î–ª—è –Ω–∞–≤—á–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç—É:** –õ–æ–≥—É–≤–∞–Ω–Ω—è —É stdout
   - **–î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É:** –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ SendGrid, AWS SES, –∞–±–æ —ñ–Ω—à–∏–º email-—Å–µ—Ä–≤—ñ—Å–æ–º

5. **Acknowledge –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è** —É RabbitMQ

#### 4.3.4. –í–∑–∞—î–º–æ–¥—ñ—è –∑ —ñ–Ω—à–∏–º–∏ —Å–µ—Ä–≤—ñ—Å–∞–º–∏

**–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞ –≤–∑–∞—î–º–æ–¥—ñ—è:**
- **–°–ø–æ–∂–∏–≤–∞—î –ø–æ–¥—ñ—ó –∑ RabbitMQ:**
  - `OrderCreated` (–∑ Order Service)
  - `OrderStatusChanged` (–∑ Order Service)
  - `StockLow` (–ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –∑ Product Service - –º–∞–π–±—É—Ç–Ω—î —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è)

#### 4.3.5. –ó–º—ñ–Ω–Ω—ñ –æ—Ç–æ—á–µ–Ω–Ω—è

```env
RABBITMQ_URL=amqp://guest:guest@rabbitmq:5672/
RABBITMQ_QUEUE_ORDER_CREATED=order.created
RABBITMQ_QUEUE_ORDER_STATUS=order.status.changed
EMAIL_SERVICE=console  # –∞–±–æ 'sendgrid', 'smtp'
LOG_LEVEL=INFO
```

---

## 5. –ú–Ü–ñ–°–ï–†–í–Ü–°–ù–ê –í–ó–ê–Ñ–ú–û–î–Ü–Ø

### 5.1. –¢–∏–ø–∏ –≤–∑–∞—î–º–æ–¥—ñ—ó

#### –°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞ –≤–∑–∞—î–º–æ–¥—ñ—è (REST API)

**Order Service ‚Üí Product Service**

**Use Case:** –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è

```
1. –ö–ª—ñ—î–Ω—Ç –Ω–∞–¥—Å–∏–ª–∞—î POST /orders
2. Order Service –≤–∏–∫–ª–∏–∫–∞—î GET /products/{id} —É Product Service
3. Order Service –≤–∏–∫–ª–∏–∫–∞—î GET /products/check/{id}
4. Product Service –ø–æ–≤–µ—Ä—Ç–∞—î —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ —Ç–æ–≤–∞—Ä
5. Order Service –æ–±—Ä–æ–±–ª—è—î –≤—ñ–¥–ø–æ–≤—ñ–¥—å —Ç–∞ —Å—Ç–≤–æ—Ä—é—î –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è
```

**–ü–µ—Ä–µ–≤–∞–≥–∏:**
- –ù–µ–≥–∞–π–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å
- –ü—Ä–æ—Å—Ç–æ—Ç–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó
- –õ–µ–≥–∫–æ –¥–µ–±–∞–∂–∏—Ç–∏

**–ù–µ–¥–æ–ª—ñ–∫–∏:**
- –ñ–æ—Ä—Å—Ç–∫–∞ –∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å (—è–∫—â–æ Product Service –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π, –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –Ω–µ —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è)
- –ú–æ–∂–ª–∏–≤—ñ –∑–∞—Ç—Ä–∏–º–∫–∏ –ø—Ä–∏ –≤–µ–ª–∏–∫—ñ–π –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –∑–∞–ø–∏—Ç—ñ–≤

#### –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞ –≤–∑–∞—î–º–æ–¥—ñ—è (RabbitMQ)

**Order Service ‚Üí Product Service + Notification Service**

**Use Case:** –û–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–ª–∏—à–∫—ñ–≤ —Ç–∞ –Ω–∞–¥—Å–∏–ª–∞–Ω–Ω—è —Å–ø–æ–≤—ñ—â–µ–Ω—å

```
1. Order Service –ø—É–±–ª—ñ–∫—É—î –ø–æ–¥—ñ—é OrderCreated —É RabbitMQ
2. RabbitMQ –∑–±–µ—Ä—ñ–≥–∞—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —É —á–µ—Ä–∑—ñ order.created
3. Product Service –æ—Ç—Ä–∏–º—É—î –ø–æ–¥—ñ—é —Ç–∞ –æ–Ω–æ–≤–ª—é—î stock
4. Notification Service –æ—Ç—Ä–∏–º—É—î –ø–æ–¥—ñ—é —Ç–∞ –Ω–∞–¥—Å–∏–ª–∞—î email
```

**–ü–µ—Ä–µ–≤–∞–≥–∏:**
- –°–ª–∞–±–∫–∞ –∑–≤'—è–∑–∞–Ω—ñ—Å—Ç—å (—Å–µ—Ä–≤—ñ—Å–∏ –Ω–µ –∑–Ω–∞—é—Ç—å –æ–¥–∏–Ω –ø—Ä–æ –æ–¥–Ω–æ–≥–æ)
- –ù–∞–¥—ñ–π–Ω—ñ—Å—Ç—å (–ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –Ω–µ –≤—Ç—Ä–∞—á–∞—é—Ç—å—Å—è)
- –ú–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω—ñ—Å—Ç—å (–º–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∏ –Ω–æ–≤–∏—Ö —Å–ø–æ–∂–∏–≤–∞—á—ñ–≤)

**–ù–µ–¥–æ–ª—ñ–∫–∏:**
- Eventual consistency (–∑–∞–ª–∏—à–∫–∏ –æ–Ω–æ–≤–ª—é—é—Ç—å—Å—è –Ω–µ –º–∏—Ç—Ç—î–≤–æ)
- –°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å –Ω–∞–ª–∞–≥–æ–¥–∂–µ–Ω–Ω—è
- –ü–æ—Ç—Ä—ñ–±–µ–Ω –±—Ä–æ–∫–µ—Ä –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å

### 5.2. –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è RabbitMQ

**Exchange:**
- **–ù–∞–∑–≤–∞:** `orders_exchange`
- **–¢–∏–ø:** `topic`
- **Durable:** `true`

**Queues:**

| Queue Name | Routing Key | Consumer |
|------------|-------------|----------|
| `order.created` | `order.created` | Product Service, Notification Service |
| `order.status.changed` | `order.status.*` | Notification Service |

**–§–æ—Ä–º–∞—Ç –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è OrderCreated:**
```json
{
  "event_type": "OrderCreated",
  "event_id": "uuid-v4",
  "timestamp": "2025-11-15T10:35:00Z",
  "data": {
    "order_id": 101,
    "product_id": 1,
    "product_name": "–ù–æ—É—Ç–±—É–∫ Lenovo ThinkPad",
    "quantity": 2,
    "unit_price": 25999.99,
    "total_price": 51999.98,
    "customer_email": "customer@example.com"
  }
}
```

---

## 6. –î–Ü–ê–ì–†–ê–ú–ò –ê–†–•–Ü–¢–ï–ö–¢–£–†–ò

### 6.1. C4 Model - Container Diagram

–î—ñ–∞–≥—Ä–∞–º–∞ –ø–æ–∫–∞–∑—É—î –≤–∏—Å–æ–∫–æ—Ä—ñ–≤–Ω–µ–≤—É –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä—É —Å–∏—Å—Ç–µ–º–∏ –∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏ (–º—ñ–∫—Ä–æ—Å–µ—Ä–≤—ñ—Å–∞–º–∏), –±–∞–∑–∞–º–∏ –¥–∞–Ω–∏—Ö —Ç–∞ –±—Ä–æ–∫–µ—Ä–æ–º –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å.

```plantuml
@startuml C4_Container_Diagram
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Container.puml

LAYOUT_WITH_LEGEND()

title Container Diagram - –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è–º–∏ –æ–Ω–ª–∞–π–Ω-–º–∞–≥–∞–∑–∏–Ω—É

Person(customer, "–ü–æ–∫—É–ø–µ—Ü—å", "–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –æ–Ω–ª–∞–π–Ω-–º–∞–≥–∞–∑–∏–Ω—É")
Person(admin, "–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä", "–£–ø—Ä–∞–≤–ª—è—î –∫–∞—Ç–∞–ª–æ–≥–æ–º —Ç–æ–≤–∞—Ä—ñ–≤")

System_Boundary(shop_system, "–û–Ω–ª–∞–π–Ω –º–∞–≥–∞–∑–∏–Ω") {
    Container(product_service, "Product Service", "FastAPI, Python", "–£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∫–∞—Ç–∞–ª–æ–≥–æ–º —Ç–æ–≤–∞—Ä—ñ–≤ —Ç–∞ –∑–∞–ª–∏—à–∫–∞–º–∏")
    Container(order_service, "Order Service", "FastAPI, Python", "–û–±—Ä–æ–±–∫–∞ –∑–∞–º–æ–≤–ª–µ–Ω—å —Ç–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü—ñ—è")
    Container(notification_service, "Notification Service", "FastAPI, Python", "–ù–∞–¥—Å–∏–ª–∞–Ω–Ω—è —Å–ø–æ–≤—ñ—â–µ–Ω—å")
    
    ContainerDb(products_db, "Products Database", "PostgreSQL", "–ó–±–µ—Ä—ñ–≥–∞—î —Ç–æ–≤–∞—Ä–∏")
    ContainerDb(orders_db, "Orders Database", "PostgreSQL", "–ó–±–µ—Ä—ñ–≥–∞—î –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è")
    
    ContainerQueue(rabbitmq, "Message Broker", "RabbitMQ", "–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∏–π –æ–±–º—ñ–Ω –ø–æ–¥—ñ—è–º–∏")
}

System_Ext(monitoring, "Prometheus + Grafana", "–ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ —Ç–∞ –º–µ—Ç—Ä–∏–∫–∏")

' Relationships
Rel(customer, product_service, "–ü–µ—Ä–µ–≥–ª—è–¥–∞—î —Ç–æ–≤–∞—Ä–∏", "HTTPS/JSON")
Rel(customer, order_service, "–°—Ç–≤–æ—Ä—é—î –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è", "HTTPS/JSON")

Rel(admin, product_service, "–£–ø—Ä–∞–≤–ª—è—î —Ç–æ–≤–∞—Ä–∞–º–∏", "HTTPS/JSON")
Rel(admin, order_service, "–ü–µ—Ä–µ–≥–ª—è–¥–∞—î –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è", "HTTPS/JSON")

Rel(order_service, product_service, "–ü–µ—Ä–µ–≤—ñ—Ä—è—î –Ω–∞—è–≤–Ω—ñ—Å—Ç—å —Ç–æ–≤–∞—Ä—É", "HTTP/JSON")
Rel(order_service, orders_db, "–ß–∏—Ç–∞—î/–ü–∏—à–µ", "SQL/TCP")
Rel(product_service, products_db, "–ß–∏—Ç–∞—î/–ü–∏—à–µ", "SQL/TCP")

Rel(order_service, rabbitmq, "–ü—É–±–ª—ñ–∫—É—î OrderCreated", "AMQP")
Rel(rabbitmq, product_service, "–î–æ—Å—Ç–∞–≤–ª—è—î –ø–æ–¥—ñ—ó", "AMQP")
Rel(rabbitmq, notification_service, "–î–æ—Å—Ç–∞–≤–ª—è—î –ø–æ–¥—ñ—ó", "AMQP")

Rel(product_service, monitoring, "–ù–∞–¥—Å–∏–ª–∞—î –º–µ—Ç—Ä–∏–∫–∏", "HTTP")
Rel(order_service, monitoring, "–ù–∞–¥—Å–∏–ª–∞—î –º–µ—Ç—Ä–∏–∫–∏", "HTTP")
Rel(notification_service, monitoring, "–ù–∞–¥—Å–∏–ª–∞—î –º–µ—Ç—Ä–∏–∫–∏", "HTTP")

SHOW_LEGEND()
@enduml
```

### 6.2. Component Diagram - Product Service

–î–µ—Ç–∞–ª—å–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ Product Service –∑ –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ–º–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏.

```plantuml
@startuml Component_Diagram_Product_Service
!define COMPONENT rectangle

skinparam component {
    BackgroundColor LightBlue
    BorderColor Black
}

skinparam database {
    BackgroundColor LightYellow
    BorderColor Black
}

title Component Diagram - Product Service

package "Product Service" {
    
    [API Layer] as API
    note right of API
      FastAPI endpoints:
      ‚Ä¢ GET /products
      ‚Ä¢ POST /products
      ‚Ä¢ GET /products/{id}
      ‚Ä¢ PUT /products/{id}
      ‚Ä¢ DELETE /products/{id}
      ‚Ä¢ PATCH /products/{id}/stock
    end note
    
    [Business Logic] as BL
    note right of BL
      ‚Ä¢ ProductService
      ‚Ä¢ StockManager
      ‚Ä¢ ValidationService
    end note
    
    [Data Access Layer] as DAL
    note right of DAL
      ‚Ä¢ ProductRepository
      ‚Ä¢ SQLAlchemy ORM
    end note
    
    [Event Consumer] as Consumer
    note right of Consumer
      ‚Ä¢ RabbitMQ Consumer
      ‚Ä¢ OrderCreated Handler
    end note
    
    [Schemas] as Schemas
    note right of Schemas
      ‚Ä¢ Pydantic Models
      ‚Ä¢ Request/Response DTOs
    end note
    
    API --> Schemas : validates
    API --> BL : calls
    BL --> DAL : uses
    BL --> Schemas : returns
    Consumer --> BL : triggers
}

database "PostgreSQL" as DB {
    [products table]
}

queue "RabbitMQ" as MQ {
    [order.created queue]
}

[External Client] --> API : HTTP Request
API --> [External Client] : HTTP Response

DAL --> DB : SQL queries
Consumer --> MQ : consumes events

@enduml
```

### 6.3. Component Diagram - Order Service

```plantuml
@startuml Component_Diagram_Order_Service
!define COMPONENT rectangle

skinparam component {
    BackgroundColor LightGreen
    BorderColor Black
}

skinparam database {
    BackgroundColor LightYellow
    BorderColor Black
}

title Component Diagram - Order Service

package "Order Service" {
    
    [API Layer] as API
    note right of API
      FastAPI endpoints:
      ‚Ä¢ POST /orders
      ‚Ä¢ GET /orders
      ‚Ä¢ GET /orders/{id}
      ‚Ä¢ PATCH /orders/{id}/status
    end note
    
    [Business Logic] as BL
    note right of BL
      ‚Ä¢ OrderService
      ‚Ä¢ PriceCalculator
      ‚Ä¢ OrderValidator
      ‚Ä¢ OrderOrchestrator
    end note
    
    [Data Access Layer] as DAL
    note right of DAL
      ‚Ä¢ OrderRepository
      ‚Ä¢ SQLAlchemy ORM
    end note
    
    [External Service Client] as ESC
    note right of ESC
      ‚Ä¢ ProductServiceClient
      ‚Ä¢ HTTP Client (httpx)
    end note
    
    [Event Publisher] as Publisher
    note right of Publisher
      ‚Ä¢ RabbitMQ Publisher
      ‚Ä¢ Event Serializer
    end note
    
    [Schemas] as Schemas
    
    API --> Schemas : validates
    API --> BL : calls
    BL --> DAL : uses
    BL --> ESC : calls
    BL --> Publisher : publishes events
}

database "PostgreSQL" as DB {
    [orders table]
}

queue "RabbitMQ" as MQ {
    [orders_exchange]
}

[External Client] --> API : HTTP Request
API --> [External Client] : HTTP Response

DAL --> DB : SQL queries
ESC --> [Product Service] : HTTP GET
Publisher --> MQ : publishes events

@enduml
```

---

## 7. –ü–†–ò–ù–¶–ò–ü–ò –ü–†–û–Ñ–ö–¢–£–í–ê–ù–ù–Ø

### 7.1. Database per Service Pattern

–ö–æ–∂–µ–Ω –º—ñ–∫—Ä–æ—Å–µ—Ä–≤—ñ—Å –º–∞—î –≤–ª–∞—Å–Ω—É –±–∞–∑—É –¥–∞–Ω–∏—Ö, —â–æ –∑–∞–±–µ–∑–ø–µ—á—É—î:
- **–ù–µ–∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å:** –ó–º—ñ–Ω–∏ –≤ —Å—Ö–µ–º—ñ –ë–î –æ–¥–Ω–æ–≥–æ —Å–µ—Ä–≤—ñ—Å—É –Ω–µ –≤–ø–ª–∏–≤–∞—é—Ç—å –Ω–∞ —ñ–Ω—à—ñ
- **–ú–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è:** –ö–æ–∂–Ω–∞ –ë–î –º–æ–∂–µ –º–∞—Å—à—Ç–∞–±—É–≤–∞—Ç–∏—Å—è –æ–∫—Ä–µ–º–æ
- **–¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—á–Ω—É –≥–Ω—É—á–∫—ñ—Å—Ç—å:** –ú–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ä—ñ–∑–Ω—ñ –°–£–ë–î
- **–Ü–∑–æ–ª—è—Ü—ñ—é –ø–æ–º–∏–ª–æ–∫:** –ü—Ä–æ–±–ª–µ–º–∏ –∑ –æ–¥–Ω—ñ—î—é –ë–î –Ω–µ –≤–ø–ª–∏–≤–∞—é—Ç—å –Ω–∞ —ñ–Ω—à—ñ

**–ù–µ–¥–æ–ª—ñ–∫:** –°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—ñ –º—ñ–∂ —Å–µ—Ä–≤—ñ—Å–∞–º–∏ ‚Üí –≤–∏—Ä—ñ—à—É—î—Ç—å—Å—è —á–µ—Ä–µ–∑ eventual consistency —Ç–∞ –ø–æ–¥—ñ—ó.

### 7.2. API Gateway Pattern (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ –¥–ª—è –º–∞–π–±—É—Ç–Ω—å–æ–≥–æ)

–•–æ—á–∞ –∑–∞—Ä–∞–∑ –∫–ª—ñ—î–Ω—Ç–∏ –∑–≤–µ—Ä—Ç–∞—é—Ç—å—Å—è –Ω–∞–ø—Ä—è–º—É –¥–æ —Å–µ—Ä–≤—ñ—Å—ñ–≤, —É –ø—Ä–æ–¥–∞–∫—à–µ–Ω—ñ –≤–∞—Ä—Ç–æ –¥–æ–¥–∞—Ç–∏ API Gateway:

```
Client ‚Üí API Gateway ‚Üí Product Service
                    ‚Üí Order Service
```

**–ü–µ—Ä–µ–≤–∞–≥–∏:**
- –Ñ–¥–∏–Ω–∞ —Ç–æ—á–∫–∞ –≤—Ö–æ–¥—É
- –¶–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è
- Rate limiting
- –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü—ñ—è –∑–∞–ø–∏—Ç—ñ–≤

### 7.3. Event-Driven Architecture

–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞ –≤–∑–∞—î–º–æ–¥—ñ—è —á–µ—Ä–µ–∑ –ø–æ–¥—ñ—ó –¥–æ–∑–≤–æ–ª—è—î:
- –ó–º–µ–Ω—à–∏—Ç–∏ –∑–≤'—è–∑–∞–Ω—ñ—Å—Ç—å –º—ñ–∂ —Å–µ—Ä–≤—ñ—Å–∞–º–∏
- –ü—ñ–¥–≤–∏—â–∏—Ç–∏ –≤—ñ–¥–º–æ–≤–æ—Å—Ç—ñ–π–∫—ñ—Å—Ç—å
- –°–ø—Ä–æ—Å—Ç–∏—Ç–∏ –¥–æ–¥–∞–≤–∞–Ω–Ω—è –Ω–æ–≤–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π
- –ó–∞–±–µ–∑–ø–µ—á–∏—Ç–∏ eventual consistency

### 7.4. CQRS (Command Query Responsibility Segregation) - —á–∞—Å—Ç–∫–æ–≤–æ

Order Service —Ä–æ–∑–¥—ñ–ª—è—î –∫–æ–º–∞–Ω–¥–∏ (—Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è) —Ç–∞ –∑–∞–ø–∏—Ç–∏ (–æ—Ç—Ä–∏–º–∞–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω—å), —â–æ –¥–æ–∑–≤–æ–ª—è—î:
- –û–ø—Ç–∏–º—ñ–∑—É–≤–∞—Ç–∏ —á–∏—Ç–∞–Ω–Ω—è –æ–∫—Ä–µ–º–æ –≤—ñ–¥ –∑–∞–ø–∏—Å—É
- –ú–∞—Å—à—Ç–∞–±—É–≤–∞—Ç–∏ read/write –æ–ø–µ—Ä–∞—Ü—ñ—ó –Ω–µ–∑–∞–ª–µ–∂–Ω–æ

---

## 8. –ó–ê–ë–ï–ó–ü–ï–ß–ï–ù–ù–Ø –Ø–ö–û–°–¢–Ü –ê–†–•–Ü–¢–ï–ö–¢–£–†–ò

### 8.1. Bounded Context

–ö–æ–∂–µ–Ω —Å–µ—Ä–≤—ñ—Å –º–∞—î —á—ñ—Ç–∫—ñ –º–µ–∂—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–æ—Å—Ç—ñ:

| –°–µ—Ä–≤—ñ—Å | –©–æ –≤—Ö–æ–¥–∏—Ç—å | –©–æ –ù–ï –≤—Ö–æ–¥–∏—Ç—å |
|--------|-----------|---------------|
| Product Service | –¢–æ–≤–∞—Ä–∏, –∑–∞–ª–∏—à–∫–∏, –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó | –ó–∞–º–æ–≤–ª–µ–Ω–Ω—è, –ø–ª–∞—Ç–µ–∂—ñ, –¥–æ—Å—Ç–∞–≤–∫–∞ |
| Order Service | –ó–∞–º–æ–≤–ª–µ–Ω–Ω—è, —Å—Ç–∞—Ç—É—Å–∏ | –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ —Ç–æ–≤–∞—Ä–∏ (–æ–∫—Ä—ñ–º –¥–µ–Ω–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—ó) |
| Notification Service | –°–ø–æ–≤—ñ—â–µ–Ω–Ω—è | –ë—ñ–∑–Ω–µ—Å-–ª–æ–≥—ñ–∫–∞ –∑–∞–º–æ–≤–ª–µ–Ω—å |

### 8.2. –Ü–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ñ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü—ñ–π

**–î–ª—è Product Service:**
- –û–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–ª–∏—à–∫—ñ–≤ –ø–æ–≤–∏–Ω–Ω–æ –±—É—Ç–∏ —ñ–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–∏–º (–ø–æ–≤—Ç–æ—Ä–Ω–∞ –æ–±—Ä–æ–±–∫–∞ –ø–æ–¥—ñ—ó –Ω–µ –¥—É–±–ª—é—î –∑–º–µ–Ω—à–µ–Ω–Ω—è stock)
- –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è `event_id` –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —á–∏ –ø–æ–¥—ñ—è –≤–∂–µ –æ–±—Ä–æ–±–ª–µ–Ω–∞

**–î–ª—è Order Service:**
- POST /orders –≥–µ–Ω–µ—Ä—É—î —É–Ω—ñ–∫–∞–ª—å–Ω–∏–π order_id
- –ü–æ–≤—Ç–æ—Ä–Ω–µ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∑ —Ç–∏–º–∏ –∂ –¥–∞–Ω–∏–º–∏ —Å—Ç–≤–æ—Ä—é—î –Ω–æ–≤–µ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è (–Ω–µ —ñ–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º)
- –ú–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∏ `idempotency_key` –¥–ª—è –∑–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è –¥—É–±–ª—é–≤–∞–Ω–Ω—é

### 8.3. Error Handling

**HTTP Error Codes:**
- `200 OK` - –£—Å–ø—ñ—à–Ω–∞ –æ–ø–µ—Ä–∞—Ü—ñ—è
- `201 Created` - –†–µ—Å—É—Ä—Å —Å—Ç–≤–æ—Ä–µ–Ω–æ
- `400 Bad Request` - –ù–µ–∫–æ—Ä–µ–∫—Ç–Ω—ñ –¥–∞–Ω—ñ
- `404 Not Found` - –†–µ—Å—É—Ä—Å –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ
- `409 Conflict` - –ö–æ–Ω—Ñ–ª—ñ–∫—Ç (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –Ω–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ —Ç–æ–≤–∞—Ä—É)
- `500 Internal Server Error` - –í–Ω—É—Ç—Ä—ñ—à–Ω—è –ø–æ–º–∏–ª–∫–∞

**–§–æ—Ä–º–∞—Ç –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –∑ –ø–æ–º–∏–ª–∫–æ—é:**
```json
{
  "error": "ValidationError",
  "message": "Quantity must be greater than 0",
  "details": {
    "field": "quantity",
    "value": -5
  },
  "timestamp": "2025-11-15T10:40:00Z"
}
```

### 8.4. Retry Strategy –¥–ª—è RabbitMQ

**–ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è –ø–æ–≤—Ç–æ—Ä–Ω–∏—Ö —Å–ø—Ä–æ–±:**
- **Max retries:** 3
- **Retry delay:** –µ–∫—Å–ø–æ–Ω–µ–Ω—Ü—ñ–∞–ª—å–Ω–∞ –∑–∞—Ç—Ä–∏–º–∫–∞ (1s, 2s, 4s)
- **Dead Letter Queue:** –¥–ª—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å, —è–∫—ñ –Ω–µ –≤–¥–∞–ª–æ—Å—è –æ–±—Ä–æ–±–∏—Ç–∏

---

## 9. –¢–ï–•–ù–û–õ–û–ì–Ü–ß–ù–ò–ô –°–¢–ï–ö

### 9.1. –û–±“ë—Ä—É–Ω—Ç—É–≤–∞–Ω–Ω—è –≤–∏–±–æ—Ä—É —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ–π

| –¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—è | –û–±“ë—Ä—É–Ω—Ç—É–≤–∞–Ω–Ω—è |
|------------|---------------|
| **Python 3.11+** | –®–≤–∏–¥–∫–∞ —Ä–æ–∑—Ä–æ–±–∫–∞, –±–∞–≥–∞—Ç–æ –±—ñ–±–ª—ñ–æ—Ç–µ–∫, –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ñ—Å—Ç—å (asyncio) |
| **FastAPI** | –í–∏—Å–æ–∫–æ–ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–∏–π, –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è (OpenAPI), type hints |
| **PostgreSQL** | –ù–∞–¥—ñ–π–Ω–∞ —Ä–µ–ª—è—Ü—ñ–π–Ω–∞ –ë–î, –ø—ñ–¥—Ç—Ä–∏–º–∫–∞ JSON, —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó ACID |
| **RabbitMQ** | –°—Ç–∞–±—ñ–ª—å–Ω–∏–π –±—Ä–æ–∫–µ—Ä –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å, –≥–∞—Ä–∞–Ω—Ç–æ–≤–∞–Ω–∞ –¥–æ—Å—Ç–∞–≤–∫–∞, –ø—Ä–æ—Å—Ç–æ—Ç–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è |
| **SQLAlchemy** | –ü–æ–ø—É–ª—è—Ä–Ω–∏–π ORM –¥–ª—è Python, –ø—ñ–¥—Ç—Ä–∏–º–∫–∞ –º—ñ–≥—Ä–∞—Ü—ñ–π (Alembic) |
| **Pydantic** | –í–∞–ª—ñ–¥–∞—Ü—ñ—è –¥–∞–Ω–∏—Ö —á–µ—Ä–µ–∑ type hints, —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ FastAPI |
| **Docker** | –°—Ç–∞–Ω–¥–∞—Ä—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü—ñ—ó, —ñ–∑–æ–ª—è—Ü—ñ—è —Å–µ—Ä–µ–¥–æ–≤–∏—â |
| **Docker Compose** | –ü—Ä–æ—Å—Ç–æ—Ç–∞ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è –±–∞–≥–∞—Ç–æ–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω–∏—Ö —Å–∏—Å—Ç–µ–º |

### 9.2. –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∏ (–¥–ª—è –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è)

| –ö–∞—Ç–µ–≥–æ—Ä—ñ—è | –í–∏–±—Ä–∞–Ω–∞ —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ—è | –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∏ |
|-----------|-------------------|--------------|
| Backend Framework | FastAPI | Flask, Django REST Framework, Express.js |
| –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö | PostgreSQL | MySQL, MongoDB, CockroachDB |
| Message Broker | RabbitMQ | Apache Kafka, NATS, Redis Streams |
| ORM | SQLAlchemy | Django ORM, Tortoise ORM |

---

## 10. –ú–ê–°–®–¢–ê–ë–û–í–ê–ù–Ü–°–¢–¨ –¢–ê –í–Ü–î–ú–û–í–û–°–¢–Ü–ô–ö–Ü–°–¢–¨

### 10.1. –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–µ –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è

**Product Service:**
- –ú–æ–∂–µ –º–∞—Ç–∏ 2-3 —Ä–µ–ø–ª—ñ–∫–∏ –∑–∞ load balancer'–æ–º
- –û–ø–µ—Ä–∞—Ü—ñ—ó —á–∏—Ç–∞–Ω–Ω—è (GET) –ª–µ–≥–∫–æ –º–∞—Å—à—Ç–∞–±—É—é—Ç—å—Å—è
- –û–ø–µ—Ä–∞—Ü—ñ—ó –∑–∞–ø–∏—Å—É –ø–æ—Ç—Ä–µ–±—É—é—Ç—å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü—ñ—ó —á–µ—Ä–µ–∑ –ë–î

**Order Service:**
- 2-3 —Ä–µ–ø–ª—ñ–∫–∏ –¥–ª—è –æ–±—Ä–æ–±–∫–∏ –≤–µ–ª–∏–∫–æ—ó –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –∑–∞–º–æ–≤–ª–µ–Ω—å
- –ü—É–±–ª—ñ–∫–∞—Ü—ñ—è –≤ RabbitMQ –Ω–µ —Å—Ç–≤–æ—Ä—é—î –∫–æ–Ω—Ñ–ª—ñ–∫—Ç—ñ–≤

**Notification Service:**
- –ú–æ–∂–Ω–∞ –¥–æ–¥–∞–≤–∞—Ç–∏ –Ω–µ–æ–±–º–µ–∂–µ–Ω—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å consumer'—ñ–≤
- RabbitMQ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Ä–æ–∑–ø–æ–¥—ñ–ª—è—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –º—ñ–∂ –Ω–∏–º–∏

### 10.2. –í—ñ–¥–º–æ–≤–æ—Å—Ç—ñ–π–∫—ñ—Å—Ç—å (Fault Tolerance)

**–°—Ü–µ–Ω–∞—Ä—ñ–π 1: Product Service –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π**
- Order Service –Ω–µ –º–æ–∂–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è
- **–†—ñ—à–µ–Ω–Ω—è:** –ü–æ–≤–µ—Ä–Ω—É—Ç–∏ `503 Service Unavailable` + retry –º–µ—Ö–∞–Ω—ñ–∑–º –Ω–∞ –∫–ª—ñ—î–Ω—Ç—ñ

**–°—Ü–µ–Ω–∞—Ä—ñ–π 2: RabbitMQ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π**
- Order Service –Ω–µ –º–æ–∂–µ –æ–ø—É–±–ª—ñ–∫—É–≤–∞—Ç–∏ –ø–æ–¥—ñ—é
- **–†—ñ—à–µ–Ω–Ω—è:** –ó–±–µ—Ä–µ–≥—Ç–∏ –ø–æ–¥—ñ—é –ª–æ–∫–∞–ª—å–Ω–æ –≤ outbox table + —Ñ–æ–Ω–æ–≤–∏–π –ø—Ä–æ—Ü–µ—Å –¥–ª—è –ø—É–±–ª—ñ–∫–∞—Ü—ñ—ó

**–°—Ü–µ–Ω–∞—Ä—ñ–π 3: PostgreSQL –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π**
- –°–µ—Ä–≤—ñ—Å –Ω–µ –º–æ–∂–µ —á–∏—Ç–∞—Ç–∏/–ø–∏—Å–∞—Ç–∏ –¥–∞–Ω—ñ
- **–†—ñ—à–µ–Ω–Ω—è:** Health check –ø–æ–≤–µ—Ä–Ω–µ unhealthy ‚Üí Kubernetes –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å Pod

### 10.3. Circuit Breaker Pattern

–î–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∏—Ö –≤–∏–∫–ª–∏–∫—ñ–≤ Order Service ‚Üí Product Service:

```python
from circuitbreaker import circuit

@circuit(failure_threshold=5, recovery_timeout=60)
async def get_product(product_id: int):
    response = await httpx.get(f"{PRODUCT_SERVICE_URL}/products/{product_id}")
    return response.json()
```

**–õ–æ–≥—ñ–∫–∞:**
- –ü—ñ—Å–ª—è 5 –Ω–µ–≤–¥–∞–ª–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤ circuit "–≤—ñ–¥–∫—Ä–∏–≤–∞—î—Ç—å—Å—è"
- –ü—Ä–æ—Ç—è–≥–æ–º 60 —Å–µ–∫—É–Ω–¥ –∑–∞–ø–∏—Ç–∏ –Ω–µ –Ω–∞–¥—Å–∏–ª–∞—é—Ç—å—Å—è (fail fast)
- –ü—ñ—Å–ª—è recovery timeout circuit –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å —É "half-open" —Å—Ç–∞–Ω

---

## 11. –ë–ï–ó–ü–ï–ö–ê

### 11.1. –ê—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è —Ç–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è (–º–∞–π–±—É—Ç–Ω—î —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è)

**–î–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω-–≤–µ—Ä—Å—ñ—ó –≤–∞—Ä—Ç–æ –¥–æ–¥–∞—Ç–∏:**

1. **JWT Tokens** –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
2. **API Keys** –¥–ª—è –º—ñ–∂—Å–µ—Ä–≤—ñ—Å–Ω–æ—ó –≤–∑–∞—î–º–æ–¥—ñ—ó
3. **Role-Based Access Control (RBAC):**
   - `customer` - –º–æ–∂–µ –ª–∏—à–µ —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è
   - `admin` - –ø–æ–≤–Ω–∏–π –¥–æ—Å—Ç—É–ø –¥–æ –≤—Å—ñ—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π

### 11.2. –ó–∞—Ö–∏—Å—Ç –¥–∞–Ω–∏—Ö

- **Passwords:** –•–µ—à—É–≤–∞–Ω–Ω—è —á–µ—Ä–µ–∑ bcrypt (—è–∫—â–æ –¥–æ–¥–∞–º–æ user management)
- **Sensitive Data:** –ó–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –≤ Kubernetes Secrets –∞–±–æ HashiCorp Vault
- **Database Connections:** SSL/TLS —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è
- **RabbitMQ:** Authentication —á–µ—Ä–µ–∑ –ª–æ–≥—ñ–Ω/–ø–∞—Ä–æ–ª—å

### 11.3. Rate Limiting

–î–ª—è –∑–∞—Ö–∏—Å—Ç—É –≤—ñ–¥ DDoS –∞—Ç–∞–∫:

```python
from slowapi import Limiter

limiter = Limiter(key_func=get_remote_address)

@app.post("/orders")
@limiter.limit("10/minute")
async def create_order(...):
    ...
```

---

## 12. –í–ò–°–ù–û–í–ö–ò

–£ —Ö–æ–¥—ñ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ—ó —Ä–æ–±–æ—Ç–∏ ‚Ññ2 –±—É–ª–æ —É—Å–ø—ñ—à–Ω–æ —Å–ø—Ä–æ—î–∫—Ç–æ–≤–∞–Ω–æ –º—ñ–∫—Ä–æ—Å–µ—Ä–≤—ñ—Å–Ω—É –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä—É —Å–∏—Å—Ç–µ–º–∏ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è–º–∏ –æ–Ω–ª–∞–π–Ω-–º–∞–≥–∞–∑–∏–Ω—É.

**–û—Å–Ω–æ–≤–Ω—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏:**

1. **–î–µ–∫–æ–º–ø–æ–∑–∏—Ü—ñ—è —Å–∏—Å—Ç–µ–º–∏ –Ω–∞ 3 –º—ñ–∫—Ä–æ—Å–µ—Ä–≤—ñ—Å–∏:**
   - **Product Service** - —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∫–∞—Ç–∞–ª–æ–≥–æ–º —Ç–æ–≤–∞—Ä—ñ–≤ (8 endpoints)
   - **Order Service** - –æ–±—Ä–æ–±–∫–∞ –∑–∞–º–æ–≤–ª–µ–Ω—å (7 endpoints)
   - **Notification Service** - –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ñ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è (stateless)

2. **–°–ø—Ä–æ—î–∫—Ç–æ–≤–∞–Ω–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –±–∞–∑ –¥–∞–Ω–∏—Ö:**
   - `products` table –∑ 9 –ø–æ–ª—è–º–∏ + 2 —ñ–Ω–¥–µ–∫—Å–∏
   - `orders` table –∑ 10 –ø–æ–ª—è–º–∏ + 3 —ñ–Ω–¥–µ–∫—Å–∏
   - –ó–∞–±–µ–∑–ø–µ—á–µ–Ω–æ data integrity —á–µ—Ä–µ–∑ constraints

3. **–í–∏–∑–Ω–∞—á–µ–Ω–æ —Ç–∏–ø–∏ –≤–∑–∞—î–º–æ–¥—ñ—ó:**
   - **–°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞:** Order Service ‚Üí Product Service (REST API)
   - **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞:** –ß–µ—Ä–µ–∑ RabbitMQ –¥–ª—è event-driven communication

4. **–°—Ç–≤–æ—Ä–µ–Ω–æ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–Ω—ñ –¥—ñ–∞–≥—Ä–∞–º–∏:**
   - C4 Container Diagram (–∑–∞–≥–∞–ª—å–Ω–∞ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞)
   - Component Diagram –¥–ª—è Product Service
   - Component Diagram –¥–ª—è Order Service

5. **–ó–∞—Å—Ç–æ—Å–æ–≤–∞–Ω–æ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–Ω—ñ –ø–∞—Ç–µ—Ä–Ω–∏:**
   - Database per Service
   - Event-Driven Architecture
   - Bounded Context (DDD)
   - API First

6. **–í–∏–∑–Ω–∞—á–µ–Ω–æ —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ—á–Ω–∏–π —Å—Ç–µ–∫:**
   - Backend: Python + FastAPI
   - –ë–î: PostgreSQL
   - Message Broker: RabbitMQ
   - –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü—ñ—è: Docker + Docker Compose

7. **–°–ø—Ä–æ—î–∫—Ç–æ–≤–∞–Ω–æ –º–µ—Ö–∞–Ω—ñ–∑–º–∏ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è —è–∫–æ—Å—Ç—ñ:**
   - Error handling strategy
   - Retry mechanisms
   - Circuit Breaker –¥–ª—è fault tolerance
   - Health checks –¥–ª—è –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É

**–ù–∞—Å—Ç—É–ø–Ω—ñ –∫—Ä–æ–∫–∏:**

–£ –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ñ–π —Ä–æ–±–æ—Ç—ñ ‚Ññ3 –±—É–¥–µ –∑–º–æ–¥–µ–ª—å–æ–≤–∞–Ω–æ –¥–µ—Ç–∞–ª—å–Ω—É –≤–∑–∞—î–º–æ–¥—ñ—é –º—ñ–∂ —Å–µ—Ä–≤—ñ—Å–∞–º–∏ –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º Sequence Diagram –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ use case "–°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è" —Ç–∞ Deployment Diagram –¥–ª—è –æ–ø–∏—Å—É —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∏.

–°–ø—Ä–æ—î–∫—Ç–æ–≤–∞–Ω–∞ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ –ø–æ–≤–Ω—ñ—Å—Ç—é –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –≤–∏–º–æ–≥–∞–º, –≤–∏–∑–Ω–∞—á–µ–Ω–∏–º —É –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ñ–π —Ä–æ–±–æ—Ç—ñ ‚Ññ1, —Ç–∞ –∑–∞–±–µ–∑–ø–µ—á—É—î:
- ‚úÖ –ú–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω—ñ—Å—Ç—å (–≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–µ –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è –∫–æ–∂–Ω–æ–≥–æ —Å–µ—Ä–≤—ñ—Å—É)
- ‚úÖ –ù–∞–¥—ñ–π–Ω—ñ—Å—Ç—å (fault isolation, retry mechanisms)
- ‚úÖ –î–æ—Å—Ç—É–ø–Ω—ñ—Å—Ç—å (stateless —Å–µ—Ä–≤—ñ—Å–∏, health checks)
- ‚úÖ –£–∑–≥–æ–¥–∂–µ–Ω—ñ—Å—Ç—å (eventual consistency —á–µ—Ä–µ–∑ –ø–æ–¥—ñ—ó)
- ‚úÖ –ë–µ–∑–ø–µ–∫—É (–æ—Å–Ω–æ–≤–∏ –¥–ª—è JWT, rate limiting)

---

## 13. –í–Ü–î–ü–û–í–Ü–î–Ü –ù–ê –ö–û–ù–¢–†–û–õ–¨–ù–Ü –ó–ê–ü–ò–¢–ê–ù–ù–Ø

**1. –©–æ —Ç–∞–∫–µ –º—ñ–∫—Ä–æ—Å–µ—Ä–≤—ñ—Å–Ω–∞ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞?**

–ú—ñ–∫—Ä–æ—Å–µ—Ä–≤—ñ—Å–Ω–∞ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ ‚Äî —Ü–µ –ø—ñ–¥—Ö—ñ–¥ –¥–æ –ø—Ä–æ—î–∫—Ç—É–≤–∞–Ω–Ω—è –ø—Ä–æ–≥—Ä–∞–º–Ω–∏—Ö —Å–∏—Å—Ç–µ–º, —É —è–∫–æ–º—É –∑–∞—Å—Ç–æ—Å—É–Ω–æ–∫ —Ä–æ–∑–¥—ñ–ª—è—î—Ç—å—Å—è –Ω–∞ –Ω–∏–∑–∫—É –Ω–µ–∑–∞–ª–µ–∂–Ω–∏—Ö —Å–µ—Ä–≤—ñ—Å—ñ–≤. –ö–æ–∂–µ–Ω —Å–µ—Ä–≤—ñ—Å:
- –í–∏–∫–æ–Ω—É—î –æ–¥–Ω—É —á—ñ—Ç–∫—É –±—ñ–∑–Ω–µ—Å-—Ñ—É–Ω–∫—Ü—ñ—é (single responsibility)
- –ú–∞—î –≤–ª–∞—Å–Ω—É –±–∞–∑—É –¥–∞–Ω–∏—Ö (database per service)
- –ú–æ–∂–µ —Ä–æ–∑–≥–æ—Ä—Ç–∞—Ç–∏—Å—è —Ç–∞ –º–∞—Å—à—Ç–∞–±—É–≤–∞—Ç–∏—Å—è –Ω–µ–∑–∞–ª–µ–∂–Ω–æ
- –í–∑–∞—î–º–æ–¥—ñ—î –∑ —ñ–Ω—à–∏–º–∏ —á–µ—Ä–µ–∑ –¥–æ–±—Ä–µ –≤–∏–∑–Ω–∞—á–µ–Ω—ñ API

–£ –Ω–∞—à—ñ–π —Å–∏—Å—Ç–µ–º—ñ: Product Service —É–ø—Ä–∞–≤–ª—è—î —Ç–æ–≤–∞—Ä–∞–º–∏, Order Service - –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è–º–∏, Notification Service - —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è–º–∏. –ö–æ–∂–µ–Ω –º–∞—î –≤–ª–∞—Å–Ω—É –ë–î —ñ –º–æ–∂–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –∞–≤—Ç–æ–Ω–æ–º–Ω–æ.

**2. –£ —á–æ–º—É –≤—ñ–¥–º—ñ–Ω–Ω—ñ—Å—Ç—å –º–æ–Ω–æ–ª—ñ—Ç—É –≤—ñ–¥ –º—ñ–∫—Ä–æ—Å–µ—Ä–≤—ñ—Å—ñ–≤?**

**–ú–æ–Ω–æ–ª—ñ—Ç:**
- –Ñ–¥–∏–Ω–∏–π –∫–æ–¥-–±–µ–π—Å
- –Ñ–¥–∏–Ω–∞ –±–∞–∑–∞ –¥–∞–Ω–∏—Ö
- –†–æ–∑–≥–æ—Ä—Ç–∞—î—Ç—å—Å—è —è–∫ –æ–¥–Ω–µ —Ü—ñ–ª–µ
- –ú–∞—Å—à—Ç–∞–±—É—î—Ç—å—Å—è –ø–æ–≤–Ω—ñ—Å—Ç—é (–Ω–µ –º–æ–∂–Ω–∞ –º–∞—Å—à—Ç–∞–±—É–≤–∞—Ç–∏ –ª–∏—à–µ —á–∞—Å—Ç–∏–Ω—É)
- –ü—Ä–æ—Å—Ç–∞ —Ä–æ–∑—Ä–æ–±–∫–∞ –Ω–∞ –ø–æ—á–∞—Ç–∫—É, –∞–ª–µ —Å–∫–ª–∞–¥–Ω–∞ –ø—ñ–¥—Ç—Ä–∏–º–∫–∞ –ø—Ä–∏ –∑—Ä–æ—Å—Ç–∞–Ω–Ω—ñ

**–ú—ñ–∫—Ä–æ—Å–µ—Ä–≤—ñ—Å–∏:**
- –ú–Ω–æ–∂–∏–Ω–∞ –Ω–µ–∑–∞–ª–µ–∂–Ω–∏—Ö —Å–µ—Ä–≤—ñ—Å—ñ–≤
- –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö –Ω–∞ –∫–æ–∂–µ–Ω —Å–µ—Ä–≤—ñ—Å
- –ù–µ–∑–∞–ª–µ–∂–Ω–µ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è
- –í–∏–±—ñ—Ä–∫–æ–≤–µ –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è (—Ç—ñ–ª—å–∫–∏ —Ç–µ, —â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ)
- –°–∫–ª–∞–¥–Ω—ñ—à–∞ –ø–æ—á–∞—Ç–∫–æ–≤–∞ —Ä–æ–∑—Ä–æ–±–∫–∞, –∞–ª–µ –ª–µ–≥—à–µ –ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞—Ç–∏ —Ç–∞ —Ä–æ–∑–≤–∏–≤–∞—Ç–∏

**–ü—Ä–∏–∫–ª–∞–¥:** –£ –º–æ–Ω–æ–ª—ñ—Ç—ñ –≤—Å—ñ —Ñ—É–Ω–∫—Ü—ñ—ó (—Ç–æ–≤–∞—Ä–∏, –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è, —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è) –±—É–ª–∏ –± –≤ –æ–¥–Ω–æ–º—É –¥–æ–¥–∞—Ç–∫—É. –Ø–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –º–∞—Å—à—Ç–∞–±—É–≤–∞—Ç–∏ –∫–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä—ñ–≤ ‚Äî –¥–æ–≤–µ–¥–µ—Ç—å—Å—è –º–∞—Å—à—Ç–∞–±—É–≤–∞—Ç–∏ –≤–µ—Å—å –¥–æ–¥–∞—Ç–æ–∫. –£ –º—ñ–∫—Ä–æ—Å–µ—Ä–≤—ñ—Å–∞—Ö –º–∞—Å—à—Ç–∞–±—É—î–º–æ –ª–∏—à–µ Product Service.

**3. –Ø–∫—ñ –ø—Ä–∏–Ω—Ü–∏–ø–∏ –ø—Ä–æ—î–∫—Ç—É–≤–∞–Ω–Ω—è –º—ñ–∫—Ä–æ—Å–µ—Ä–≤—ñ—Å—ñ–≤ –≤–∏ –∑–Ω–∞—î—Ç–µ?**

1. **Single Responsibility Principle** - –æ–¥–∏–Ω —Å–µ—Ä–≤—ñ—Å = –æ–¥–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω—ñ—Å—Ç—å
2. **Bounded Context (DDD)** - —á—ñ—Ç–∫—ñ –º–µ–∂—ñ –¥–æ–º–µ–Ω—ñ–≤
3. **Database per Service** - –∫–æ–∂–µ–Ω —Å–µ—Ä–≤—ñ—Å –º–∞—î –≤–ª–∞—Å–Ω—É –ë–î
4. **Decentralized Data Management** - –Ω–µ–º–∞—î —î–¥–∏–Ω–æ—ó —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ—ó –ë–î
5. **Smart Endpoints, Dumb Pipes** - –ª–æ–≥—ñ–∫–∞ –≤ —Å–µ—Ä–≤—ñ—Å–∞—Ö, –∞ –Ω–µ –≤ —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ñ
6. **Design for Failure** - –ø—Ä–∏–ø—É—Å–∫–∞—Ç–∏, —â–æ —Å–µ—Ä–≤—ñ—Å–∏ –º–æ–∂—É—Ç—å –ø–∞–¥–∞—Ç–∏
7. **Evolutionary Design** - –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –µ–≤–æ–ª—é—Ü—ñ—ó –±–µ–∑ –ø–µ—Ä–µ–ø–∏—Å—É–≤–∞–Ω–Ω—è –≤—Å—å–æ–≥–æ
8. **Infrastructure Automation** - CI/CD, –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü—ñ—è
9. **API First** - —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∏ –ø—Ä–æ—î–∫—Ç—É—é—Ç—å—Å—è –¥–æ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó

**4. –Ø–∫ –≤–∏–∑–Ω–∞—á–∏—Ç–∏ –º–µ–∂—ñ —Å–µ—Ä–≤—ñ—Å—ñ–≤ (bounded context)?**

**–ú–µ—Ç–æ–¥–∏ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è:**

1. **Business Capabilities** - –≤–∏–¥—ñ–ª—è—î–º–æ —Å–µ—Ä–≤—ñ—Å–∏ –∑–∞ –±—ñ–∑–Ω–µ—Å-—Ñ—É–Ω–∫—Ü—ñ—è–º–∏:
   - "–£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∫–∞—Ç–∞–ª–æ–≥–æ–º" ‚Üí Product Service
   - "–û–±—Ä–æ–±–∫–∞ –∑–∞–º–æ–≤–ª–µ–Ω—å" ‚Üí Order Service

2. **Domain-Driven Design (DDD):**
   - –Ü–¥–µ–Ω—Ç–∏—Ñ—ñ–∫—É—î–º–æ –¥–æ–º–µ–Ω–∏ (—Å—É–±–¥–æ–º–µ–Ω–∏)
   - –í–∏–¥—ñ–ª—è—î–º–æ bounded contexts
   - –ö–æ–∂–µ–Ω context = –æ–∫—Ä–µ–º–∏–π –º—ñ–∫—Ä–æ—Å–µ—Ä–≤—ñ—Å

3. **Data Ownership:**
   - –•—Ç–æ "–≤–æ–ª–æ–¥—ñ—î" —Ü–∏–º–∏ –¥–∞–Ω–∏–º–∏?
   - Product Service –≤–æ–ª–æ–¥—ñ—î —Ç–æ–≤–∞—Ä–∞–º–∏
   - Order Service –≤–æ–ª–æ–¥—ñ—î –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è–º–∏

4. **Team Structure:**
   - –ú–æ–∂–ª–∏–≤—ñ—Å—Ç—å –Ω–µ–∑–∞–ª–µ–∂–Ω–æ—ó —Ä–æ–∑—Ä–æ–±–∫–∏ —Ä—ñ–∑–Ω–∏–º–∏ –∫–æ–º–∞–Ω–¥–∞–º–∏
   - –ö–æ–º–∞–Ω–¥–∞ "–ö–∞—Ç–∞–ª–æ–≥" vs –ö–æ–º–∞–Ω–¥–∞ "–ó–∞–º–æ–≤–ª–µ–Ω–Ω—è"

5. **Rate of Change:**
   - –§—É–Ω–∫—Ü—ñ—ó, —â–æ —á–∞—Å—Ç–æ –∑–º—ñ–Ω—é—é—Ç—å—Å—è ‚Üí –æ–∫—Ä–µ–º—ñ —Å–µ—Ä–≤—ñ—Å–∏
   - –¢–æ–≤–∞—Ä–∏ –¥–æ–¥–∞—é—Ç—å—Å—è —á–∞—Å—Ç–æ ‚Üí Product Service –æ–∫—Ä–µ–º–æ

**–ü—Ä–∞–∫—Ç–∏—á–Ω–µ –ø—Ä–∞–≤–∏–ª–æ:** –Ø–∫—â–æ –¥–≤—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –º–∞—é—Ç—å —Ä—ñ–∑–Ω—ñ:
- –ë—ñ–∑–Ω–µ—Å-—Ä–æ–ª—ñ
- –í–ª–∞—Å–Ω–∏–∫—ñ–≤ –¥–∞–Ω–∏—Ö
- –í–∏–º–æ–≥–∏ –¥–æ –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è
- –®–≤–∏–¥–∫—ñ—Å—Ç—å –∑–º—ñ–Ω
‚Üí –í–∞—Ä—Ç–æ –≤–∏–¥—ñ–ª–∏—Ç–∏ –æ–∫—Ä–µ–º—ñ —Å–µ—Ä–≤—ñ—Å–∏

**5. –©–æ —Ç–∞–∫–µ API Gateway —ñ –Ω–∞–≤—ñ—â–æ –≤—ñ–Ω –ø–æ—Ç—Ä—ñ–±–µ–Ω?**

**API Gateway** - —Ü–µ —î–¥–∏–Ω–∞ —Ç–æ—á–∫–∞ –≤—Ö–æ–¥—É –¥–ª—è –≤—Å—ñ—Ö –∫–ª—ñ—î–Ω—Ç—Å—å–∫–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤ –¥–æ –º—ñ–∫—Ä–æ—Å–µ—Ä–≤—ñ—Å—ñ–≤. –í–∏—Å—Ç—É–ø–∞—î —è–∫ "—Ñ–∞—Å–∞–¥" –ø–µ—Ä–µ–¥ –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ–º–∏ —Å–µ—Ä–≤—ñ—Å–∞–º–∏.

**–û—Å–Ω–æ–≤–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó:**

1. **Routing** - –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü—ñ—è –∑–∞–ø–∏—Ç—ñ–≤ –¥–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏—Ö —Å–µ—Ä–≤—ñ—Å—ñ–≤
   ```
   /api/products/* ‚Üí Product Service
   /api/orders/* ‚Üí Order Service
   ```

2. **Authentication & Authorization** - —Ü–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ JWT —Ç–æ–∫–µ–Ω—ñ–≤

3. **Rate Limiting** - –æ–±–º–µ–∂–µ–Ω–Ω—è –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –∑–∞–ø–∏—Ç—ñ–≤

4. **Load Balancing** - —Ä–æ–∑–ø–æ–¥—ñ–ª –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –º—ñ–∂ —Ä–µ–ø–ª—ñ–∫–∞–º–∏

5. **Request/Response Transformation** - –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ñ–æ—Ä–º–∞—Ç—ñ–≤

6. **Caching** - –∫–µ—à—É–≤–∞–Ω–Ω—è –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π –¥–ª—è –∑–º–µ–Ω—à–µ–Ω–Ω—è –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è

7. **Monitoring & Logging** - —Ü–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è

**–ù–∞–≤—ñ—â–æ –ø–æ—Ç—Ä—ñ–±–µ–Ω:**
- –ö–ª—ñ—î–Ω—Ç –Ω–µ –∑–Ω–∞—î –ø—Ä–æ –≤–Ω—É—Ç—Ä—ñ—à–Ω—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Å–∏—Å—Ç–µ–º–∏
- –°–ø—Ä–æ—â—É—î –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—é (–æ–¥–∏–Ω —Ä–∞–∑ –≤ gateway)
- –ó–º–µ–Ω—à—É—î –∫—ñ–ª—å–∫—ñ—Å—Ç—å round-trips (aggregation)
- –õ–µ–≥—à–µ –¥–æ–¥–∞–≤–∞—Ç–∏ –Ω–æ–≤—ñ —Å–µ—Ä–≤—ñ—Å–∏ –±–µ–∑ –∑–º—ñ–Ω–∏ –∫–ª—ñ—î–Ω—Ç—ñ–≤

**–ü–æ–ø—É–ª—è—Ä–Ω—ñ —Ä—ñ—à–µ–Ω–Ω—è:** Kong, Nginx, AWS API Gateway, Traefik

**6. –Ø–∫ –∑–∞–±–µ–∑–ø–µ—á—É—î—Ç—å—Å—è —É–∑–≥–æ–¥–∂–µ–Ω—ñ—Å—Ç—å –¥–∞–Ω–∏—Ö –º—ñ–∂ –º—ñ–∫—Ä–æ—Å–µ—Ä–≤—ñ—Å–∞–º–∏?**

–£ –º—ñ–∫—Ä–æ—Å–µ—Ä–≤—ñ—Å–Ω—ñ–π –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä—ñ –Ω–µ–º–∞—î —Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π ACID –º—ñ–∂ —Å–µ—Ä–≤—ñ—Å–∞–º–∏. –ó–∞–º—ñ—Å—Ç—å —Ü—å–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å:

**1. Eventual Consistency (–ï–≤–µ–Ω—Ç—É–∞–ª—å–Ω–∞ —É–∑–≥–æ–¥–∂–µ–Ω—ñ—Å—Ç—å):**

–î–∞–Ω—ñ —Å—Ç–∞—é—Ç—å —É–∑–≥–æ–¥–∂–µ–Ω–∏–º–∏ —á–µ—Ä–µ–∑ –¥–µ—è–∫–∏–π —á–∞—Å –ø—ñ—Å–ª—è –ø–æ–¥—ñ—ó.

**–ü—Ä–∏–∫–ª–∞–¥ —É –Ω–∞—à—ñ–π —Å–∏—Å—Ç–µ–º—ñ:**
```
1. Order Service —Å—Ç–≤–æ—Ä—é—î –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è (orders_db: stock –Ω–µ –∑–º—ñ–Ω–∏–≤—Å—è —â–µ)
2. Order Service –ø—É–±–ª—ñ–∫—É—î OrderCreated
3. Product Service –æ—Ç—Ä–∏–º—É—î –ø–æ–¥—ñ—é (—á–µ—Ä–µ–∑ 100-500 –º—Å)
4. Product Service –æ–Ω–æ–≤–ª—é—î stock
‚Üí –¢–µ–ø–µ—Ä –¥–∞–Ω—ñ —É–∑–≥–æ–¥–∂–µ–Ω—ñ
```

**2. Saga Pattern:**

–î–ª—è –¥–æ–≤–≥–æ—Ç—Ä–∏–≤–∞–ª–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å –ª–æ–∫–∞–ª—å–Ω–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π + –∫–æ–º–ø–µ–Ω—Å–∞—Ü—ñ–π–Ω—ñ –¥—ñ—ó –ø—Ä–∏ –ø–æ–º–∏–ª–∫–∞—Ö.

**Choreography Saga (—á–µ—Ä–µ–∑ –ø–æ–¥—ñ—ó):**
```
Order Service: CreateOrder ‚Üí publish OrderCreated
Product Service: ReduceStock ‚Üí publish StockReduced
Payment Service: ChargePayment ‚Üí publish PaymentCompleted
```

–Ø–∫—â–æ Payment fails:
```
Payment Service: publish PaymentFailed
Product Service: RestoreStock (–∫–æ–º–ø–µ–Ω—Å–∞—Ü—ñ—è)
Order Service: CancelOrder (–∫–æ–º–ø–µ–Ω—Å–∞—Ü—ñ—è)
```

**3. Event Sourcing:**

–ó–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –≤—Å—ñ—Ö –∑–º—ñ–Ω —è–∫ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç—ñ –ø–æ–¥—ñ–π (–∑–∞–º—ñ—Å—Ç—å –ø–æ—Ç–æ—á–Ω–æ–≥–æ —Å—Ç–∞–Ω—É).

**4. API Composition:**

Order Service —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –∑–∞–ø–∏—Ç—É—î Product Service –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –∞–∫—Ç—É–∞–ª—å–Ω–∏—Ö –¥–∞–Ω–∏—Ö –ø–µ—Ä–µ–¥ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è–º –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è.

**–£ –Ω–∞—à—ñ–π —Å–∏—Å—Ç–µ–º—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ:**
- ‚úÖ Eventual Consistency (—á–µ—Ä–µ–∑ RabbitMQ)
- ‚úÖ API Composition (Order ‚Üí Product –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞)
- ‚úÖ Idempotency (–ø–æ–≤—Ç–æ—Ä–Ω–∞ –æ–±—Ä–æ–±–∫–∞ –ø–æ–¥—ñ—ó –Ω–µ –¥—É–±–ª—é—î –¥—ñ—ó)

**7. –Ø–∫—ñ –ø–µ—Ä–µ–≤–∞–≥–∏ —Ç–∞ –Ω–µ–¥–æ–ª—ñ–∫–∏ –º–∞—î –º—ñ–∫—Ä–æ—Å–µ—Ä–≤—ñ—Å–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥?**

**–ü–µ—Ä–µ–≤–∞–≥–∏ ‚úÖ:**

1. **–ù–µ–∑–∞–ª–µ–∂–Ω–µ –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è:**
   - Product Service –æ—Ç—Ä–∏–º—É—î –±–∞–≥–∞—Ç–æ —á–∏—Ç–∞–Ω—å ‚Üí –º–∞—Å—à—Ç–∞–±—É—î–º–æ –ª–∏—à–µ –π–æ–≥–æ

2. **–¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—á–Ω–∞ –≥–µ—Ç–µ—Ä–æ–≥–µ–Ω–Ω—ñ—Å—Ç—å:**
   - Product Service: Python
   - Payment Service: Go (—É –º–∞–π–±—É—Ç–Ω—å–æ–º—É)

3. **Fault Isolation:**
   - –Ø–∫—â–æ Notification Service –ø–∞–¥–∞—î, –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –≤—Å–µ –æ–¥–Ω–æ —Å—Ç–≤–æ—Ä—é—é—Ç—å—Å—è

4. **–ù–µ–∑–∞–ª–µ–∂–Ω–µ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è:**
   - –ú–æ–∂–Ω–∞ –æ–Ω–æ–≤–∏—Ç–∏ Order Service –±–µ–∑ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫—É Product Service

5. **–û—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—è –∫–æ–º–∞–Ω–¥:**
   - –†—ñ–∑–Ω—ñ –∫–æ–º–∞–Ω–¥–∏ –ø—Ä–∞—Ü—é—é—Ç—å –Ω–∞–¥ —Ä—ñ–∑–Ω–∏–º–∏ —Å–µ—Ä–≤—ñ—Å–∞–º–∏ –ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ

6. **–õ–µ–≥—à–µ –ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞—Ç–∏:**
   - –ö–æ–∂–µ–Ω —Å–µ—Ä–≤—ñ—Å –º–∞—î –Ω–µ–≤–µ–ª–∏–∫–∏–π –∫–æ–¥-–±–µ–π—Å

**–ù–µ–¥–æ–ª—ñ–∫–∏ ‚ùå:**

1. **–°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å —Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω–æ—ó —Å–∏—Å—Ç–µ–º–∏:**
   - –ü–æ—Ç—Ä—ñ–±–µ–Ω –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥, —Ç—Ä–µ–π—Å–∏–Ω–≥, –ª–æ–≥—É–≤–∞–Ω–Ω—è

2. **–ú–µ—Ä–µ–∂–µ–≤—ñ –∑–∞—Ç—Ä–∏–º–∫–∏:**
   - –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ñ –≤–∏–∫–ª–∏–∫–∏ –º—ñ–∂ —Å–µ—Ä–≤—ñ—Å–∞–º–∏ –ø–æ–≤—ñ–ª—å–Ω—ñ—à—ñ –Ω—ñ–∂ –ª–æ–∫–∞–ª—å–Ω—ñ

3. **Eventual Consistency:**
   - –î–∞–Ω—ñ –Ω–µ –∑–∞–≤–∂–¥–∏ —É–∑–≥–æ–¥–∂–µ–Ω—ñ –º–∏—Ç—Ç—î–≤–æ

4. **–°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è:**
   - –ü–æ—Ç—Ä—ñ–±–Ω–æ —Ç–µ—Å—Ç—É–≤–∞—Ç–∏ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó –º—ñ–∂ —Å–µ—Ä–≤—ñ—Å–∞–º–∏

5. **DevOps overhead:**
   - –ü–æ—Ç—Ä—ñ–±–µ–Ω Docker, Kubernetes, CI/CD pipelines

6. **Debugging —Å–∫–ª–∞–¥–Ω—ñ—à–∏–π:**
   - –ó–∞–ø–∏—Ç –ø—Ä–æ—Ö–æ–¥–∏—Ç—å —á–µ—Ä–µ–∑ –¥–µ–∫—ñ–ª—å–∫–∞ —Å–µ—Ä–≤—ñ—Å—ñ–≤

**–í–∏—Å–Ω–æ–≤–æ–∫:** –ú—ñ–∫—Ä–æ—Å–µ—Ä–≤—ñ—Å–∏ –≤–∞—Ä—Ç–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥–ª—è:
- –í–µ–ª–∏–∫–∏—Ö —Å–∏—Å—Ç–µ–º –∑ —Ä—ñ–∑–Ω–∏–º–∏ –≤–∏–º–æ–≥–∞–º–∏ –¥–æ –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è
- –ü—Ä–æ—î–∫—Ç—ñ–≤ –∑ –±–∞–≥–∞—Ç—å–º–∞ –∫–æ–º–∞–Ω–¥–∞–º–∏
- –°–∏—Å—Ç–µ–º, —â–æ –∞–∫—Ç–∏–≤–Ω–æ —Ä–æ–∑–≤–∏–≤–∞—é—Ç—å—Å—è

–î–ª—è –º–∞–ª–∏—Ö –ø—Ä–æ—î–∫—Ç—ñ–≤ –∫—Ä–∞—â–µ –ø–æ—á–∞—Ç–∏ –∑ –º–æ–Ω–æ–ª—ñ—Ç—É.

---

## –î–û–î–ê–¢–û–ö –ê. SQL-—Å–∫—Ä–∏–ø—Ç–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞–±–ª–∏—Ü—å

### Product Service Database

```sql
-- –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –±–∞–∑–∏ –¥–∞–Ω–∏—Ö
CREATE DATABASE products_db;

-- –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –ë–î
\c products_db;

-- –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞–±–ª–∏—Ü—ñ products
CREATE TABLE products (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    description TEXT,
    price DECIMAL(10,2) NOT NULL CHECK (price >= 0),
    stock INTEGER NOT NULL DEFAULT 0 CHECK (stock >= 0),
    category VARCHAR(100),
    image_url VARCHAR(500),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- –Ü–Ω–¥–µ–∫—Å–∏ –¥–ª—è –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó –∑–∞–ø–∏—Ç—ñ–≤
CREATE INDEX idx_products_category ON products(category);
CREATE INDEX idx_products_stock ON products(stock) WHERE stock > 0;
CREATE INDEX idx_products_name ON products(name);

-- –¢—Ä–∏–≥–µ—Ä –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è updated_at
CREATE OR REPLACE FUNCTION update_updated_at_column()
RETURNS TRIGGER AS $
BEGIN
    NEW.updated_at = CURRENT_TIMESTAMP;
    RETURN NEW;
END;
$ language 'plpgsql';

CREATE TRIGGER update_products_updated_at BEFORE UPDATE ON products
FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();

-- –¢–µ—Å—Ç–æ–≤—ñ –¥–∞–Ω—ñ
INSERT INTO products (name, description, price, stock, category) VALUES
('–ù–æ—É—Ç–±—É–∫ Lenovo ThinkPad', '–ü—Ä–æ—Ñ–µ—Å—ñ–π–Ω–∏–π –Ω–æ—É—Ç–±—É–∫ –¥–ª—è —Ä–æ–±–æ—Ç–∏', 25999.99, 15, '–ï–ª–µ–∫—Ç—Ä–æ–Ω—ñ–∫–∞'),
('–ú–∏—à–∫–∞ Logitech MX Master', '–ë–µ–∑–¥—Ä–æ—Ç–æ–≤–∞ –º–∏—à–∫–∞', 2499.00, 50, '–ê–∫—Å–µ—Å—É–∞—Ä–∏'),
('–ö–ª–∞–≤—ñ–∞—Ç—É—Ä–∞ Keychron K2', '–ú–µ—Ö–∞–Ω—ñ—á–Ω–∞ –∫–ª–∞–≤—ñ–∞—Ç—É—Ä–∞', 3500.00, 30, '–ê–∫—Å–µ—Å—É–∞—Ä–∏'),
('–ú–æ–Ω—ñ—Ç–æ—Ä Dell 27"', '4K –º–æ–Ω—ñ—Ç–æ—Ä –¥–ª—è —Ä–æ–±–æ—Ç–∏', 12999.99, 10, '–ï–ª–µ–∫—Ç—Ä–æ–Ω—ñ–∫–∞'),
('–ù–∞–≤—É—à–Ω–∏–∫–∏ Sony WH-1000XM4', '–ù–∞–≤—É—à–Ω–∏–∫–∏ –∑ —à—É–º–æ–∑–∞–≥–ª—É—à–µ–Ω–Ω—è–º', 8999.00, 25, '–ê—É–¥—ñ–æ');
```

### Order Service Database

```sql
-- –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –±–∞–∑–∏ –¥–∞–Ω–∏—Ö
CREATE DATABASE orders_db;

-- –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –ë–î
\c orders_db;

-- –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞–±–ª–∏—Ü—ñ orders
CREATE TABLE orders (
    id SERIAL PRIMARY KEY,
    product_id INTEGER NOT NULL,
    product_name VARCHAR(255) NOT NULL,
    quantity INTEGER NOT NULL CHECK (quantity > 0),
    unit_price DECIMAL(10,2) NOT NULL,
    total_price DECIMAL(10,2) NOT NULL,
    status VARCHAR(50) NOT NULL DEFAULT 'pending',
    customer_email VARCHAR(255),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT valid_status CHECK (status IN ('pending', 'processing', 'completed', 'cancelled'))
);

-- –Ü–Ω–¥–µ–∫—Å–∏
CREATE INDEX idx_orders_status ON orders(status);
CREATE INDEX idx_orders_created_at ON orders(created_at DESC);
CREATE INDEX idx_orders_customer_email ON orders(customer_email);
CREATE INDEX idx_orders_product_id ON orders(product_id);

-- –¢—Ä–∏–≥–µ—Ä –¥–ª—è updated_at
CREATE TRIGGER update_orders_updated_at BEFORE UPDATE ON orders
FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();
```

---

## –î–û–î–ê–¢–û–ö –ë. –ü—Ä–∏–∫–ª–∞–¥–∏ API –∑–∞–ø–∏—Ç—ñ–≤ (–¥–ª—è Postman)

### Product Service

**1. –û—Ç—Ä–∏–º–∞—Ç–∏ –≤—Å—ñ —Ç–æ–≤–∞—Ä–∏:**
```http
GET http://localhost:8001/products
```

**2. –û—Ç—Ä–∏–º–∞—Ç–∏ —Ç–æ–≤–∞—Ä –∑–∞ ID:**
```http
GET http://localhost:8001/products/1
```

**3. –°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–∏–π —Ç–æ–≤–∞—Ä:**
```http
POST http://localhost:8001/products
Content-Type: application/json

{
  "name": "–ù–æ—É—Ç–±—É–∫ ASUS ROG",
  "description": "–Ü–≥—Ä–æ–≤–∏–π –Ω–æ—É—Ç–±—É–∫",
  "price": 45999.99,
  "stock": 5,
  "category": "–ï–ª–µ–∫—Ç—Ä–æ–Ω—ñ–∫–∞"
}
```

**4. –û–Ω–æ–≤–∏—Ç–∏ —Ç–æ–≤–∞—Ä:**
```http
PUT http://localhost:8001/products/1
Content-Type: application/json

{
  "name": "–ù–æ—É—Ç–±—É–∫ Lenovo ThinkPad (–æ–Ω–æ–≤–ª–µ–Ω–æ)",
  "price": 24999.99,
  "stock": 20
}
```

**5. –û–Ω–æ–≤–∏—Ç–∏ –∑–∞–ª–∏—à–æ–∫:**
```http
PATCH http://localhost:8001/products/1/stock
Content-Type: application/json

{
  "quantity": -3
}
```

### Order Service

**1. –°—Ç–≤–æ—Ä–∏—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è:**
```http
POST http://localhost:8002/orders
Content-Type: application/json

{
  "product_id": 1,
  "quantity": 2,
  "customer_email": "customer@example.com"
}
```

**2. –û—Ç—Ä–∏–º–∞—Ç–∏ –≤—Å—ñ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è:**
```http
GET http://localhost:8002/orders
```

**3. –û–Ω–æ–≤–∏—Ç–∏ —Å—Ç–∞—Ç—É—Å –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è:**
```http
PATCH http://localhost:8002/orders/1/status
Content-Type: application/json

{
  "status": "completed"
}
```

---

## –î–û–î–ê–¢–û–ö –í. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç—É

```
online-shop-microservices/
‚îú‚îÄ‚îÄ product-service/
‚îÇ   ‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ main.py              # FastAPI app
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models.py            # SQLAlchemy models
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ schemas.py           # Pydantic schemas
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ database.py          # DB connection
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config.py            # Configuration
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ products.py      # API endpoints
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ product_service.py  # Business logic
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ repositories/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ product_repository.py  # Data access
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ consumers/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ order_consumer.py     # RabbitMQ consumer
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile
‚îÇ   ‚îú‚îÄ‚îÄ requirements.txt
‚îÇ   ‚îî‚îÄ‚îÄ .env.example
‚îÇ
‚îú‚îÄ‚îÄ order-service/
‚îÇ   ‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ main.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ schemas.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ database.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ orders.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ order_service.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ product_client.py     # HTTP client –¥–ª—è Product Service
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ repositories/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ order_repository.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ publishers/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ event_publisher.py    # RabbitMQ publisher
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile
‚îÇ   ‚îú‚îÄ‚îÄ requirements.txt
‚îÇ   ‚îî‚îÄ‚îÄ .env.example
‚îÇ
‚îú‚îÄ‚îÄ notification-service/
‚îÇ   ‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ main.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ consumers/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ order_consumer.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ services/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ notification_service.py
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile
‚îÇ   ‚îú‚îÄ‚îÄ requirements.txt
‚îÇ   ‚îî‚îÄ‚îÄ .env.example
‚îÇ
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ .env.example
‚îî‚îÄ‚îÄ README.md
```