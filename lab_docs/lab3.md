# –õ–ê–ë–û–†–ê–¢–û–†–ù–ê –†–û–ë–û–¢–ê ‚Ññ3
## –ú–æ–¥–µ–ª—é–≤–∞–Ω–Ω—è –≤–∑–∞—î–º–æ–¥—ñ—ó —Å–µ—Ä–≤—ñ—Å—ñ–≤

**–¢–µ–º–∞ –ø—Ä–æ–µ–∫—Ç—É:** –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è–º–∏ —É –Ω–µ–≤–µ–ª–∏–∫–æ–º—É –æ–Ω–ª–∞–π–Ω-–º–∞–≥–∞–∑–∏–Ω—ñ

**–í–∏–∫–æ–Ω–∞–≤:** [–í–∞—à–µ —ñ–º'—è]  
**–ì—Ä—É–ø–∞:** [–í–∞—à–∞ –≥—Ä—É–ø–∞]  
**–î–∞—Ç–∞:** 15.11.2025

---

## 1. –ú–ï–¢–ê –†–û–ë–û–¢–ò

–ó–º–æ–¥–µ–ª—é–≤–∞—Ç–∏ –ø–æ—Ç–æ–∫–∏ –¥–∞–Ω–∏—Ö —É —Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω—ñ–π —Å–∏—Å—Ç–µ–º—ñ, –æ–ø–∏—Å–∞—Ç–∏ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å –≤–∑–∞—î–º–æ–¥—ñ—ó –º—ñ–∂ –º—ñ–∫—Ä–æ—Å–µ—Ä–≤—ñ—Å–∞–º–∏ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏—Ö use cases, –≤–∏–∑–Ω–∞—á–∏—Ç–∏ —Ç–∏–ø–∏ –º—ñ–∂—Å–µ—Ä–≤—ñ—Å–Ω–æ—ó –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—ó —Ç–∞ –ø–æ–±—É–¥—É–≤–∞—Ç–∏ –¥—ñ–∞–≥—Ä–∞–º–∏ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç—ñ (Sequence Diagram) —Ç–∞ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è (Deployment Diagram).

---

## 2. –ö–û–†–û–¢–ö–Ü –¢–ï–û–†–ï–¢–ò–ß–ù–Ü –í–Ü–î–û–ú–û–°–¢–Ü

### 2.1. –í–∏–¥–∏ –º—ñ–∂—Å–µ—Ä–≤—ñ—Å–Ω–æ—ó –≤–∑–∞—î–º–æ–¥—ñ—ó

–£ —Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω–∏—Ö –ø—Ä–æ–≥—Ä–∞–º–Ω–∏—Ö —Å–∏—Å—Ç–µ–º–∞—Ö –º—ñ–∫—Ä–æ—Å–µ—Ä–≤—ñ—Å–∏ –≤–∑–∞—î–º–æ–¥—ñ—é—Ç—å –º—ñ–∂ —Å–æ–±–æ—é –¥–≤–æ–º–∞ –æ—Å–Ω–æ–≤–Ω–∏–º–∏ —Å–ø–æ—Å–æ–±–∞–º–∏:

#### –°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞ –≤–∑–∞—î–º–æ–¥—ñ—è
–°–µ—Ä–≤—ñ—Å –≤–∏–∫–ª–∏–∫–∞—î —ñ–Ω—à–∏–π —Å–µ—Ä–≤—ñ—Å —ñ —á–µ–∫–∞—î –Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å. –ù–∞–π–ø–æ—à–∏—Ä–µ–Ω—ñ—à—ñ –ø—Ä–æ—Ç–æ–∫–æ–ª–∏:
- **REST (HTTP/HTTPS)** - –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ HTTP-–º–µ—Ç–æ–¥–∏ (GET, POST, PUT, DELETE)
- **gRPC** - –≤–∏—Å–æ–∫–æ–ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–∏–π –ø—Ä–æ—Ç–æ–∫–æ–ª –Ω–∞ –æ—Å–Ω–æ–≤—ñ HTTP/2 –∑ –±—ñ–Ω–∞—Ä–Ω–æ—é —Å–µ—Ä—ñ–∞–ª—ñ–∑–∞—Ü—ñ—î—é

**–ü–µ—Ä–µ–≤–∞–≥–∏:**
- –ü—Ä–æ—Å—Ç–æ—Ç–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó
- –ù–µ–≥–∞–π–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å
- –õ–µ–≥–∫–æ –¥–µ–±–∞–∂–∏—Ç–∏

**–ù–µ–¥–æ–ª—ñ–∫–∏:**
- –ñ–æ—Ä—Å—Ç–∫–∞ –∑–≤'—è–∑–∞–Ω—ñ—Å—Ç—å (tight coupling)
- –ö–∞—Å–∫–∞–¥–Ω—ñ –≤—ñ–¥–º–æ–≤–∏
- –ë–ª–æ–∫—É–≤–∞–Ω–Ω—è –ø—Ä–∏ –æ—á—ñ–∫—É–≤–∞–Ω–Ω—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ

#### –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞ –≤–∑–∞—î–º–æ–¥—ñ—è
–°–µ—Ä–≤—ñ—Å –Ω–∞–¥—Å–∏–ª–∞—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∞–±–æ –ø–æ–¥—ñ—é, –Ω–µ –æ—á—ñ–∫—É—é—á–∏ –Ω–µ–≥–∞–π–Ω–æ—ó –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ. –†–µ–∞–ª—ñ–∑—É—î—Ç—å—Å—è —á–µ—Ä–µ–∑ –±—Ä–æ–∫–µ—Ä–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å:
- **RabbitMQ** - –∫–ª–∞—Å–∏—á–Ω–∏–π –±—Ä–æ–∫–µ—Ä –∑ —á–µ—Ä–≥–∞–º–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å
- **Apache Kafka** - —Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –ø–æ—Ç–æ–∫–æ–≤–æ—ó –æ–±—Ä–æ–±–∫–∏ –ø–æ–¥—ñ–π
- **NATS** - –ª–µ–≥–∫–æ–≤–∞–≥–æ–≤–∏–π –±—Ä–æ–∫–µ—Ä –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å

**–ü–µ—Ä–µ–≤–∞–≥–∏:**
- –°–ª–∞–±–∫–∞ –∑–≤'—è–∑–∞–Ω—ñ—Å—Ç—å (loose coupling)
- –í–∏—Å–æ–∫–∞ –≤—ñ–¥–º–æ–≤–æ—Å—Ç—ñ–π–∫—ñ—Å—Ç—å
- –ú–æ–∂–ª–∏–≤—ñ—Å—Ç—å –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è —Å–ø–æ–∂–∏–≤–∞—á—ñ–≤

**–ù–µ–¥–æ–ª—ñ–∫–∏:**
- –°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å –Ω–∞–ª–∞–≥–æ–¥–∂–µ–Ω–Ω—è
- Eventual consistency
- –ü–æ—Ç—Ä—ñ–±–µ–Ω –¥–æ–¥–∞—Ç–∫–æ–≤–∏–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç (–±—Ä–æ–∫–µ—Ä)

### 2.2. –ü–∞—Ç–µ—Ä–Ω–∏ –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—ó

#### Request/Response (REST)
–ö–ª—ñ—î–Ω—Ç –Ω–∞–¥—Å–∏–ª–∞—î –∑–∞–ø–∏—Ç —ñ –æ—á—ñ–∫—É—î –≤—ñ–¥–ø–æ–≤—ñ–¥—å.
```
Client ‚Üí Service: HTTP Request
Service ‚Üí Client: HTTP Response
```

#### Publish/Subscribe (Events)
–í–∏–¥–∞–≤–µ—Ü—å –ø—É–±–ª—ñ–∫—É—î –ø–æ–¥—ñ—é, –ø—ñ–¥–ø–∏—Å–Ω–∏–∫–∏ —ó—ó –æ–±—Ä–æ–±–ª—è—é—Ç—å.
```
Publisher ‚Üí Broker: Event
Broker ‚Üí Subscriber 1: Event
Broker ‚Üí Subscriber 2: Event
```

#### API Composition
–û–¥–∏–Ω —Å–µ—Ä–≤—ñ—Å –∞–≥—Ä–µ–≥—É—î –¥–∞–Ω—ñ –∑ –∫—ñ–ª—å–∫–æ—Ö —ñ–Ω—à–∏—Ö —Å–µ—Ä–≤—ñ—Å—ñ–≤.
```
API Gateway ‚Üí Service A: Request
API Gateway ‚Üí Service B: Request
API Gateway ‚Üí Client: Aggregated Response
```

### 2.3. –î—ñ–∞–≥—Ä–∞–º–∞ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç—ñ (Sequence Diagram)

Sequence Diagram –ø–æ–∫–∞–∑—É—î:
- –£—á–∞—Å–Ω–∏–∫—ñ–≤ –≤–∑–∞—î–º–æ–¥—ñ—ó (actors, services)
- –ü–æ—Ä—è–¥–æ–∫ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å —É —á–∞—Å—ñ
- –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ñ/–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ñ –≤–∏–∫–ª–∏–∫–∏
- –ñ–∏—Ç—Ç—î–≤—ñ —Ü–∏–∫–ª–∏ –æ–±'—î–∫—Ç—ñ–≤
- –£–º–æ–≤–Ω—É –ª–æ–≥—ñ–∫—É (alt, opt, loop)

### 2.4. –î—ñ–∞–≥—Ä–∞–º–∞ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è (Deployment Diagram)

Deployment Diagram –ø–æ–∫–∞–∑—É—î:
- –§—ñ–∑–∏—á–Ω—ñ –≤—É–∑–ª–∏ (nodes) - —Å–µ—Ä–≤–µ—Ä–∏, –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏
- –ü—Ä–æ–≥—Ä–∞–º–Ω—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ –Ω–∞ –≤—É–∑–ª–∞—Ö
- –ú–µ—Ä–µ–∂–µ–≤—ñ –∑'—î–¥–Ω–∞–Ω–Ω—è
- –ü—Ä–æ—Ç–æ–∫–æ–ª–∏ –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—ó
- –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∏

---

## 3. –û–ë–†–ê–ù–ò–ô –°–¶–ï–ù–ê–†–Ü–ô: –°–¢–í–û–†–ï–ù–ù–Ø –ó–ê–ú–û–í–õ–ï–ù–ù–Ø

### 3.1. –û–ø–∏—Å use case

**Use Case:** –ü–æ–∫—É–ø–µ—Ü—å —Å—Ç–≤–æ—Ä—é—î –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –Ω–∞ —Ç–æ–≤–∞—Ä

**–ê–∫—Ç–æ—Ä–∏:**
- **–ü–æ–∫—É–ø–µ—Ü—å (Customer)** - —ñ–Ω—ñ—Ü—ñ—é—î —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è
- **Order Service** - –∫–æ–æ—Ä–¥–∏–Ω—É—î –ø—Ä–æ—Ü–µ—Å —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è
- **Product Service** - –Ω–∞–¥–∞—î —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ —Ç–æ–≤–∞—Ä —Ç–∞ –æ–Ω–æ–≤–ª—é—î –∑–∞–ª–∏—à–∫–∏
- **Notification Service** - –Ω–∞–¥—Å–∏–ª–∞—î —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è –ø—Ä–æ —Å—Ç–≤–æ—Ä–µ–Ω–µ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è
- **RabbitMQ** - —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç—É—î –ø–æ–¥—ñ—ó –º—ñ–∂ —Å–µ—Ä–≤—ñ—Å–∞–º–∏
- **PostgreSQL (orders_db)** - –∑–±–µ—Ä—ñ–≥–∞—î –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è
- **PostgreSQL (products_db)** - –∑–±–µ—Ä—ñ–≥–∞—î —Ç–æ–≤–∞—Ä–∏

**–ü–µ—Ä–µ–¥—É–º–æ–≤–∏:**
1. –¢–æ–≤–∞—Ä —ñ—Å–Ω—É—î –≤ –∫–∞—Ç–∞–ª–æ–∑—ñ Product Service
2. –¢–æ–≤–∞—Ä –º–∞—î –¥–æ—Å—Ç–∞—Ç–Ω—é –∫—ñ–ª—å–∫—ñ—Å—Ç—å –Ω–∞ —Å–∫–ª–∞–¥—ñ (stock >= quantity)
3. –í—Å—ñ —Å–µ—Ä–≤—ñ—Å–∏ –¥–æ—Å—Ç—É–ø–Ω—ñ —Ç–∞ –ø—Ä–∞—Ü—é—é—Ç—å

**–û—Å–Ω–æ–≤–Ω–∏–π –ø–æ—Ç—ñ–∫:**
1. –ü–æ–∫—É–ø–µ—Ü—å –Ω–∞–¥—Å–∏–ª–∞—î HTTP POST –∑–∞–ø–∏—Ç –¥–æ Order Service –∑ `product_id` —Ç–∞ `quantity`
2. Order Service –≤–∞–ª—ñ–¥—É—î –≤—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ
3. Order Service —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –≤–∏–∫–ª–∏–∫–∞—î Product Service –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ —Ç–æ–≤–∞—Ä
4. Product Service –ø–æ–≤–µ—Ä—Ç–∞—î –¥–∞–Ω—ñ —Ç–æ–≤–∞—Ä—É (–Ω–∞–∑–≤–∞, —Ü—ñ–Ω–∞, –∑–∞–ª–∏—à–æ–∫)
5. Order Service –ø–µ—Ä–µ–≤—ñ—Ä—è—î –¥–æ—Å—Ç–∞—Ç–Ω—ñ—Å—Ç—å —Ç–æ–≤–∞—Ä—É –Ω–∞ —Å–∫–ª–∞–¥—ñ
6. Order Service —Ä–æ–∑—Ä–∞—Ö–æ–≤—É—î –∑–∞–≥–∞–ª—å–Ω—É –≤–∞—Ä—Ç—ñ—Å—Ç—å –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è
7. Order Service –∑–±–µ—Ä—ñ–≥–∞—î –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –≤ –ë–î orders_db
8. Order Service –ø—É–±–ª—ñ–∫—É—î –ø–æ–¥—ñ—é `OrderCreated` —É RabbitMQ
9. Order Service –ø–æ–≤–µ—Ä—Ç–∞—î –≤—ñ–¥–ø–æ–≤—ñ–¥—å –ø–æ–∫—É–ø—Ü—é (201 Created)
10. Product Service –æ—Ç—Ä–∏–º—É—î –ø–æ–¥—ñ—é `OrderCreated` –∑ RabbitMQ
11. Product Service –∑–º–µ–Ω—à—É—î –∑–∞–ª–∏—à–æ–∫ —Ç–æ–≤–∞—Ä—É –≤ products_db
12. Notification Service –æ—Ç—Ä–∏–º—É—î –ø–æ–¥—ñ—é `OrderCreated` –∑ RabbitMQ
13. Notification Service –Ω–∞–¥—Å–∏–ª–∞—î email-—Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è –ø–æ–∫—É–ø—Ü—é

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ñ –ø–æ—Ç–æ–∫–∏:**

**A1. –¢–æ–≤–∞—Ä –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ:**
- –ö—Ä–æ–∫ 3: Product Service –ø–æ–≤–µ—Ä—Ç–∞—î 404 Not Found
- Order Service –ø–æ–≤–µ—Ä—Ç–∞—î 400 Bad Request –∑ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è–º "Product not found"
- –ó–∞–º–æ–≤–ª–µ–Ω–Ω—è –Ω–µ —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è

**A2. –ù–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ —Ç–æ–≤–∞—Ä—É –Ω–∞ —Å–∫–ª–∞–¥—ñ:**
- –ö—Ä–æ–∫ 5: stock < quantity
- Order Service –ø–æ–≤–µ—Ä—Ç–∞—î 409 Conflict –∑ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è–º "Insufficient stock"
- –ó–∞–º–æ–≤–ª–µ–Ω–Ω—è –Ω–µ —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è

**A3. Product Service –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π:**
- –ö—Ä–æ–∫ 3: Timeout –∞–±–æ Connection Error
- Order Service –ø–æ–≤—Ç–æ—Ä—é—î –∑–∞–ø–∏—Ç (retry) –¥–æ 3 —Ä–∞–∑—ñ–≤
- –Ø–∫—â–æ –≤—Å—ñ —Å–ø—Ä–æ–±–∏ –Ω–µ–≤–¥–∞–ª—ñ: –ø–æ–≤–µ—Ä—Ç–∞—î 503 Service Unavailable
- –ó–∞–º–æ–≤–ª–µ–Ω–Ω—è –Ω–µ —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è

**A4. RabbitMQ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π:**
- –ö—Ä–æ–∫ 8: –ù–µ –≤–¥–∞—î—Ç—å—Å—è –æ–ø—É–±–ª—ñ–∫—É–≤–∞—Ç–∏ –ø–æ–¥—ñ—é
- Order Service –∑–±–µ—Ä—ñ–≥–∞—î –ø–æ–¥—ñ—é –≤ –ª–æ–∫–∞–ª—å–Ω—ñ–π —Ç–∞–±–ª–∏—Ü—ñ outbox
- –§–æ–Ω–æ–≤–∏–π –ø—Ä–æ—Ü–µ—Å –ø—ñ–∑–Ω—ñ—à–µ –ø—É–±–ª—ñ–∫—É—î –∑–±–µ—Ä–µ–∂–µ–Ω—ñ –ø–æ–¥—ñ—ó
- –ü–æ–∫—É–ø–µ—Ü—å –æ—Ç—Ä–∏–º—É—î –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è

**–ü–æ—Å—Ç—É–º–æ–≤–∏ (—É—Å–ø—ñ—à–Ω–µ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è):**
1. –ó–∞–º–æ–≤–ª–µ–Ω–Ω—è –∑–±–µ—Ä–µ–∂–µ–Ω–æ –≤ orders_db –∑—ñ —Å—Ç–∞—Ç—É—Å–æ–º "pending"
2. –ó–∞–ª–∏—à–æ–∫ —Ç–æ–≤–∞—Ä—É –∑–º–µ–Ω—à–µ–Ω–æ –≤ products_db
3. –ü–æ–∫—É–ø–µ—Ü—å –æ—Ç—Ä–∏–º–∞–≤ email-—Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è
4. –ü–æ–¥—ñ—ó –∑–∞–ø–∏—Å–∞–Ω–æ –≤ –ª–æ–≥–∏ –¥–ª—è –∞—É–¥–∏—Ç—É

**–ú–µ—Ç—Ä–∏–∫–∏:**
- –°–µ—Ä–µ–¥–Ω—ñ–π —á–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è: 300-500 –º—Å
- –£—Å–ø—ñ—à–Ω—ñ—Å—Ç—å: 98%+
- –ó–∞—Ç—Ä–∏–º–∫–∞ –ø—É–±–ª—ñ–∫–∞—Ü—ñ—ó –ø–æ–¥—ñ—ó: < 100 –º—Å
- –ß–∞—Å –æ–±—Ä–æ–±–∫–∏ –ø–æ–¥—ñ—ó Product Service: < 200 –º—Å
- –ß–∞—Å –æ–±—Ä–æ–±–∫–∏ –ø–æ–¥—ñ—ó Notification Service: < 500 –º—Å

---

## 4. SEQUENCE DIAGRAM: –°–¢–í–û–†–ï–ù–ù–Ø –ó–ê–ú–û–í–õ–ï–ù–ù–Ø (–£–°–ü–Ü–®–ù–ò–ô –ü–û–¢–Ü–ö)

### 4.1. –û–ø–∏—Å –¥—ñ–∞–≥—Ä–∞–º–∏

–î—ñ–∞–≥—Ä–∞–º–∞ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç—ñ –ø–æ–∫–∞–∑—É—î –ø–æ–∫—Ä–æ–∫–æ–≤–∏–π –ø—Ä–æ—Ü–µ—Å —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –≤—ñ–¥ –ø–æ—á–∞—Ç–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Ç—É –ø–æ–∫—É–ø—Ü—è –¥–æ —Ñ—ñ–Ω–∞–ª—å–Ω–æ–≥–æ –Ω–∞–¥—Å–∏–ª–∞–Ω–Ω—è —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è.

**–£—á–∞—Å–Ω–∏–∫–∏:**
1. `Customer` - –ø–æ–∫—É–ø–µ—Ü—å (–∫–ª—ñ—î–Ω—Ç)
2. `Order Service` - —Å–µ—Ä–≤—ñ—Å –∑–∞–º–æ–≤–ª–µ–Ω—å
3. `orders_db` - –±–∞–∑–∞ –¥–∞–Ω–∏—Ö –∑–∞–º–æ–≤–ª–µ–Ω—å
4. `Product Service` - —Å–µ—Ä–≤—ñ—Å —Ç–æ–≤–∞—Ä—ñ–≤
5. `products_db` - –±–∞–∑–∞ –¥–∞–Ω–∏—Ö —Ç–æ–≤–∞—Ä—ñ–≤
6. `RabbitMQ` - –±—Ä–æ–∫–µ—Ä –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å
7. `Notification Service` - —Å–µ—Ä–≤—ñ—Å —Å–ø–æ–≤—ñ—â–µ–Ω—å

**–¢–∏–ø–∏ —Å—Ç—Ä—ñ–ª–æ–∫:**
- `‚Üí` —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∏–π –≤–∏–∫–ª–∏–∫ (—á–µ–∫–∞—î–º–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ)
- `-->` –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∏–π –≤–∏–∫–ª–∏–∫ –∞–±–æ –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É
- `->>` –ø—É–±–ª—ñ–∫–∞—Ü—ñ—è –ø–æ–¥—ñ—ó

### 4.2. PlantUML –∫–æ–¥ –¥—ñ–∞–≥—Ä–∞–º–∏

```plantuml
@startuml Sequence_Diagram_Create_Order_Success

autonumber
skinparam sequenceArrowThickness 2
skinparam roundcorner 20
skinparam maxmessagesize 200

title Sequence Diagram - –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è (—É—Å–ø—ñ—à–Ω–∏–π —Å—Ü–µ–Ω–∞—Ä—ñ–π)

actor Customer as customer
participant "Order Service" as order_service
database "orders_db\n(PostgreSQL)" as orders_db
participant "Product Service" as product_service
database "products_db\n(PostgreSQL)" as products_db
queue "RabbitMQ" as rabbitmq
participant "Notification Service" as notification_service

== –í–∞–ª—ñ–¥–∞—Ü—ñ—è —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ç–æ–≤–∞—Ä—É ==

customer -> order_service: POST /orders\n{product_id: 1, quantity: 2}
activate order_service

order_service -> order_service: –í–∞–ª—ñ–¥–∞—Ü—ñ—è –≤—Ö—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö\n(quantity > 0)

order_service -> product_service: GET /products/1\n(–°–∏–Ω—Ö—Ä–æ–Ω–Ω–∏–π HTTP –∑–∞–ø–∏—Ç)
activate product_service

product_service -> products_db: SELECT * FROM products\nWHERE id = 1
activate products_db
products_db --> product_service: {id: 1, name: "Laptop",\nprice: 25999.99, stock: 15}
deactivate products_db

product_service --> order_service: 200 OK\n{id: 1, name: "Laptop",\nprice: 25999.99, stock: 15}
deactivate product_service

order_service -> order_service: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ:\nstock (15) >= quantity (2) ‚úì

order_service -> order_service: –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –≤–∞—Ä—Ç–æ—Å—Ç—ñ:\ntotal = 25999.99 * 2 = 51999.98

== –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è ==

order_service -> orders_db: INSERT INTO orders\n(product_id, quantity,\ntotal_price, status)
activate orders_db
orders_db --> order_service: Order created\n{id: 101}
deactivate orders_db

== –ü—É–±–ª—ñ–∫–∞—Ü—ñ—è –ø–æ–¥—ñ—ó ==

order_service -> rabbitmq: Publish OrderCreated\n{order_id: 101,\nproduct_id: 1,\nquantity: 2}
activate rabbitmq
note right of rabbitmq
  Exchange: orders_exchange
  Routing Key: order.created
  Delivery Mode: Persistent
end note
rabbitmq --> order_service: ACK (–ø–æ–¥—ñ—è –ø—Ä–∏–π–Ω—è—Ç–∞)
deactivate rabbitmq

order_service --> customer: 201 Created\n{id: 101, product_id: 1,\nquantity: 2,\ntotal_price: 51999.98,\nstatus: "pending"}
deactivate order_service

== –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞ –æ–±—Ä–æ–±–∫–∞ –ø–æ–¥—ñ—ó (Product Service) ==

rabbitmq ->> product_service: Deliver OrderCreated\n{order_id: 101,\nproduct_id: 1, quantity: 2}
activate product_service

product_service -> products_db: UPDATE products\nSET stock = stock - 2\nWHERE id = 1
activate products_db
products_db --> product_service: Updated (stock: 15 ‚Üí 13)
deactivate products_db

product_service -> rabbitmq: ACK (–ø–æ–¥—ñ—è –æ–±—Ä–æ–±–ª–µ–Ω–∞)
deactivate product_service

== –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞ –æ–±—Ä–æ–±–∫–∞ –ø–æ–¥—ñ—ó (Notification Service) ==

rabbitmq ->> notification_service: Deliver OrderCreated\n{order_id: 101,\nproduct_id: 1,\ncustomer_email: "user@example.com"}
activate notification_service

notification_service -> notification_service: –§–æ—Ä–º—É–≤–∞–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è:\n"Order #101 created\nTotal: 51999.98 UAH"

notification_service -> notification_service: –ù–∞–¥—Å–∏–ª–∞–Ω–Ω—è email\n(simulate)
note right of notification_service
  –£ –Ω–∞–≤—á–∞–ª—å–Ω–æ–º—É –ø—Ä–æ–µ–∫—Ç—ñ:
  print("Email sent to user@example.com")
  
  –£ –ø—Ä–æ–¥–∞–∫—à–Ω—ñ:
  SendGrid / AWS SES
end note

notification_service -> rabbitmq: ACK (–ø–æ–¥—ñ—è –æ–±—Ä–æ–±–ª–µ–Ω–∞)
deactivate notification_service

@enduml
```

### 4.3. –ê–Ω–∞–ª—ñ–∑ –¥—ñ–∞–≥—Ä–∞–º–∏

**–°–∏–Ω—Ö—Ä–æ–Ω–Ω—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó (–±–ª–æ–∫—É—é—á—ñ):**
1. **Customer ‚Üí Order Service** (–∫—Ä–æ–∫–∏ 1-13)
   - –ü–æ–∫—É–ø–µ—Ü—å —á–µ–∫–∞—î –Ω–∞ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è
   - –ß–∞—Å –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ: ~300-500 –º—Å

2. **Order Service ‚Üí Product Service** (–∫—Ä–æ–∫–∏ 4-7)
   - Order Service –±–ª–æ–∫—É—î—Ç—å—Å—è –¥–æ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ
   - –ß–∞—Å –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ: ~50-100 –º—Å
   - –ö—Ä–∏—Ç–∏—á–Ω–∞ –∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å (—è–∫—â–æ Product Service –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π, –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –Ω–µ —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è)

**–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó (–Ω–µ–±–ª–æ–∫—É—é—á—ñ):**
1. **Order Service ‚Üí RabbitMQ** (–∫—Ä–æ–∫ 10)
   - Order Service –Ω–µ —á–µ–∫–∞—î –Ω–∞ –æ–±—Ä–æ–±–∫—É –ø–æ–¥—ñ—ó
   - –ü—Ä–æ—Å—Ç–æ –ø—É–±–ª—ñ–∫—É—î —Ç–∞ –æ—Ç—Ä–∏–º—É—î ACK –≤—ñ–¥ –±—Ä–æ–∫–µ—Ä–∞
   - –ß–∞—Å: ~10-20 –º—Å

2. **RabbitMQ ‚Üí Product Service** (–∫—Ä–æ–∫–∏ 14-18)
   - –û–±—Ä–æ–±–ª—è—î—Ç—å—Å—è –≤ —Ñ–æ–Ω–æ–≤–æ–º—É —Ä–µ–∂–∏–º—ñ
   - –ù–µ –≤–ø–ª–∏–≤–∞—î –Ω–∞ —á–∞—Å –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –∫–ª—ñ—î–Ω—Ç—É
   - Eventual consistency: –∑–∞–ª–∏—à–æ–∫ –æ–Ω–æ–≤–∏—Ç—å—Å—è —á–µ—Ä–µ–∑ 100-200 –º—Å

3. **RabbitMQ ‚Üí Notification Service** (–∫—Ä–æ–∫–∏ 19-24)
   - –ü–æ–≤–Ω—ñ—Å—Ç—é –Ω–µ–∑–∞–ª–µ–∂–Ω–∞ –æ–±—Ä–æ–±–∫–∞
   - –ù–∞–≤—ñ—Ç—å —è–∫—â–æ email –Ω–µ –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç—å—Å—è, –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –≤–∂–µ —Å—Ç–≤–æ—Ä–µ–Ω–æ

**–ö—Ä–∏—Ç–∏—á–Ω—ñ –º–æ–º–µ–Ω—Ç–∏:**

üî¥ **Single Point of Failure:**
- Product Service –Ω–∞ –∫—Ä–æ—Ü—ñ 4 - —è–∫—â–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π, –≤–µ—Å—å –ø—Ä–æ—Ü–µ—Å –∑—É–ø–∏–Ω—è—î—Ç—å—Å—è
- **–†—ñ—à–µ–Ω–Ω—è:** –î–æ–¥–∞—Ç–∏ retry logic —Ç–∞ circuit breaker

üü° **Eventual Consistency:**
- –ú—ñ–∂ –∫—Ä–æ–∫–∞–º–∏ 13 —Ç–∞ 18 —ñ—Å–Ω—É—î —á–∞—Å–æ–≤–∏–π –ø—Ä–æ–º—ñ–∂–æ–∫, –∫–æ–ª–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è —Å—Ç–≤–æ—Ä–µ–Ω–æ, –∞–ª–µ –∑–∞–ª–∏—à–æ–∫ —â–µ –Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–∏–π
- **–†—ñ—à–µ–Ω–Ω—è:** –ü—Ä–∏–π–Ω—è—Ç–Ω–æ –¥–ª—è –¥–∞–Ω–æ—ó –±—ñ–∑–Ω–µ—Å-–ª–æ–≥—ñ–∫–∏

üü¢ **–í—ñ–¥–º–æ–≤–æ—Å—Ç—ñ–π–∫—ñ—Å—Ç—å:**
- –Ø–∫—â–æ Notification Service –ø–∞–¥–∞—î, –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –≤—Å–µ –æ–¥–Ω–æ —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è
- –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∑–∞–ª–∏—à–∞—î—Ç—å—Å—è –≤ —á–µ—Ä–∑—ñ RabbitMQ –¥–æ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è —Å–µ—Ä–≤—ñ—Å—É

---

## 5. SEQUENCE DIAGRAM: –ê–õ–¨–¢–ï–†–ù–ê–¢–ò–í–ù–Ü –ü–û–¢–û–ö–ò

### 5.1. –ù–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ —Ç–æ–≤–∞—Ä—É –Ω–∞ —Å–∫–ª–∞–¥—ñ

```plantuml
@startuml Sequence_Diagram_Insufficient_Stock

autonumber
skinparam sequenceArrowThickness 2
skinparam roundcorner 20

title Sequence Diagram - –ù–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ —Ç–æ–≤–∞—Ä—É –Ω–∞ —Å–∫–ª–∞–¥—ñ

actor Customer as customer
participant "Order Service" as order_service
participant "Product Service" as product_service
database "products_db" as products_db

customer -> order_service: POST /orders\n{product_id: 1, quantity: 20}
activate order_service

order_service -> product_service: GET /products/1
activate product_service

product_service -> products_db: SELECT * FROM products\nWHERE id = 1
activate products_db
products_db --> product_service: {id: 1, stock: 5}
deactivate products_db

product_service --> order_service: 200 OK\n{stock: 5}
deactivate product_service

order_service -> order_service: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞:\nstock (5) < quantity (20) ‚úó

order_service --> customer: 409 Conflict\n{"error": "Insufficient stock",\n"available": 5,\n"requested": 20}
deactivate order_service

note right of customer
  –ó–∞–º–æ–≤–ª–µ–Ω–Ω—è –ù–ï —Å—Ç–≤–æ—Ä–µ–Ω–æ
  –ü–æ–¥—ñ—ó –ù–ï –æ–ø—É–±–ª—ñ–∫–æ–≤–∞–Ω–æ
  –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö –ù–ï –∑–º—ñ–Ω–µ–Ω–∞
end note

@enduml
```

### 5.2. Product Service –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π (–∑ retry)

```plantuml
@startuml Sequence_Diagram_Service_Unavailable

autonumber
skinparam sequenceArrowThickness 2
skinparam roundcorner 20

title Sequence Diagram - Product Service –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π (–∑ retry –º–µ—Ö–∞–Ω—ñ–∑–º–æ–º)

actor Customer as customer
participant "Order Service" as order_service
participant "Product Service" as product_service

customer -> order_service: POST /orders\n{product_id: 1, quantity: 2}
activate order_service

order_service -> product_service: GET /products/1\n(–°–ø—Ä–æ–±–∞ #1)
activate product_service
product_service --> order_service: ‚ùå Timeout / Connection Error
deactivate product_service

note right of order_service
  Retry after 1 second
end note

order_service -> order_service: Wait 1 sec

order_service -> product_service: GET /products/1\n(–°–ø—Ä–æ–±–∞ #2)
activate product_service
product_service --> order_service: ‚ùå Timeout / Connection Error
deactivate product_service

note right of order_service
  Retry after 2 seconds
end note

order_service -> order_service: Wait 2 sec

order_service -> product_service: GET /products/1\n(–°–ø—Ä–æ–±–∞ #3)
activate product_service
product_service --> order_service: ‚ùå Timeout / Connection Error
deactivate product_service

note right of order_service
  Max retries reached
  Circuit breaker OPEN
end note

order_service --> customer: 503 Service Unavailable\n{"error": "Product Service unavailable",\n"message": "Please try again later"}
deactivate order_service

note right of customer
  –ó–∞–º–æ–≤–ª–µ–Ω–Ω—è –ù–ï —Å—Ç–≤–æ—Ä–µ–Ω–æ
  –ö–ª—ñ—î–Ω—Ç –º–æ–∂–µ –ø–æ–≤—Ç–æ—Ä–∏—Ç–∏ –ø—ñ–∑–Ω—ñ—à–µ
  –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –∑–±–µ—Ä–µ–≥—Ç–∏ —É outbox
  –¥–ª—è –≤—ñ–¥–∫–ª–∞–¥–µ–Ω–æ—ó –æ–±—Ä–æ–±–∫–∏
end note

@enduml
```

---

## 6. DEPLOYMENT DIAGRAM

### 6.1. –û–ø–∏—Å —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∏

–°–∏—Å—Ç–µ–º–∞ —Ä–æ–∑–≥–æ—Ä—Ç–∞—î—Ç—å—Å—è —É Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö, –∫–µ—Ä–æ–≤–∞–Ω–∏—Ö Docker Compose. –£—Å—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ –ø—Ä–∞—Ü—é—é—Ç—å —É –æ–∫—Ä–µ–º–∏—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö —Ç–∞ –≤–∑–∞—î–º–æ–¥—ñ—é—Ç—å —á–µ—Ä–µ–∑ Docker networks.

**–ú–µ—Ä–µ–∂–µ–≤—ñ —Å–µ–≥–º–µ–Ω—Ç–∏:**
1. **frontend-network** - –¥–ª—è –∫–ª—ñ—î–Ω—Ç—Å—å–∫–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤ (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è –º–∞–π–±—É—Ç–Ω—å–æ–≥–æ –≤–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É)
2. **backend-network** - –¥–ª—è –º—ñ–∂—Å–µ—Ä–≤—ñ—Å–Ω–æ—ó –≤–∑–∞—î–º–æ–¥—ñ—ó
3. **database-network** - –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ –±–∞–∑ –¥–∞–Ω–∏—Ö

**–ü–æ—Ä—Ç–∏:**
- Product Service: 8001
- Order Service: 8002
- Notification Service: 8003
- PostgreSQL (products): 5432
- PostgreSQL (orders): 5433
- RabbitMQ: 5672 (AMQP), 15672 (Management UI)
- Prometheus: 9090
- Grafana: 3000

### 6.2. PlantUML –∫–æ–¥ Deployment Diagram

```plantuml
@startuml Deployment_Diagram

!define CONTAINER node

skinparam node {
    BackgroundColor LightBlue
    BorderColor Black
}

skinparam component {
    BackgroundColor LightYellow
    BorderColor Black
}

skinparam database {
    BackgroundColor LightGreen
    BorderColor Black
}

title Deployment Diagram - Docker Compose Infrastructure

cloud "Internet" {
    actor "Customer" as customer
    actor "Administrator" as admin
}

CONTAINER "Docker Host" {
    
    package "backend-network" {
        
        CONTAINER "product-service\n(Docker Container)" as ps_container {
            component "Product Service\nFastAPI:8000" as ps
            note right of ps
              Image: product-service:latest
              Port: 8001:8000
              Env: DATABASE_URL, RABBITMQ_URL
              Replicas: 1 (–º–æ–∂–Ω–∞ –º–∞—Å—à—Ç–∞–±—É–≤–∞—Ç–∏)
            end note
        }
        
        CONTAINER "order-service\n(Docker Container)" as os_container {
            component "Order Service\nFastAPI:8000" as os
            note right of os
              Image: order-service:latest
              Port: 8002:8000
              Env: DATABASE_URL, RABBITMQ_URL,
                   PRODUCT_SERVICE_URL
              Replicas: 1 (–º–æ–∂–Ω–∞ –º–∞—Å—à—Ç–∞–±—É–≤–∞—Ç–∏)
            end note
        }
        
        CONTAINER "notification-service\n(Docker Container)" as ns_container {
            component "Notification Service\nFastAPI:8000" as ns
            note right of ns
              Image: notification-service:latest
              Port: 8003:8000
              Env: RABBITMQ_URL
              Replicas: 1-3 (–ª–µ–≥–∫–æ –º–∞—Å—à—Ç–∞–±—É—î—Ç—å—Å—è)
            end note
        }
        
        CONTAINER "rabbitmq\n(Docker Container)" as rabbitmq_container {
            component "RabbitMQ 3\nPort: 5672" as rabbitmq
            component "Management UI\nPort: 15672" as rabbitmq_ui
            note right of rabbitmq
              Image: rabbitmq:3-management
              Ports: 5672:5672, 15672:15672
              Volume: rabbitmq-data
              Persistent: true
            end note
        }
    }
    
    package "database-network" {
        
        CONTAINER "postgres-products\n(Docker Container)" as pg_products_container {
            database "PostgreSQL 15\nproducts_db\nPort: 5432" as pg_products
            note right of pg_products
              Image: postgres:15
              Port: 5432:5432
              Volume: products-data
              User: user / password
            end note
        }
        
        CONTAINER "postgres-orders\n(Docker Container)" as pg_orders_container {
            database "PostgreSQL 15\norders_db\nPort: 5432" as pg_orders
            note right of pg_orders
              Image: postgres:15
              Port: 5433:5432
              Volume: orders-data
              User: user / password
            end note
        }
    }
    
    package "monitoring-network" {
        
        CONTAINER "prometheus\n(Docker Container)" as prom_container {
            component "Prometheus\nPort: 9090" as prometheus
            note right of prometheus
              Image: prom/prometheus
              Port: 9090:9090
              Config: prometheus.yml
              Scrapes: /metrics endpoints
            end note
        }
        
        CONTAINER "grafana\n(Docker Container)" as grafana_container {
            component "Grafana\nPort: 3000" as grafana
            note right of grafana
              Image: grafana/grafana
              Port: 3000:3000
              Data Source: Prometheus
              Dashboards: preloaded
            end note
        }
    }
}

' External connections
customer -down-> os : HTTPS/JSON\nPOST /orders
admin -down-> ps : HTTPS/JSON\nCRUD /products

' Service to service (backend-network)
os -right-> ps : HTTP/JSON\nGET /products/{id}
os -down-> rabbitmq : AMQP\nPublish Events
rabbitmq -up-> ps : AMQP\nDeliver Events
rabbitmq -up-> ns : AMQP\nDeliver Events

' Service to database (database-network)
ps -down-> pg_products : SQL/TCP\nPort: 5432
os -down-> pg_orders : SQL/TCP\nPort: 5432

' Monitoring (monitoring-network)
ps -down-> prometheus : HTTP\n/metrics
os -down-> prometheus : HTTP\n/metrics
ns -down-> prometheus : HTTP\n/metrics
grafana -left-> prometheus : PromQL\nQuery Metrics

' Management UI
admin -down-> rabbitmq_ui : HTTP\nPort: 15672
admin -down-> grafana : HTTP\nPort: 3000

legend right
  **Docker Compose Configuration:**
  ‚Ä¢ Total Containers: 8
  ‚Ä¢ Networks: 3 (backend, database, monitoring)
  ‚Ä¢ Volumes: 4 (2x PostgreSQL, 1x RabbitMQ, 1x Grafana)
  ‚Ä¢ External Ports: 6
  
  **Deployment Commands:**
  docker-compose up -d
  docker-compose ps
  docker-compose logs -f
  docker-compose down
endlegend

@enduml
```

### 6.3. Docker Compose –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è (—Å–ø—Ä–æ—â–µ–Ω–∞)

```yaml
version: '3.8'

services:
  postgres-products:
    image: postgres:15
    container_name: postgres-products
    environment:
      POSTGRES_DB: products_db
      POSTGRES_USER: user
      POSTGRES_PASSWORD: password
    ports:
      - "5432:5432"
    volumes:
      - products-data:/var/lib/postgresql/data
    networks:
      - database-network
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U user"]
      interval: 10s
      timeout: 5s
      retries: 5

  postgres-orders:
    image: postgres:15
    container_name: postgres-orders
    environment:
      POSTGRES_DB: orders_db
      POSTGRES_USER: user
      POSTGRES_PASSWORD: password
    ports:
      - "5433:5432"
    volumes:
      - orders-data:/var/lib/postgresql/data
    networks:
      - database-network
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U user"]
      interval: 10s
      timeout: 5s
      retries: 5

  rabbitmq:
    image: rabbitmq:3-management
    container_name: rabbitmq
    ports:
      - "5672:5672"
      - "15672:15672"
    environment:
      RABBITMQ_DEFAULT_USER: guest
      RABBITMQ_DEFAULT_PASS: guest
    volumes:
      - rabbitmq-data:/var/lib/rabbitmq
    networks:
      - backend-network
    healthcheck:
      test: ["CMD", "rabbitmq-diagnostics", "ping"]
      interval: 30s
      timeout: 10s
      retries: 5

  product-service:
    build: ./product-service
    container_name: product-service
    ports:
      - "8001:8000"
    environment:
      DATABASE_URL: postgresql://user:password@postgres-products:5432/products_db
      RABBITMQ_URL: amqp://guest:guest@rabbitmq:5672/
      SERVICE_NAME: product-service
      LOG_LEVEL: INFO
    depends_on:
      postgres-products:
        condition: service_healthy
      rabbitmq:
        condition: service_healthy
    networks:
      - backend-network
      - database-network
    restart: unless-stopped

  order-service:
    build: ./order-service
    container_name: order-service
    ports:
      - "8002:8000"
    environment:
      DATABASE_URL: postgresql://user:password@postgres-orders:5432/orders_db
      RABBITMQ_URL: amqp://guest:guest@rabbitmq:5672/
      PRODUCT_SERVICE_URL: http://product-service:8000
      SERVICE_NAME: order-service
      LOG_LEVEL: INFO
    depends_on:
      postgres-orders:
        condition: service_healthy
      rabbitmq:
        condition: service_healthy
      product-service:
        condition: service_started
    networks:
      - backend-network
      - database-network
    restart: unless-stopped

  notification-service:
    build: ./notification-service
    container_name: notification-service
    ports:
      - "8003:8000"
    environment:
      RABBITMQ_URL: amqp://guest:guest@rabbitmq:5672/
      SERVICE_NAME: notification-service
      LOG_LEVEL: INFO
      EMAIL_SERVICE: console
    depends_on:
      rabbitmq:
        condition: service_healthy
    networks:
      - backend-network
    restart: unless-stopped

  prometheus:
    image: prom/prometheus:latest
    container_name: prometheus
    ports:
      - "9090:9090"
    volumes:
      - ./prometheus.yml:/etc/prometheus/prometheus.yml
      - prometheus-data:/prometheus
    command:
      - '--config.file=/etc/prometheus/prometheus.yml'
      - '--storage.tsdb.path=/prometheus'
    networks:
      - backend-network
    restart: unless-stopped

  grafana:
    image: grafana/grafana:latest
    container_name: grafana
    ports:
      - "3000:3000"
    environment:
      - GF_SECURITY_ADMIN_PASSWORD=admin
      - GF_USERS_ALLOW_SIGN_UP=false
    volumes:
      - grafana-data:/var/lib/grafana
    depends_on:
      - prometheus
    networks:
      - backend-network
    restart: unless-stopped

networks:
  backend-network:
    driver: bridge
  database-network:
    driver: bridge

volumes:
  products-data:
  orders-data:
  rabbitmq-data:
  prometheus-data:
  grafana-data:
```

---

## 7. –¢–ò–ü–ò –í–ó–ê–Ñ–ú–û–î–Ü–á –í –°–ò–°–¢–ï–ú–Ü

### 7.1. –°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞ –≤–∑–∞—î–º–æ–¥—ñ—è (REST API)

#### Order Service ‚Üí Product Service

**Use Case:** –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ç–æ–≤–∞—Ä—É –ø–µ—Ä–µ–¥ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è–º –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è

**–ü—Ä–æ—Ç–æ–∫–æ–ª:** HTTP/JSON

**Endpoint:** `GET http://product-service:8000/products/{id}`

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**
- **–¢–∏–ø:** Request/Response
- **Timeout:** 5 —Å–µ–∫—É–Ω–¥
- **Retry strategy:** 3 —Å–ø—Ä–æ–±–∏ –∑ –µ–∫—Å–ø–æ–Ω–µ–Ω—Ü—ñ–∞–ª—å–Ω–æ—é –∑–∞—Ç—Ä–∏–º–∫–æ—é (1s, 2s, 4s)
- **Circuit breaker:** –í—ñ–¥–∫—Ä–∏–≤–∞—î—Ç—å—Å—è –ø—ñ—Å–ª—è 5 –Ω–µ–≤–¥–∞–ª–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤, –≤—ñ–¥–Ω–æ–≤–ª—é—î—Ç—å—Å—è —á–µ—Ä–µ–∑ 60 —Å–µ–∫—É–Ω–¥

**–ü—Ä–∏–∫–ª–∞–¥ –∑–∞–ø–∏—Ç—É:**
```http
GET http://product-service:8000/products/1 HTTP/1.1
Host: product-service:8000
Accept: application/json
X-Request-ID: uuid-v4
X-Correlation-ID: trace-id
```

**–ü—Ä–∏–∫–ª–∞–¥ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ (—É—Å–ø—ñ—Ö):**
```http
HTTP/1.1 200 OK
Content-Type: application/json

{
  "id": 1,
  "name": "–ù–æ—É—Ç–±—É–∫ Lenovo ThinkPad",
  "description": "–ü—Ä–æ—Ñ–µ—Å—ñ–π–Ω–∏–π –Ω–æ—É—Ç–±—É–∫",
  "price": 25999.99,
  "stock": 15,
  "category": "–ï–ª–µ–∫—Ç—Ä–æ–Ω—ñ–∫–∞"
}
```

**–ü—Ä–∏–∫–ª–∞–¥ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ (–ø–æ–º–∏–ª–∫–∞):**
```http
HTTP/1.1 404 Not Found
Content-Type: application/json

{
  "error": "NotFound",
  "message": "Product with id=1 not found",
  "timestamp": "2025-11-15T10:35:00Z"
}
```

**–ü–µ—Ä–µ–≤–∞–≥–∏ –¥–ª—è —Ü—å–æ–≥–æ use case:**
- ‚úÖ –ù–µ–≥–∞–π–Ω–µ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –∞–∫—Ç—É–∞–ª—å–Ω–∏—Ö –¥–∞–Ω–∏—Ö –ø—Ä–æ —Ç–æ–≤–∞—Ä
- ‚úÖ –ú–æ–∂–ª–∏–≤—ñ—Å—Ç—å –≤–∞–ª—ñ–¥—É–≤–∞—Ç–∏ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –ø–µ—Ä–µ–¥ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è–º –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è
- ‚úÖ –ü—Ä–æ—Å—Ç–æ—Ç–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó —Ç–∞ –¥–µ–±–∞–≥—É

**–ù–µ–¥–æ–ª—ñ–∫–∏:**
- ‚ùå –ñ–æ—Ä—Å—Ç–∫–∞ –∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å (—è–∫—â–æ Product Service –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π, –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –Ω–µ —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è)
- ‚ùå –î–æ–¥–∞—Ç–∫–æ–≤–∞ –∑–∞—Ç—Ä–∏–º–∫–∞ —É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –∫–ª—ñ—î–Ω—Ç—É (~50-100 –º—Å)

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∏:**
1. **–ö–µ—à—É–≤–∞–Ω–Ω—è:** –ó–±–µ—Ä—ñ–≥–∞—Ç–∏ –∫–æ–ø—ñ—é –¥–∞–Ω–∏—Ö –ø—Ä–æ —Ç–æ–≤–∞—Ä–∏ –≤ Order Service (eventual consistency)
2. **Read Replica:** –ß–∏—Ç–∞—Ç–∏ –∑ —Ä–µ–ø–ª—ñ–∫ Product Service –¥–ª—è —Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω–Ω—è –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
3. **API Gateway:** –¶–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–∞ —Ç–æ—á–∫–∞ –¥–ª—è –∞–≥—Ä–µ–≥–∞—Ü—ñ—ó –¥–∞–Ω–∏—Ö

---

### 7.2. –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞ –≤–∑–∞—î–º–æ–¥—ñ—è (RabbitMQ)

#### Order Service ‚Üí Product Service + Notification Service

**Use Case:** –°–ø–æ–≤—ñ—â–µ–Ω–Ω—è –ø—Ä–æ —Å—Ç–≤–æ—Ä–µ–Ω–µ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è —Ç–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–ª–∏—à–∫—ñ–≤

**–ü—Ä–æ—Ç–æ–∫–æ–ª:** AMQP (Advanced Message Queuing Protocol)

**–ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞:**
```
Order Service (Publisher)
    ‚Üì
    Publish to Exchange: "orders_exchange" (type: topic)
    ‚Üì
RabbitMQ Broker
    ‚îú‚îÄ Queue: "order.created" ‚Üí Product Service (Consumer)
    ‚îî‚îÄ Queue: "order.created" ‚Üí Notification Service (Consumer)
```

**–ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è RabbitMQ:**

**Exchange:**
- Name: `orders_exchange`
- Type: `topic`
- Durable: `true`
- Auto-delete: `false`

**Queue #1 (Product Service):**
- Name: `order.created.product`
- Routing Key: `order.created`
- Durable: `true`
- Exclusive: `false`
- Auto-ack: `false` (manual acknowledgement)
- Prefetch count: 10

**Queue #2 (Notification Service):**
- Name: `order.created.notification`
- Routing Key: `order.created`
- Durable: `true`
- Exclusive: `false`
- Auto-ack: `false`
- Prefetch count: 5

**–§–æ—Ä–º–∞—Ç –ø–æ–¥—ñ—ó OrderCreated:**
```json
{
  "event_type": "OrderCreated",
  "event_id": "550e8400-e29b-41d4-a716-446655440000",
  "event_version": "1.0",
  "timestamp": "2025-11-15T10:35:00.123Z",
  "source": "order-service",
  "correlation_id": "trace-12345",
  "data": {
    "order_id": 101,
    "product_id": 1,
    "product_name": "–ù–æ—É—Ç–±—É–∫ Lenovo ThinkPad",
    "quantity": 2,
    "unit_price": 25999.99,
    "total_price": 51999.98,
    "customer_email": "customer@example.com",
    "status": "pending"
  },
  "metadata": {
    "retry_count": 0,
    "priority": "normal"
  }
}
```

**–ü—É–±–ª—ñ–∫–∞—Ü—ñ—è –ø–æ–¥—ñ—ó (Order Service):**
```python
import pika
import json
from datetime import datetime
import uuid

def publish_order_created(order_data):
    connection = pika.BlockingConnection(
        pika.URLParameters(RABBITMQ_URL)
    )
    channel = connection.channel()
    
    # Declare exchange
    channel.exchange_declare(
        exchange='orders_exchange',
        exchange_type='topic',
        durable=True
    )
    
    # Create event
    event = {
        "event_type": "OrderCreated",
        "event_id": str(uuid.uuid4()),
        "event_version": "1.0",
        "timestamp": datetime.utcnow().isoformat(),
        "source": "order-service",
        "data": order_data
    }
    
    # Publish
    channel.basic_publish(
        exchange='orders_exchange',
        routing_key='order.created',
        body=json.dumps(event),
        properties=pika.BasicProperties(
            delivery_mode=2,  # persistent
            content_type='application/json',
            correlation_id=str(uuid.uuid4())
        )
    )
    
    connection.close()
```

**–°–ø–æ–∂–∏–≤–∞–Ω–Ω—è –ø–æ–¥—ñ—ó (Product Service):**
```python
import pika
import json

def callback(ch, method, properties, body):
    try:
        event = json.loads(body)
        order_data = event['data']
        
        # Update stock
        product_id = order_data['product_id']
        quantity = order_data['quantity']
        
        update_stock(product_id, -quantity)
        
        # Acknowledge message
        ch.basic_ack(delivery_tag=method.delivery_tag)
        
        print(f"‚úì Stock updated for product {product_id}")
        
    except Exception as e:
        print(f"‚úó Error processing event: {e}")
        # Reject and requeue (or send to DLQ)
        ch.basic_nack(delivery_tag=method.delivery_tag, requeue=False)

def start_consumer():
    connection = pika.BlockingConnection(
        pika.URLParameters(RABBITMQ_URL)
    )
    channel = connection.channel()
    
    # Declare queue
    channel.queue_declare(
        queue='order.created.product',
        durable=True
    )
    
    # Bind queue to exchange
    channel.queue_bind(
        exchange='orders_exchange',
        queue='order.created.product',
        routing_key='order.created'
    )
    
    # Set prefetch count
    channel.basic_qos(prefetch_count=10)
    
    # Start consuming
    channel.basic_consume(
        queue='order.created.product',
        on_message_callback=callback,
        auto_ack=False
    )
    
    print("Waiting for messages...")
    channel.start_consuming()
```

**–ü–µ—Ä–µ–≤–∞–≥–∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—ó –≤–∑–∞—î–º–æ–¥—ñ—ó:**
- ‚úÖ –°–ª–∞–±–∫–∞ –∑–≤'—è–∑–∞–Ω—ñ—Å—Ç—å (loose coupling)
- ‚úÖ –í—ñ–¥–º–æ–≤–æ—Å—Ç—ñ–π–∫—ñ—Å—Ç—å (–ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –Ω–µ –≤—Ç—Ä–∞—á–∞—é—Ç—å—Å—è)
- ‚úÖ –ú–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω—ñ—Å—Ç—å (–º–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∏ –±–∞–≥–∞—Ç–æ —Å–ø–æ–∂–∏–≤–∞—á—ñ–≤)
- ‚úÖ –ù–µ–∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å –æ–±—Ä–æ–±–∫–∏ (–Ω–µ –±–ª–æ–∫—É—î –æ—Å–Ω–æ–≤–Ω–∏–π –ø–æ—Ç—ñ–∫)

**–ù–µ–¥–æ–ª—ñ–∫–∏:**
- ‚ùå Eventual consistency (–∑–∞—Ç—Ä–∏–º–∫–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö)
- ‚ùå –°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å –Ω–∞–ª–∞–≥–æ–¥–∂–µ–Ω–Ω—è
- ‚ùå –ü–æ—Ç—Ä—ñ–±–µ–Ω –¥–æ–¥–∞—Ç–∫–æ–≤–∏–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç (RabbitMQ)

---

### 7.3. –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è —Ç–∏–ø—ñ–≤ –≤–∑–∞—î–º–æ–¥—ñ—ó

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ | –°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞ (REST) | –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞ (RabbitMQ) |
|----------------|------------------|------------------------|
| **–¢–∏–ø –∑–≤'—è–∑–∫—É** | Tight coupling | Loose coupling |
| **–ó–∞—Ç—Ä–∏–º–∫–∞** | 50-100 –º—Å | 100-500 –º—Å |
| **–í—ñ–¥–º–æ–≤–æ—Å—Ç—ñ–π–∫—ñ—Å—Ç—å** | –ù–∏–∑—å–∫–∞ (–∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—ñ) | –í–∏—Å–æ–∫–∞ (—á–µ—Ä–≥–∞ –∑–±–µ—Ä—ñ–≥–∞—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è) |
| **–ú–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è** | –°–∫–ª–∞–¥–Ω—ñ—à–µ | –õ–µ–≥—à–µ (–¥–æ–¥–∞—Ç–∏ —Å–ø–æ–∂–∏–≤–∞—á—ñ–≤) |
| **–£–∑–≥–æ–¥–∂–µ–Ω—ñ—Å—Ç—å –¥–∞–Ω–∏—Ö** | Strong consistency | Eventual consistency |
| **–°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å** | –ü—Ä–æ—Å—Ç–∞ | –°–µ—Ä–µ–¥–Ω—è |
| **Use Cases** | –ö—Ä–∏—Ç–∏—á–Ω—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó, —â–æ –ø–æ—Ç—Ä–µ–±—É—é—Ç—å –Ω–µ–≥–∞–π–Ω–æ—ó –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ | –§–æ–Ω–æ–≤—ñ –∑–∞–¥–∞—á—ñ, —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è, –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö |
| **–ü—Ä–∏–∫–ª–∞–¥–∏ —É —Å–∏—Å—Ç–µ–º—ñ** | Order ‚Üí Product (–ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ç–æ–≤–∞—Ä—É) | Order ‚Üí Product (–æ–Ω–æ–≤–ª–µ–Ω–Ω—è stock), Order ‚Üí Notification (email) |

---

## 8. –û–ë–†–û–ë–ö–ê –ü–û–ú–ò–õ–û–ö –¢–ê RETRY –õ–û–ì–Ü–ö–ê

### 8.1. –°—Ç—Ä–∞—Ç–µ–≥—ñ—è –æ–±—Ä–æ–±–∫–∏ –ø–æ–º–∏–ª–æ–∫ —É —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ñ–π –≤–∑–∞—î–º–æ–¥—ñ—ó

#### Exponential Backoff Retry

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
```python
import time
import httpx

async def call_product_service_with_retry(product_id: int, max_retries: int = 3):
    base_delay = 1  # —Å–µ–∫—É–Ω–¥–∞
    
    for attempt in range(max_retries):
        try:
            async with httpx.AsyncClient(timeout=5.0) as client:
                response = await client.get(
                    f"{PRODUCT_SERVICE_URL}/products/{product_id}"
                )
                
                if response.status_code == 200:
                    return response.json()
                elif response.status_code == 404:
                    raise ProductNotFoundError(f"Product {product_id} not found")
                else:
                    raise ProductServiceError(f"Unexpected status: {response.status_code}")
                    
        except httpx.TimeoutException:
            if attempt < max_retries - 1:
                delay = base_delay * (2 ** attempt)  # 1s, 2s, 4s
                print(f"Timeout. Retry {attempt + 1}/{max_retries} after {delay}s")
                await asyncio.sleep(delay)
            else:
                raise ProductServiceUnavailableError("Product Service unavailable after 3 retries")
        
        except httpx.ConnectError:
            if attempt < max_retries - 1:
                delay = base_delay * (2 ** attempt)
                print(f"Connection error. Retry {attempt + 1}/{max_retries} after {delay}s")
                await asyncio.sleep(delay)
            else:
                raise ProductServiceUnavailableError("Cannot connect to Product Service")
```

**–î—ñ–∞–≥—Ä–∞–º–∞ Exponential Backoff:**
```
–°–ø—Ä–æ–±–∞ 1: 0 —Å–µ–∫—É–Ω–¥       ‚Üí –ü–æ–º–∏–ª–∫–∞
           ‚Üì Wait 1s
–°–ø—Ä–æ–±–∞ 2: 1 —Å–µ–∫—É–Ω–¥–∞      ‚Üí –ü–æ–º–∏–ª–∫–∞
           ‚Üì Wait 2s
–°–ø—Ä–æ–±–∞ 3: 3 —Å–µ–∫—É–Ω–¥–∏      ‚Üí –ü–æ–º–∏–ª–∫–∞
           ‚Üì Wait 4s
–°–ø—Ä–æ–±–∞ 4: 7 —Å–µ–∫—É–Ω–¥       ‚Üí –í—ñ–¥–º–æ–≤–∞ (503 Service Unavailable)
```

#### Circuit Breaker Pattern

**–°—Ç–∞–Ω–∏ Circuit Breaker:**

1. **CLOSED (–ó–∞–∫—Ä–∏—Ç–∏–π)** - –Ω–æ—Ä–º–∞–ª—å–Ω–∞ —Ä–æ–±–æ—Ç–∞
   - –ó–∞–ø–∏—Ç–∏ –ø—Ä–æ—Ö–æ–¥—è—Ç—å –¥–æ —Å–µ—Ä–≤—ñ—Å—É
   - –õ—ñ—á–∏–ª—å–Ω–∏–∫ –ø–æ–º–∏–ª–æ–∫ = 0

2. **OPEN (–í—ñ–¥–∫—Ä–∏—Ç–∏–π)** - —Å–µ—Ä–≤—ñ—Å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π
   - –ó–∞–ø–∏—Ç–∏ –Ω–µ–≥–∞–π–Ω–æ –≤—ñ–¥—Ö–∏–ª—è—é—Ç—å—Å—è (fail fast)
   - –ù–µ –Ω–∞–≤–∞–Ω—Ç–∞–∂—É—î –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π —Å–µ—Ä–≤—ñ—Å
   - –ü—ñ—Å–ª—è timeout –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å —É HALF-OPEN

3. **HALF-OPEN (–ù–∞–ø—ñ–≤–≤—ñ–¥–∫—Ä–∏—Ç–∏–π)** - —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è
   - –ü—Ä–æ–ø—É—Å–∫–∞—î –æ–±–º–µ–∂–µ–Ω—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∑–∞–ø–∏—Ç—ñ–≤
   - –Ø–∫—â–æ —É—Å–ø—ñ—à–Ω–æ ‚Üí CLOSED
   - –Ø–∫—â–æ –ø–æ–º–∏–ª–∫–∞ ‚Üí OPEN

**–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è:**
```python
from circuitbreaker import circuit

@circuit(failure_threshold=5, recovery_timeout=60, expected_exception=ProductServiceError)
async def get_product(product_id: int):
    """
    failure_threshold: –≤—ñ–¥–∫—Ä–∏—î—Ç—å—Å—è –ø—ñ—Å–ª—è 5 –ø–æ–º–∏–ª–æ–∫
    recovery_timeout: –ø–µ—Ä–µ–π–¥–µ –≤ HALF-OPEN —á–µ—Ä–µ–∑ 60 —Å–µ–∫—É–Ω–¥
    """
    async with httpx.AsyncClient(timeout=5.0) as client:
        response = await client.get(f"{PRODUCT_SERVICE_URL}/products/{product_id}")
        
        if response.status_code != 200:
            raise ProductServiceError(f"Status: {response.status_code}")
        
        return response.json()
```

**–î—ñ–∞–≥—Ä–∞–º–∞ —Å—Ç–∞–Ω—ñ–≤:**
```
CLOSED ‚îÄ‚îÄ(5 failures)‚îÄ‚îÄ> OPEN ‚îÄ‚îÄ(60s timeout)‚îÄ‚îÄ> HALF-OPEN
   ‚Üë                                                   |
   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ(1 success)‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
   
HALF-OPEN ‚îÄ‚îÄ(failure)‚îÄ‚îÄ> OPEN
```

---

### 8.2. –°—Ç—Ä–∞—Ç–µ–≥—ñ—è –æ–±—Ä–æ–±–∫–∏ –ø–æ–º–∏–ª–æ–∫ —É –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ñ–π –≤–∑–∞—î–º–æ–¥—ñ—ó

#### Dead Letter Queue (DLQ)

**–ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è:**
```python
# –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –æ—Å–Ω–æ–≤–Ω–æ—ó —á–µ—Ä–≥–∏ –∑ DLQ
channel.queue_declare(
    queue='order.created.product',
    durable=True,
    arguments={
        'x-dead-letter-exchange': 'dlx_exchange',
        'x-dead-letter-routing-key': 'order.created.dlq',
        'x-message-ttl': 60000,  # 60 —Å–µ–∫—É–Ω–¥
        'x-max-retries': 3
    }
)

# –°—Ç–≤–æ—Ä–µ–Ω–Ω—è Dead Letter Queue
channel.queue_declare(
    queue='order.created.product.dlq',
    durable=True
)
```

**–û–±—Ä–æ–±–∫–∞ –∑ retry –ª–æ–≥—ñ–∫–æ—é:**
```python
def callback(ch, method, properties, body):
    try:
        event = json.loads(body)
        retry_count = event.get('metadata', {}).get('retry_count', 0)
        
        # Process event
        process_order_created(event)
        
        # Success - acknowledge
        ch.basic_ack(delivery_tag=method.delivery_tag)
        
    except TemporaryError as e:
        # Recoverable error - retry
        if retry_count < 3:
            event['metadata']['retry_count'] = retry_count + 1
            
            # Requeue with delay
            ch.basic_nack(delivery_tag=method.delivery_tag, requeue=True)
            print(f"Retry {retry_count + 1}/3 for event {event['event_id']}")
        else:
            # Max retries reached - send to DLQ
            ch.basic_nack(delivery_tag=method.delivery_tag, requeue=False)
            print(f"Max retries reached. Sent to DLQ: {event['event_id']}")
    
    except PermanentError as e:
        # Unrecoverable error - send to DLQ immediately
        ch.basic_nack(delivery_tag=method.delivery_tag, requeue=False)
        print(f"Permanent error. Sent to DLQ: {event['event_id']}")
```

**–ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ –∑ DLQ:**
```
orders_exchange
    ‚Üì
order.created.product (main queue)
    ‚îú‚îÄ Success ‚Üí ACK ‚Üí Message removed
    ‚îú‚îÄ Retry (< 3) ‚Üí NACK (requeue=True) ‚Üí Back to queue
    ‚îî‚îÄ Failed (>= 3) ‚Üí NACK (requeue=False) ‚Üí DLQ
                                                  ‚Üì
                                    order.created.product.dlq
                                                  ‚Üì
                                    Manual inspection / reprocessing
```

#### Idempotency (–Ü–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ñ—Å—Ç—å)

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –º–æ–∂–µ –±—É—Ç–∏ –¥–æ—Å—Ç–∞–≤–ª–µ–Ω–æ –±—ñ–ª—å—à–µ –æ–¥–Ω–æ–≥–æ —Ä–∞–∑—É

**–†—ñ—à–µ–Ω–Ω—è:** –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —É–Ω—ñ–∫–∞–ª—å–Ω–æ—Å—Ç—ñ –ø–æ–¥—ñ—ó –ø–µ—Ä–µ–¥ –æ–±—Ä–æ–±–∫–æ—é

```python
# –¢–∞–±–ª–∏—Ü—è –¥–ª—è –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è –æ–±—Ä–æ–±–ª–µ–Ω–∏—Ö –ø–æ–¥—ñ–π
CREATE TABLE processed_events (
    event_id UUID PRIMARY KEY,
    event_type VARCHAR(100),
    processed_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

def process_order_created(event):
    event_id = event['event_id']
    
    # Check if already processed
    if is_event_processed(event_id):
        print(f"Event {event_id} already processed. Skipping.")
        return
    
    # Process event
    order_data = event['data']
    update_stock(order_data['product_id'], -order_data['quantity'])
    
    # Mark as processed
    mark_event_processed(event_id, event['event_type'])
    print(f"Event {event_id} processed successfully")
```

---

## 9. –í–ò–°–ù–û–í–ö–ò

–£ —Ö–æ–¥—ñ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ—ó —Ä–æ–±–æ—Ç–∏ ‚Ññ3 –±—É–ª–æ —É—Å–ø—ñ—à–Ω–æ –∑–º–æ–¥–µ–ª—å–æ–≤–∞–Ω–æ –≤–∑–∞—î–º–æ–¥—ñ—é –º—ñ–∂ –º—ñ–∫—Ä–æ—Å–µ—Ä–≤—ñ—Å–∞–º–∏ —Å–∏—Å—Ç–µ–º–∏ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è–º–∏ –æ–Ω–ª–∞–π–Ω-–º–∞–≥–∞–∑–∏–Ω—É.

**–û—Å–Ω–æ–≤–Ω—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏:**

1. **–û–±—Ä–∞–Ω–æ —Ç–∞ –¥–µ—Ç–∞–ª—å–Ω–æ –æ–ø–∏—Å–∞–Ω–æ use case "–°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è":**
   - –í–∏–∑–Ω–∞—á–µ–Ω–æ –≤—Å—ñ—Ö —É—á–∞—Å–Ω–∏–∫—ñ–≤ –≤–∑–∞—î–º–æ–¥—ñ—ó (7 –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤)
   - –û–ø–∏—Å–∞–Ω–æ –æ—Å–Ω–æ–≤–Ω–∏–π –ø–æ—Ç—ñ–∫ (13 –∫—Ä–æ–∫—ñ–≤)
   - –í–∏–∑–Ω–∞—á–µ–Ω–æ 4 –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ñ –ø–æ—Ç–æ–∫–∏ (–ø–æ–º–∏–ª–∫–æ–≤—ñ —Å—Ü–µ–Ω–∞—Ä—ñ—ó)

2. **–°—Ç–≤–æ—Ä–µ–Ω–æ 3 Sequence Diagrams:**
   - –£—Å–ø—ñ—à–Ω–∏–π –ø–æ—Ç—ñ–∫ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è (24 –∫—Ä–æ–∫–∏)
   - –ù–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ —Ç–æ–≤–∞—Ä—É –Ω–∞ —Å–∫–ª–∞–¥—ñ (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∏–π –ø–æ—Ç—ñ–∫)
   - Product Service –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π –∑ retry –º–µ—Ö–∞–Ω—ñ–∑–º–æ–º

3. **–°—Ç–≤–æ—Ä–µ–Ω–æ Deployment Diagram:**
   - 8 Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ–≤
   - 3 –º–µ—Ä–µ–∂–µ–≤—ñ —Å–µ–≥–º–µ–Ω—Ç–∏
   - –î–µ—Ç–∞–ª—å–Ω–∞ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∏
   - Health checks —Ç–∞ restart policies

4. **–í–∏–∑–Ω–∞—á–µ–Ω–æ —Ç–∏–ø–∏ –≤–∑–∞—î–º–æ–¥—ñ—ó:**
   - **–°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞ (REST):** Order Service ‚Üí Product Service
     - Timeout: 5 —Å–µ–∫—É–Ω–¥
     - Retry: 3 —Å–ø—Ä–æ–±–∏ –∑ exponential backoff
     - Circuit breaker –ø—ñ—Å–ª—è 5 –ø–æ–º–∏–ª–æ–∫
   - **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞ (RabbitMQ):** Order Service ‚Üí Product/Notification Services
     - Durable queues
     - Manual acknowledgement
     - Dead Letter Queue –¥–ª—è –ø–æ–º–∏–ª–æ–∫

5. **–û–ø–∏—Å–∞–Ω–æ —Å—Ç—Ä–∞—Ç–µ–≥—ñ—ó –æ–±—Ä–æ–±–∫–∏ –ø–æ–º–∏–ª–æ–∫:**
   - Exponential backoff –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∏—Ö –≤–∏–∫–ª–∏–∫—ñ–≤
   - Circuit breaker pattern –¥–ª—è fault tolerance
   - Dead Letter Queue –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∏—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å
   - Idempotency –¥–ª—è –∑–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è –¥—É–±–ª—é–≤–∞–Ω–Ω—é –æ–±—Ä–æ–±–∫–∏

6. **–ü—Ä–æ–∞–Ω–∞–ª—ñ–∑–æ–≤–∞–Ω–æ –∫—Ä–∏—Ç–∏—á–Ω—ñ –º–æ–º–µ–Ω—Ç–∏:**
   - Single Point of Failure: Product Service —É —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–º—É –≤–∏–∫–ª–∏–∫—É
   - Eventual consistency: –∑–∞—Ç—Ä–∏–º–∫–∞ 100-500 –º—Å —É –æ–Ω–æ–≤–ª–µ–Ω–Ω—ñ –∑–∞–ª–∏—à–∫—ñ–≤
   - Trade-offs: strong consistency vs availability

**–ö–ª—é—á–æ–≤—ñ –º–µ—Ç—Ä–∏–∫–∏ —Å–∏—Å—Ç–µ–º–∏:**
- –ß–∞—Å —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è (E2E): 300-500 –º—Å
- –ß–∞—Å —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –≤–∏–∫–ª–∏–∫—É Product Service: 50-100 –º—Å
- –ß–∞—Å –ø—É–±–ª—ñ–∫–∞—Ü—ñ—ó –ø–æ–¥—ñ—ó –≤ RabbitMQ: 10-20 –º—Å
- –ß–∞—Å –æ–±—Ä–æ–±–∫–∏ –ø–æ–¥—ñ—ó Product Service: 100-200 –º—Å
- –ß–∞—Å –æ–±—Ä–æ–±–∫–∏ –ø–æ–¥—ñ—ó Notification Service: 300-500 –º—Å

**–ü–µ—Ä–µ–≤–∞–≥–∏ —Å–ø—Ä–æ—î–∫—Ç–æ–≤–∞–Ω–æ—ó –≤–∑–∞—î–º–æ–¥—ñ—ó:**
- ‚úÖ –ë–∞–ª–∞–Ω—Å—É—î –º—ñ–∂ strong —ñ eventual consistency
- ‚úÖ –ó–∞–±–µ–∑–ø–µ—á—É—î –≤—ñ–¥–º–æ–≤–æ—Å—Ç—ñ–π–∫—ñ—Å—Ç—å —á–µ—Ä–µ–∑ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ñ—Å—Ç—å
- ‚úÖ –î–æ–∑–≤–æ–ª—è—î –º–∞—Å—à—Ç–∞–±—É–≤–∞—Ç–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ –Ω–µ–∑–∞–ª–µ–∂–Ω–æ
- ‚úÖ –ó–º–µ–Ω—à—É—î –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞ –∫—Ä–∏—Ç–∏—á–Ω—ñ —Å–µ—Ä–≤—ñ—Å–∏

**–ú–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –¥–ª—è –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è:**
1. –î–æ–¥–∞—Ç–∏ –∫–µ—à—É–≤–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö –ø—Ä–æ —Ç–æ–≤–∞—Ä–∏ –≤ Order Service
2. –í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ API Gateway –¥–ª—è —Ü–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–æ—ó –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü—ñ—ó
3. –í–ø—Ä–æ–≤–∞–¥–∏—Ç–∏ distributed tracing (Jaeger/Zipkin)
4. –î–æ–¥–∞—Ç–∏ rate limiting –¥–ª—è –∑–∞—Ö–∏—Å—Ç—É –≤—ñ–¥ –ø–µ—Ä–µ–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è

–°–ø—Ä–æ—î–∫—Ç–æ–≤–∞–Ω–∞ –≤–∑–∞—î–º–æ–¥—ñ—è –ø–æ–≤–Ω—ñ—Å—Ç—é –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä—ñ, –≤–∏–∑–Ω–∞—á–µ–Ω—ñ–π —É –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∏—Ö —Ä–æ–±–æ—Ç–∞—Ö ‚Ññ1 —Ç–∞ ‚Ññ2, —Ç–∞ –∑–∞–±–µ–∑–ø–µ—á—É—î –Ω–∞–¥—ñ–π–Ω—É, –º–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω—É –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—é –º—ñ–∂ –º—ñ–∫—Ä–æ—Å–µ—Ä–≤—ñ—Å–∞–º–∏.

---

## 10. –í–Ü–î–ü–û–í–Ü–î–Ü –ù–ê –ö–û–ù–¢–†–û–õ–¨–ù–Ü –ó–ê–ü–ò–¢–ê–ù–ù–Ø

**1. –Ø–∫—ñ —î –≤–∏–¥–∏ –º—ñ–∂—Å–µ—Ä–≤—ñ—Å–Ω–æ—ó –≤–∑–∞—î–º–æ–¥—ñ—ó?**

–Ü—Å–Ω—É—î –¥–≤–∞ –æ—Å–Ω–æ–≤–Ω—ñ –≤–∏–¥–∏ –º—ñ–∂—Å–µ—Ä–≤—ñ—Å–Ω–æ—ó –≤–∑–∞—î–º–æ–¥—ñ—ó:

**–°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞ –≤–∑–∞—î–º–æ–¥—ñ—è:**
- –ö–ª—ñ—î–Ω—Ç –Ω–∞–¥—Å–∏–ª–∞—î –∑–∞–ø–∏—Ç —ñ —á–µ–∫–∞—î –Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å
- –ë–ª–æ–∫—É—é—á–∞ –æ–ø–µ—Ä–∞—Ü—ñ—è
- –ü—Ä–æ—Ç–æ–∫–æ–ª–∏: REST (HTTP/HTTPS), gRPC
- **–ü—Ä–∏–∫–ª–∞–¥ —É –Ω–∞—à—ñ–π —Å–∏—Å—Ç–µ–º—ñ:** Order Service –≤–∏–∫–ª–∏–∫–∞—î Product Service –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Ç–æ–≤–∞—Ä—É

**–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞ –≤–∑–∞—î–º–æ–¥—ñ—è:**
- –í—ñ–¥–ø—Ä–∞–≤–Ω–∏–∫ –Ω–∞–¥—Å–∏–ª–∞—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —ñ –ø—Ä–æ–¥–æ–≤–∂—É—î —Ä–æ–±–æ—Ç—É
- –ù–µ–±–ª–æ–∫—É—é—á–∞ –æ–ø–µ—Ä–∞—Ü—ñ—è
- –ü—Ä–æ—Ç–æ–∫–æ–ª–∏: AMQP (RabbitMQ), Kafka, NATS
- **–ü—Ä–∏–∫–ª–∞–¥ —É –Ω–∞—à—ñ–π —Å–∏—Å—Ç–µ–º—ñ:** Order Service –ø—É–±–ª—ñ–∫—É—î –ø–æ–¥—ñ—é OrderCreated, —è–∫—É –æ–±—Ä–æ–±–ª—è—é—Ç—å Product Service —Ç–∞ Notification Service

**–ì—ñ–±—Ä–∏–¥–Ω–∞ –≤–∑–∞—î–º–æ–¥—ñ—è:**
- –ö–æ–º–±—ñ–Ω–∞—Ü—ñ—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—ó —Ç–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—ó
- **–ù–∞—à–∞ —Å–∏—Å—Ç–µ–º–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –≥—ñ–±—Ä–∏–¥–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥:** —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä—è—î —Ç–æ–≤–∞—Ä, –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –æ–Ω–æ–≤–ª—é—î –∑–∞–ª–∏—à–∫–∏

**2. –£ —á–æ–º—É —Ä—ñ–∑–Ω–∏—Ü—è –º—ñ–∂ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—é —Ç–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—é –≤–∑–∞—î–º–æ–¥—ñ—î—é?**

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ | –°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞ | –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞ |
|----------------|-----------|------------|
| **–û—á—ñ–∫—É–≤–∞–Ω–Ω—è –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ** | –¢–∞–∫ (–±–ª–æ–∫—É–≤–∞–Ω–Ω—è) | –ù—ñ (–Ω–µ–±–ª–æ–∫—É–≤–∞–Ω–Ω—è) |
| **–ó–≤'—è–∑–∞–Ω—ñ—Å—Ç—å** | Tight coupling | Loose coupling |
| **Consistency** | Strong consistency | Eventual consistency |
| **–í—ñ–¥–º–æ–≤–æ—Å—Ç—ñ–π–∫—ñ—Å—Ç—å** | –ù–∏–∑—å–∫–∞ (–∫–∞—Å–∫–∞–¥–Ω—ñ –∑–±–æ—ó) | –í–∏—Å–æ–∫–∞ (—á–µ—Ä–≥–∞ –∑–±–µ—Ä—ñ–≥–∞—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è) |
| **–ó–∞—Ç—Ä–∏–º–∫–∞** | –ù–∏–∑—å–∫–∞ (50-100 –º—Å) | –í–∏—â–∞ (100-500 –º—Å) |
| **–°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å** | –ü—Ä–æ—Å—Ç–∞ | –°–µ—Ä–µ–¥–Ω—è |
| **–ú–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è** | –°–∫–ª–∞–¥–Ω—ñ—à–µ | –õ–µ–≥—à–µ |

**–ö–æ–ª–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É:**
- –ü–æ—Ç—Ä—ñ–±–Ω–∞ –Ω–µ–≥–∞–π–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å
- –ö—Ä–∏—Ç–∏—á–Ω–∞ –æ–ø–µ—Ä–∞—Ü—ñ—è (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ —Ç–æ–≤–∞—Ä—É)
- –ü—Ä–æ—Å—Ç–∏–π –∑–∞–ø–∏—Ç-–≤—ñ–¥–ø–æ–≤—ñ–¥—å

**–ö–æ–ª–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É:**
- –§–æ–Ω–æ–≤—ñ –∑–∞–¥–∞—á—ñ (–æ–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–ª–∏—à–∫—ñ–≤, —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è)
- –î–æ–≤–≥–æ—Ç—Ä–∏–≤–∞–ª—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó
- –ü–æ—Ç—Ä—ñ–±–Ω–∞ –≤–∏—Å–æ–∫–∞ –≤—ñ–¥–º–æ–≤–æ—Å—Ç—ñ–π–∫—ñ—Å—Ç—å
- –ú–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è —Å–ø–æ–∂–∏–≤–∞—á—ñ–≤

**3. –©–æ —Ç–∞–∫–µ –±—Ä–æ–∫–µ—Ä –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å?**

**–ë—Ä–æ–∫–µ—Ä –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å (Message Broker)** - —Ü–µ –ø–æ—Å–µ—Ä–µ–¥–Ω–∏–∫ –º—ñ–∂ —Å–µ—Ä–≤—ñ—Å–∞–º–∏, —è–∫–∏–π –ø—Ä–∏–π–º–∞—î, –∑–±–µ—Ä—ñ–≥–∞—î —Ç–∞ –¥–æ—Å—Ç–∞–≤–ª—è—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤—ñ–¥ –≤—ñ–¥–ø—Ä–∞–≤–Ω–∏–∫—ñ–≤ (publishers) –¥–æ –æ—Ç—Ä–∏–º—É–≤–∞—á—ñ–≤ (consumers).

**–û—Å–Ω–æ–≤–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó:**
1. **–ü—Ä–∏–π–æ–º –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å** –≤—ñ–¥ publishers
2. **–ó–±–µ—Ä—ñ–≥–∞–Ω–Ω—è** –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å —É —á–µ—Ä–≥–∞—Ö (queues)
3. **–ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü—ñ—è** –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å —á–µ—Ä–µ–∑ exchanges (RabbitMQ)
4. **–î–æ—Å—Ç–∞–≤–∫–∞** –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –¥–æ consumers
5. **–ì–∞—Ä–∞–Ω—Ç—É–≤–∞–Ω–Ω—è** –¥–æ—Å—Ç–∞–≤–∫–∏ (persistent messages)

**–£ –Ω–∞—à—ñ–π —Å–∏—Å—Ç–µ–º—ñ (RabbitMQ):**
- **Publisher:** Order Service
- **Broker:** RabbitMQ –∑ exchange `orders_exchange`
- **Consumers:** Product Service, Notification Service
- **Queue:** `order.created.product`, `order.created.notification`

**–ü–µ—Ä–µ–≤–∞–≥–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –±—Ä–æ–∫–µ—Ä–∞:**
- ‚úÖ Decoupling: —Å–µ—Ä–≤—ñ—Å–∏ –Ω–µ –∑–Ω–∞—é—Ç—å –æ–¥–∏–Ω –ø—Ä–æ –æ–¥–Ω–æ–≥–æ
- ‚úÖ Reliability: –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –Ω–µ –≤—Ç—Ä–∞—á–∞—é—Ç—å—Å—è –ø—Ä–∏ –∑–±–æ—è—Ö
- ‚úÖ Scalability: –ª–µ–≥–∫–æ –¥–æ–¥–∞–≤–∞—Ç–∏ –Ω–æ–≤–∏—Ö —Å–ø–æ–∂–∏–≤–∞—á—ñ–≤
- ‚úÖ Load leveling: –∑–≥–ª–∞–¥–∂—É–≤–∞–Ω–Ω—è –ø—ñ–∫–æ–≤–∏—Ö –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—å

**–ü–æ–ø—É–ª—è—Ä–Ω—ñ –±—Ä–æ–∫–µ—Ä–∏:**
- RabbitMQ - —É–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω–∏–π, –ø—ñ–¥—Ç—Ä–∏–º—É—î —Ä—ñ–∑–Ω—ñ –ø—Ä–æ—Ç–æ–∫–æ–ª–∏
- Apache Kafka - –¥–ª—è –ø–æ—Ç–æ–∫–æ–≤–æ—ó –æ–±—Ä–æ–±–∫–∏ –≤–µ–ª–∏–∫–∏—Ö –æ–±—Å—è–≥—ñ–≤ –¥–∞–Ω–∏—Ö
- NATS - –ª–µ–≥–∫–æ–≤–∞–≥–æ–≤–∏–π, –¥–ª—è –º—ñ–∫—Ä–æ—Å–µ—Ä–≤—ñ—Å—ñ–≤
- Redis Streams - –≤–±—É–¥–æ–≤–∞–Ω–∏–π —É Redis

**4. –Ø–∫—ñ –ø–µ—Ä–µ–≤–∞–≥–∏ –º–∞—î –ø–æ–¥—ñ–π–Ω–æ-–æ—Ä—ñ—î–Ω—Ç–æ–≤–∞–Ω–∞ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞?**

**–ü–æ–¥—ñ–π–Ω–æ-–æ—Ä—ñ—î–Ω—Ç–æ–≤–∞–Ω–∞ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ (Event-Driven Architecture, EDA)** - —Ü–µ –ø—ñ–¥—Ö—ñ–¥, –¥–µ —Å–∏—Å—Ç–µ–º–∞ —Ä–µ–∞–≥—É—î –Ω–∞ –ø–æ–¥—ñ—ó, –∞ –Ω–µ –Ω–∞ –ø—Ä—è–º—ñ –≤–∏–∫–ª–∏–∫–∏.

**–ü–µ—Ä–µ–≤–∞–≥–∏:**

1. **Loose Coupling (–°–ª–∞–±–∫–∞ –∑–≤'—è–∑–∞–Ω—ñ—Å—Ç—å):**
   - –°–µ—Ä–≤—ñ—Å–∏ –Ω–µ –∑–Ω–∞—é—Ç—å –æ–¥–∏–Ω –ø—Ä–æ –æ–¥–Ω–æ–≥–æ
   - –ú–æ–∂–Ω–∞ –¥–æ–¥–∞–≤–∞—Ç–∏ –Ω–æ–≤–∏—Ö —Å–ø–æ–∂–∏–≤–∞—á—ñ–≤ –±–µ–∑ –∑–º—ñ–Ω–∏ publisher'–∞
   - **–ü—Ä–∏–∫–ª–∞–¥:** Order Service –Ω–µ –∑–Ω–∞—î –ø—Ä–æ —ñ—Å–Ω—É–≤–∞–Ω–Ω—è Notification Service

2. **Scalability (–ú–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω—ñ—Å—Ç—å):**
   - –ú–æ–∂–Ω–∞ –¥–æ–¥–∞–≤–∞—Ç–∏ –Ω–µ–æ–±–º–µ–∂–µ–Ω—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Å–ø–æ–∂–∏–≤–∞—á—ñ–≤
   - –ö–æ–∂–µ–Ω —Å–µ—Ä–≤—ñ—Å –º–∞—Å—à—Ç–∞–±—É—î—Ç—å—Å—è –Ω–µ–∑–∞–ª–µ–∂–Ω–æ
   - **–ü—Ä–∏–∫–ª–∞–¥:** –ú–æ–∂–Ω–∞ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ 5 –µ–∫–∑–µ–º–ø–ª—è—Ä—ñ–≤ Notification Service –¥–ª—è –æ–±—Ä–æ–±–∫–∏ –±–∞–≥–∞—Ç—å–æ—Ö —Å–ø–æ–≤—ñ—â–µ–Ω—å

3. **Resilience (–í—ñ–¥–º–æ–≤–æ—Å—Ç—ñ–π–∫—ñ—Å—Ç—å):**
   - –Ø–∫—â–æ —Å–ø–æ–∂–∏–≤–∞—á –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π, –ø–æ–¥—ñ—ó –∑–∞–ª–∏—à–∞—é—Ç—å—Å—è –≤ —á–µ—Ä–∑—ñ
   - –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–¥–æ–≤–∂—É—î –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –ø—Ä–∏ –∑–±–æ—è—Ö –æ–∫—Ä–µ–º–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤
   - **–ü—Ä–∏–∫–ª–∞–¥:** –Ø–∫—â–æ Notification Service –ø–∞–¥–∞—î, Order Service –≤—Å–µ –æ–¥–Ω–æ —Å—Ç–≤–æ—Ä—é—î –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è

4. **Asynchronous Processing (–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞ –æ–±—Ä–æ–±–∫–∞):**
   - –ù–µ –±–ª–æ–∫—É—î –æ—Å–Ω–æ–≤–Ω–∏–π –ø–æ—Ç—ñ–∫
   - –®–≤–∏–¥—à–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å –∫–ª—ñ—î–Ω—Ç—É
   - **–ü—Ä–∏–∫–ª–∞–¥:** Order Service –æ–¥—Ä–∞–∑—É –ø–æ–≤–µ—Ä—Ç–∞—î –≤—ñ–¥–ø–æ–≤—ñ–¥—å –ø–æ–∫—É–ø—Ü—é, –Ω–µ —á–µ–∫–∞—é—á–∏ –Ω–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–ª–∏—à–∫—ñ–≤

5. **Audit Trail (–Ü—Å—Ç–æ—Ä—ñ—è –ø–æ–¥—ñ–π):**
   - –í—Å—ñ –ø–æ–¥—ñ—ó –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è
   - –ú–æ–∂–Ω–∞ –≤—ñ–¥—Ç–≤–æ—Ä–∏—Ç–∏ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å –ø–æ–¥—ñ–π
   - **–ü—Ä–∏–∫–ª–∞–¥:** –ú–æ–∂–Ω–∞ –ø–æ–±–∞—á–∏—Ç–∏ –≤—Å—ñ OrderCreated –ø–æ–¥—ñ—ó –∑–∞ –¥–µ–Ω—å

6. **Real-time Processing (–û–±—Ä–æ–±–∫–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ):**
   - –ü–æ–¥—ñ—ó –æ–±—Ä–æ–±–ª—è—é—Ç—å—Å—è –Ω–µ–≥–∞–π–Ω–æ –ø—ñ—Å–ª—è –ø—É–±–ª—ñ–∫–∞—Ü—ñ—ó
   - **–ü—Ä–∏–∫–ª–∞–¥:** –°–ø–æ–≤—ñ—â–µ–Ω–Ω—è –Ω–∞–¥—Å–∏–ª–∞—î—Ç—å—Å—è —á–µ—Ä–µ–∑ 100-500 –º—Å –ø—ñ—Å–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è

**–ù–µ–¥–æ–ª—ñ–∫–∏:**
- ‚ùå –°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å –Ω–∞–ª–∞–≥–æ–¥–∂–µ–Ω–Ω—è (distributed tracing –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏–π)
- ‚ùå Eventual consistency (–¥–∞–Ω—ñ –Ω–µ –∑–∞–≤–∂–¥–∏ —É–∑–≥–æ–¥–∂–µ–Ω—ñ –º–∏—Ç—Ç—î–≤–æ)
- ‚ùå –ü–æ—Ç—Ä—ñ–±–µ–Ω –Ω–∞–¥—ñ–π–Ω–∏–π –±—Ä–æ–∫–µ—Ä –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å

**5. –î–ª—è —á–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å –¥—ñ–∞–≥—Ä–∞–º—É –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç—ñ?**

**Sequence Diagram (–î—ñ–∞–≥—Ä–∞–º–∞ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç—ñ)** - —Ü–µ UML –¥—ñ–∞–≥—Ä–∞–º–∞, —è–∫–∞ –ø–æ–∫–∞–∑—É—î, —è–∫ –æ–±'—î–∫—Ç–∏ –≤–∑–∞—î–º–æ–¥—ñ—é—Ç—å –º—ñ–∂ —Å–æ–±–æ—é —É —á–∞—Å—ñ, –≤—ñ–¥–æ–±—Ä–∞–∂–∞—é—á–∏ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å.

**–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è:**

1. **–í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è –ø–æ—Ç–æ–∫—ñ–≤ –¥–∞–Ω–∏—Ö:**
   - –ü–æ–∫–∞–∑—É—î –ø–æ—Ä—è–¥–æ–∫ –≤–∏–∫–ª–∏–∫—ñ–≤ –º—ñ–∂ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏
   - –î–µ–º–æ–Ω—Å—Ç—Ä—É—î, —Ö—Ç–æ –∫–æ–≥–æ –≤–∏–∫–ª–∏–∫–∞—î —ñ –≤ —è–∫–æ–º—É –ø–æ—Ä—è–¥–∫—É
   - **–ü—Ä–∏–∫–ª–∞–¥:** –ù–∞—à–∞ –¥—ñ–∞–≥—Ä–∞–º–∞ –ø–æ–∫–∞–∑—É—î 24 –∫—Ä–æ–∫–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è

2. **–î–æ–∫—É–º–µ–Ω—Ç—É–≤–∞–Ω–Ω—è –≤–∑–∞—î–º–æ–¥—ñ—ó:**
   - –°–ª—É–∂–∏—Ç—å —Ç–µ—Ö–Ω—ñ—á–Ω–æ—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—î—é
   - –î–æ–ø–æ–º–∞–≥–∞—î –Ω–æ–≤–∏–º —Ä–æ–∑—Ä–æ–±–Ω–∏–∫–∞–º –∑—Ä–æ–∑—É–º—ñ—Ç–∏ —Å–∏—Å—Ç–µ–º—É
   - –ó–±–µ—Ä—ñ–≥–∞—î –∑–Ω–∞–Ω–Ω—è –ø—Ä–æ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä—É

3. **–í–∏—è–≤–ª–µ–Ω–Ω—è –ø—Ä–æ–±–ª–µ–º:**
   - –ü–æ–∫–∞–∑—É—î –≤—É–∑—å–∫—ñ –º—ñ—Å—Ü—è (bottlenecks)
   - –í–∏—è–≤–ª—è—î –∑–∞–π–≤—ñ –≤–∏–∫–ª–∏–∫–∏ –∞–±–æ —Å–∫–ª–∞–¥–Ω—É –ª–æ–≥—ñ–∫—É
   - **–ü—Ä–∏–∫–ª–∞–¥:** –ë–∞—á–∏–º–æ, —â–æ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∏–π –≤–∏–∫–ª–∏–∫ Product Service - potential single point of failure

4. **–ê–Ω–∞–ª—ñ–∑ —á–∞—Å—É –≤–∏–∫–æ–Ω–∞–Ω–Ω—è:**
   - –ú–æ–∂–Ω–∞ –æ—Ü—ñ–Ω–∏—Ç–∏ –∑–∞—Ç—Ä–∏–º–∫–∏ –Ω–∞ –∫–æ–∂–Ω–æ–º—É –∫—Ä–æ—Ü—ñ
   - –í–∏–∑–Ω–∞—á–∏—Ç–∏, —è–∫—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó –∑–∞–π–º–∞—é—Ç—å –Ω–∞–π–±—ñ–ª—å—à–µ —á–∞—Å—É
   - **–ü—Ä–∏–∫–ª–∞–¥:** –°–∏–Ω—Ö—Ä–æ–Ω–Ω–∏–π –≤–∏–∫–ª–∏–∫ 50-100 –º—Å, –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞ –æ–±—Ä–æ–±–∫–∞ 100-500 –º—Å

5. **–ü—Ä–æ—î–∫—Ç—É–≤–∞–Ω–Ω—è –Ω–æ–≤–∏—Ö —Ñ—ñ—á:**
   - –î–æ–ø–æ–º–∞–≥–∞—î —Å–ø–ª–∞–Ω—É–≤–∞—Ç–∏ –≤–∑–∞—î–º–æ–¥—ñ—é –¥–æ –Ω–∞–ø–∏—Å–∞–Ω–Ω—è –∫–æ–¥—É
   - –î–æ–∑–≤–æ–ª—è—î –æ–±–≥–æ–≤–æ—Ä–∏—Ç–∏ –∑ –∫–æ–º–∞–Ω–¥–æ—é
   - –í–∏—è–≤–∏—Ç–∏ –ø—Ä–æ–±–ª–µ–º–∏ –Ω–∞ –µ—Ç–∞–ø—ñ –ø—Ä–æ—î–∫—Ç—É–≤–∞–Ω–Ω—è

6. **–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è —Ç–∞ –¥–µ–±–∞–≥:**
   - –†–æ–∑—É–º—ñ–Ω–Ω—è, —è–∫—ñ –∫—Ä–æ–∫–∏ –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏
   - –î–æ–ø–æ–º–∞–≥–∞—î –≤—ñ–¥—Ç–≤–æ—Ä–∏—Ç–∏ –ø—Ä–æ–±–ª–µ–º—É
   - **–ü—Ä–∏–∫–ª–∞–¥:** –Ø–∫—â–æ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –Ω–µ —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è, –¥–∏–≤–∏–º–æ—Å—å –Ω–∞ –∫—Ä–æ–∫–∏ 1-13

**–ï–ª–µ–º–µ–Ω—Ç–∏ Sequence Diagram:**
- **Actors** - –∑–æ–≤–Ω—ñ—à–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ
- **Participants** - —Å–µ—Ä–≤—ñ—Å–∏, –±–∞–∑–∏ –¥–∞–Ω–∏—Ö
- **Arrows** - –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –º—ñ–∂ —É—á–∞—Å–Ω–∏–∫–∞–º–∏
- **Activation boxes** - —á–∞—Å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ –æ–±'—î–∫—Ç–∞
- **Notes** - –¥–æ–¥–∞—Ç–∫–æ–≤—ñ –ø–æ—è—Å–Ω–µ–Ω–Ω—è

**6. –©–æ –æ–∑–Ω–∞—á–∞—î —ñ–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ñ—Å—Ç—å —Å–µ—Ä–≤—ñ—Å—É?**

**–Ü–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—ñ—Å—Ç—å (Idempotency)** - —Ü–µ –≤–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü—ñ—ó, —è–∫–∞ –¥–∞—î –æ–¥–Ω–∞–∫–æ–≤–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–∏ –≤–∏–∫–æ–Ω–∞–Ω–Ω—ñ –æ–¥–∏–Ω –∞–±–æ –∫—ñ–ª—å–∫–∞ —Ä–∞–∑—ñ–≤ –∑ –æ–¥–Ω–∞–∫–æ–≤